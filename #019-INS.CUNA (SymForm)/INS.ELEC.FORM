[Created by RD.SYMFORM.DESIGNER on 03/02/2023 at 09:51
 Driver           - INS.ELEC.FORM
 Field Assignment - INS.ELEC.FORM.INC
 Symform Commands - INS.ELEC.FORM.SYMFORM
 Form file name   - INS.ELEC.FORM.SFF

 Case Number  :
 Credit Union :
 Form         :
 Form Source  :

 Created By   :
 Created On   : 03/02/2023

 Modified By  :
 Modified Date:
 Modifications:
]


WINDOWS

TARGET = ACCOUNT

DEFINE 
  #INCLUDE "RD.GETDATA.DEF"
  #INCLUDE "RD.SYMFORM.DEF"
  #INCLUDE "RD.NAME.AND.ACCOUNT.DEF"

  CUNAME          = CHARACTER
  CUNUMBER        = CHARACTER
  FORMNAME        = CHARACTER
  USEOPTICAL      = NUMBER
  PRINTOPTION     = NUMBER
  COPYQTY         = NUMBER
  DUPLEXTYPE      = NUMBER
  PAPERSIZETYPE   = NUMBER
  ORIENTATIONTYPE = NUMBER
  [TODO:Optical   = 
  IMGID           = CHARACTER  
  IMGTYPE         = NUMBER     
  IMGSOURCE       = CHARACTER  
  IMGHELPNUMBER   = NUMBER
  IMGHELPERROR    = CHARACTER
  IMGHELPCURRLINE = CHARACTER
  IMGHELPPREVLINE = CHARACTER
  IMGDOCTYPE      = CHARACTER
  IMGDOCTYPEINDEX = CHARACTER
  IMGCABINET      = CHARACTER
  IMGCOMMENTINDEX = NUMBER
  ]
  FORMDATA        = CHARACTER(060) ARRAY(092)
  TRUE            = 1
  FALSE           = 0
  CHECKED         = "1"
 [UNCHECKED       = "0"]
  COMBOVALUE      = CHARACTER(060) ARRAY(000,250)
  COMBOCODE       = NUMBER         ARRAY(000,250)
 [MLDATA          = CHARACTER(040) ARRAY(000,000)
  MLINDEX         = NUMBER         ARRAY(092)]

  [-- PROGRAMMER DEFINED VARS --]
  EXITAPP		= NUMBER
  CLOSEAPP		= NUMBER
  ACCTNO		= CHARACTER
  JTINSWARNING	= NUMBER
  FORMDATE		= DATE
  NAMELIST		= CHARACTER(40) ARRAY(20)
  NAMECT		= NUMBER
  NAME1		    = NUMBER
  NAME2		    = NUMBER
  LOANID		= CHARACTER(2)
  LNID		    = CHARACTER(2) ARRAY(20)
  LNDESC		= CHARACTER(40) ARRAY(20)
  LNPAYMENTCOUNT = NUMBER ARRAY(20)
  LNINSURTYPE  = NUMBER ARRAY(20)
  LNBALANCE    = MONEY ARRAY(20)
  LOANCT		= NUMBER
  INSTYPE		= NUMBER
  I			    = NUMBER
  COMBOSELECT	= NUMBER
  LEVEL		    = CHARACTER(1) ARRAY(99)
  LNAME		    = CHARACTER(60) ARRAY(99)
  LADDR1	    = CHARACTER(60) ARRAY(99)
  LADDR2	    = CHARACTER(60) ARRAY(99)
  LADDR3	    = CHARACTER(60) ARRAY(99)
  LEMAIL	    = CHARACTER(60) ARRAY(99)
  LBDAY	        = DATE ARRAY(99)
  X			    = NUMBER
  NAMENUM		= NUMBER
  NAMEMAX		= NUMBER
  JTNUM		    = NUMBER
  PLNAME       = CHARACTER  
  
  LOANPAYCOUNT=NUMBER
  ESTLIFE=MONEY
  ESTDISB=MONEY
  LOANINSURANCETYPE=NUMBER
  LOANBALANCE=MONEY DISBDATE=DATE
  LIFEDATE=DATE
  BORROWER2DISBBDATE=DATE
  BORROWER1DISBBDATE=DATE
  BORROWER2LIFEBDATE=DATE
  BORROWER1LIFEBDATE=DATE
  AGEBORROWER2=NUMBER
  AGEBORROWER1=NUMBER
  DISBTABLEMAXJTAGE=NUMBER
  DISBTABLEMAXAGE=NUMBER
  LIFETABLEMAXJTAGE=NUMBER
  LIFETABLEMAXAGE=NUMBER
  DISBTABLE=NUMBER
  LIFETABLE=NUMBER
  DISBTERMDATE=DATE
  LIFETERMDATE=DATE
END


SETUP
  PLNAME          = NAME:LONGNAME  
  CUNUMBER        = "228"
  CUNAME          = "CU Name goes here"
  QUOTE           = CTRLCHR(34)
  SYMFORMINPUT    = TRUE
  FORMSAVED       = FALSE
  FORMSBMT        = FALSE
  USENEWIDFIELDS  = TRUE

  COPYQTY         = 1
  ORIENTATIONTYPE = 1   [ 1  - PORTRAIT                      ]
                        [ 2  - LANDSCAPE                     ]
  DUPLEXTYPE      = 1   [ 1  - SIMPLEX                       ]
                        [ 2  - DUPLEX VERTICAL               ]
                        [ 3  - DUPLEX HORIZONTAL             ]
  PAPERSIZETYPE   = 1   [ 1  - LETTER 8 1/2 x 11 in          ]
                        [ 2  - LETTER SMALL 8 1/2 X 11 IN    ]
                        [ 3  - TABLOID 11 X 17 IN            ]
                        [ 4  - LEDGER 17 X 11 IN             ]
                        [ 5  - LEGAL 8 1/2 X 14 IN           ]
                        [ 6  - STATEMENT 5 1/2 X 8 1/2 IN    ]
                        [ 7  - EXECUTIVE 7 1/4 X 10 1/2 IN   ]
                        [ 8  - A3 297 X 420 MM               ]
                        [ 9  - A4 210 X 297 MM               ]
                        [ 10 - A4 SMALL 210 X 297 MM         ]
  USEOPTICAL      = 0   [ 0  - NO OPTICAL STORAGE            ]
                        [ 1  - OPTICAL STORAGE               ]
  PRINTOPTION     = 0   [ 0  - CLOSE AFTER SUBMIT THEN PRINT ]
                        [ 1  - CLOSE AFTER JUST PRINT        ]
                        [ 2  - AUTO PRINT                    ]
                        [ 3  - AND UP - USER DEFINED         ]

  STICKYFORMID    = "INS.ELEC.FORM"
[
  STICKYFORMID is a 20 character text field that helps identify
  the note and tie it to the form. Default is the Driver name.
]

  FOR STICKYLOOP=0 TO 50
   DO
    STICKYORD(STICKYLOOP)=-1
   END

  IF SYSWINDOWSLEVEL<2 THEN
   DO
    NEWLINE
    NEWLINE
    PRINT "SYMFORM SPECFILES CAN ONLY BE RUN FROM SYMITAR FOR WINDOWS"
    NEWLINE
    NEWLINE
    TERMINATE
   END
  FORMNAME = "Schedule of Credit Insurance"
  CALL LOADNAMEANDACCOUNTFIELDS
  CALL GETLOANINFO
  CALL ASSIGNFIELDVARIABLES
  CALL UPDATESYMFORMFIELDS

  CALL LOADSTICKYNOTESACCOUNT
[
  This is where you would place the call to load Sticky Notes from
  either Account, Share, Loan, or Loan Application record:
  CALL LOADSTICKYNOTESACCOUNT or
  CALL LOADSTICKYNOTESSHARE or
  CALL LOADSTICKYNOTESLOAN or
  CALL LOADSTICKYNOTESLOANAPP
  Only one procedure can be called. Make sure you have the
  corresponding INCLUDE file with the record definitions.
]

[
  This is where you would create custom tool bar items.
  Valid tool bar control types are 6=Button, 5=Combo Box, 8=List box.
  For example to create a single button:
  WINDOWSSEND(332,"TID=1,CT=6")
]

  IF PRINTOPTION=2 THEN
   DO
    WINDOWSSEND(332,"MBNA=NOTHING")
    CALL GETRESPONSE
    WINDOWSSEND(332,"SAVE=DEFAULTPRINT"+
                    ",ORIENTATION="+FORMAT("9",ORIENTATIONTYPE)+
                    ",PAPERSIZE="+FORMAT("#9",PAPERSIZETYPE)+
                    ",DUPLEX="+FORMAT("9",DUPLEXTYPE)+
                    ",COPIES="+FORMAT("9",COPYQTY))
    CALL GETRESPONSE
    WINDOWSSEND(332,"CLOSE,MIN")
    CLOSEFORM=TRUE
   END
  ELSE
    WINDOWSSEND(332,"SP=001,SF=001")

  TEMPNUM=1
  WHILELIMIT=100000
  WHILE (VALUE(RESPSF)>0 OR RESPSF="") AND CLOSEFORM=FALSE
   DO
    CALL GETRESPONSE
    CALL CLEARCBVALUES
    CALL PROCESSFIELDEVENT    
    IF RESPCMD<>"" THEN
     DO
      IF RESPCMD="SBMT" THEN
       DO
        WINDOWSSEND(332,"SBMT")
        RESPID="1"
        WHILE RESPVA<>"END" OR RESPID<>"0"
         DO
          CALL GETRESPONSE
          FORMDATA(VALUE(RESPID))=RESPVA
         END
        CALL UPDATEFIELDVARIABLES
        CALL UPDATESTICKYNOTESACCOUNT
        [
        This is where you would place the call to update Sticky Notes to
        either Account, Share, Loan, or Loan Application record:
        CALL UPDATESTICKYNOTESACCOUNT or
        CALL UPDATESTICKYNOTESSHARE or
        CALL UPDATESTICKYNOTESLOAN or
        CALL UPDATESTICKYNOTESLOANAPP
        Only one procedure can be called. Make sure you have the
        corresponding INCLUDE file with the record definitions.
        By default is set to update Notes to the Account record.
        ]
        FORMSBMT=TRUE

        #INCLUDE "RD.NAME.AND.ACCOUNT.FMP"
        CALL LOADNAMEANDACCOUNTFIELDS

        [Additional FMPERFORM commands can be performed here]

        CALL ASSIGNFIELDVARIABLES
        CALL UPDATESYMFORMVALUES

        WINDOWSSEND(332,"MFLAG=0")
        WINDOWSSEND(332,"MBOK=ALL FIELDS SENT TO HOST")
       END

      IF RESPCMD="SAVE" THEN
       DO
        IF USEOPTICAL>0 THEN
         DO
          [Imaging index template provided below is an example.  Actual 
           Imaging Index and field assignment is determined by the setup
           of the Imaging Server.  Modifications may be required to the 
           indexes and or field assignment.  Normally if the info is 
           available on the form you should use it instead of the 
           current database value. This way if information is changed 
           and not yet submitted to host it will still be the most 
           accurate.]
          [
          TEMPCHAR=ANUMBER
          CALL REMOVELEADINGZEROS
          ANUMBER=TEMPCHAR
          TEMPLINE=NLONGNAME(0)
          CALL REMOVEHYPHENAPOSTROPHE

          [***   OTG IMAGING INDEX EXAMPLE  
          WINDOWSSEND(332,"OTGN(0)=APPLICATION,OTG(0)=LOANS")
          WINDOWSSEND(332,"OTGN(1)=ACCT NO,OTG(1)="+ANUMBER)
          WINDOWSSEND(332,"OTGN(2)=NAME,OTG(2)="+TEMPLINE)
          WINDOWSSEND(332,"OTGN(3)=TAX ID,OTG(3)="+NSSN(0))
          WINDOWSSEND(332,"OTGN(4)=LOAN ID,OTG(4)="+LID)
          WINDOWSSEND(332,"OTGN(5)=DOC TYPE,OTG(5)="+
                           GETDATACHAR(GETDEFAULTLOAN,LTYPE,77))
          WINDOWSSEND(332,"OTGN(6)=DATE,OTG(6)="+
                           FORMAT("99/99/99",SYSTEMDATE))
          **** END OTG EXAMPLE]

          [****SYNERGY IMAGING INDEX EXAMPLE**** 
          IMGDOCTYPE=GETDATACHAR(GETDEFAULTLOAN,LTYPE,77)
          WINDOWSSEND(332,"OTGN(0)=DOC TYPE,OTG(0)=LOANS~_INSTITUTION_~_"+
                "CABINET_~_TYPE_~_DOCNAME_~ACCT NO~NAME~TAX ID~LOAN ID~DATE~PAID DATE")
          WINDOWSSEND(332,"OTGN(1)=_INSTITUTION_,OTG(1)=00")
          WINDOWSSEND(332,"OTGN(2)=_CABINET_,OTG(2)=LOANS")
          WINDOWSSEND(332,"OTGN(3)=_TYPE_,OTG(3)="+IMGDOCTYPE)
          WINDOWSSEND(332,"OTGN(4)=_DOCNAME_,OTG(4)="+IMGDOCTYPE)
          WINDOWSSEND(332,"OTGN(5)=ACCT NO,OTG(5)="+ANUMBER)
          WINDOWSSEND(332,"OTGN(6)=NAME,OTG(6)="+TEMPLINE)
          WINDOWSSEND(332,"OTGN(7)=TAX ID,OTG(7)="+NSSN(0))
          WINDOWSSEND(332,"OTGN(8)=LOAN ID,OTG(8)="+LID)
          WINDOWSSEND(332,"OTGN(9)=DATE,OTG(9)="+FORMAT("99/99/99",SYSTEMDATE))
          WINDOWSSEND(332,"OTGN(11)=PAID DATE,OTG(11)=")
          **** END SYNERGY EXAMPLE]
 
          ]
          WINDOWSSEND(332,"SAVE=SAVE")
          CALL GETRESPONSE
          IF CHARACTERSEARCH(RESPSAV,"-")>0 THEN
           DO
            IF RESPSAV="-8" THEN
             DO
              WINDOWSSEND(332,"MBOK=You cannot send to optical. "+
                              "Your SymForm registration needs to be updated. "+
                              "Please contact Symitar")
             END
            ELSE
             DO
              WINDOWSSEND(332,"SAVE=SAVE,SAVEMODE=1")   [,SAVEPATH=C:\\]
              CALL GETRESPONSE
             END
           END
          IF CHARACTERSEARCH(RESPSAV,"-")>0 THEN
           COPYQTY=COPYQTY+1
         END

        WINDOWSSEND(332,"SAVE=PRINT"+
                        ",ORIENTATION="+FORMAT("9",ORIENTATIONTYPE)+
                        ",PAPERSIZE="+FORMAT("#9",PAPERSIZETYPE)+
                        ",DUPLEX="+FORMAT("9",DUPLEXTYPE)+
                        ",COPIES="+FORMAT("9",COPYQTY))
        CALL GETRESPONSE

        IF CHARACTERSEARCH(RESPSAV,"-")=0 AND VALUE(RESPSAV)<>0 THEN
          FORMSAVED = TRUE

        IF PRINTOPTION=0 AND FORMSAVED=TRUE AND FORMSBMT=TRUE OR
           PRINTOPTION=1 AND FORMSAVED=TRUE                   OR
           PRINTOPTION=3                                      THEN
           [Other PRINTOPTIONS go here]
         DO
          WINDOWSSEND(332,"CLOSE,MIN")
          CLOSEFORM=TRUE
         END
       END
     END

    IF RESPTID<>"" THEN
      CALL PROCESSTOOLBAREVENT
   END
END


PRINT TITLE="TEST"
  SUPPRESSNEWLINE
END


[Whenever the user attempts to change fields by ether using the mouse or
 the tab key a number of pieces of data are sent to this procedure:
 RESPSF = Indicates the field ID that was attempted to be moved to.
 RESPID = Indicates the field ID the user was on.
 RESPVA = Indicates the value that was entered into the field.
 RESPSP = Indicates the page that was attempted to be moved to.
 RESPRD = Indicates the method used to move between field IDs.
 From the statement below you can see that normally SymForm just allows
 the action by changing focus to the requested field.

 This is where field validation could occur. For example if you didn't
 want the user to be able to leave field 10 until a value between
 6 and 18 was entered you could simply add
 IF VALUE(RESPID)=10 AND (VALUE(RESPVA)<6 OR VALUE(RESPVA)>18) THEN
   RESPSF="10"

 Some procedures to help validate common fields will be placed in
 RD.SYMFORM.PRO. The current ones are:

 FIXPHONENUMBER - This procedure will right justify a phone number and
                  ensure that it is 7 or 10 characters long.
                  Ex:  IF VALUE(RESPID)=5 THEN
                         CALL FIXPHONENUMBER
]
PROCEDURE PROCESSFIELDEVENT
 IF VALUE(RESPID)=001 THEN [if leaving field with member's name] 
  DO 
   IF VALUE(RESPVA)<=0 THEN 
    DO 
     POPUPMESSAGE(0,"Member name cannot be blank! ") 
     RESPSF="1" [Set back to name field if blank] 
    END 
   ELSE 
    DO 
     IF LADDR1(VALUE(RESPVA))<>"" THEN
      DO
       FORMDATA(041)=LNAME(VALUE(RESPVA))  
       WINDOWSSEND(332,"ID=041,VA="+FORMDATA(041))
      
       FORMDATA(002)=LADDR1(VALUE(RESPVA))  
       WINDOWSSEND(332,"ID=002,VA="+FORMDATA(002)) 
       
       FORMDATA(042)=LADDR1(VALUE(RESPVA))  
       WINDOWSSEND(332,"ID=042,VA="+FORMDATA(042))
  
       FORMDATA(003)=LADDR2(VALUE(RESPVA)) 
       WINDOWSSEND(332,"ID=003,VA="+FORMDATA(003)) 
       
       FORMDATA(043)=LADDR2(VALUE(RESPVA)) 
       WINDOWSSEND(332,"ID=043,VA="+FORMDATA(043))
  
       FORMDATA(004)=LADDR3(VALUE(RESPVA)) 
       WINDOWSSEND(332,"ID=004,VA="+FORMDATA(004)) 
       
       FORMDATA(044)=LADDR3(VALUE(RESPVA)) 
       WINDOWSSEND(332,"ID=044,VA="+FORMDATA(044))
  
       FORMDATA(005)=LEMAIL(VALUE(RESPVA)) 
       WINDOWSSEND(332,"ID=005,VA="+FORMDATA(005)) 
       
       FORMDATA(045)=LEMAIL(VALUE(RESPVA)) 
       WINDOWSSEND(332,"ID=045,VA="+FORMDATA(045))
  
       FORMDATA(006)=FORMAT("99/99/9999",LBDAY(VALUE(RESPVA)))
       WINDOWSSEND(332,"ID=006,VA="+FORMDATA(006)) 
       
       FORMDATA(046)=FORMAT("99/99/9999",LBDAY(VALUE(RESPVA)))
       WINDOWSSEND(332,"ID=046,VA="+FORMDATA(046))
       
       FORMDATA(081)=LNAME(VALUE(RESPVA))  
       WINDOWSSEND(332,"ID=081,VA="+FORMDATA(081))
      END 
     ELSE
      DO
       FORMDATA(041)=LNAME(VALUE(RESPVA))  
       WINDOWSSEND(332,"ID=041,VA="+FORMDATA(041))
       
       FORMDATA(002)=LADDR2(VALUE(RESPVA)) 
       WINDOWSSEND(332,"ID=002,VA="+FORMDATA(002)) 
       
       FORMDATA(042)=LADDR2(VALUE(RESPVA)) 
       WINDOWSSEND(332,"ID=042,VA="+FORMDATA(042)) 
  
       FORMDATA(003)=LADDR3(VALUE(RESPVA)) 
       WINDOWSSEND(332,"ID=003,VA="+FORMDATA(003)) 
       
       FORMDATA(043)=LADDR3(VALUE(RESPVA)) 
       WINDOWSSEND(332,"ID=043,VA="+FORMDATA(043))
  
       FORMDATA(004)="" 
       WINDOWSSEND(332,"ID=004,VA="+FORMDATA(004)) 
       
       FORMDATA(044)="" 
       WINDOWSSEND(332,"ID=044,VA="+FORMDATA(044))
  
       FORMDATA(005)=LEMAIL(VALUE(RESPVA)) 
       WINDOWSSEND(332,"ID=005,VA="+FORMDATA(005))
       
       FORMDATA(045)=LEMAIL(VALUE(RESPVA)) 
       WINDOWSSEND(332,"ID=045,VA="+FORMDATA(045)) 
  
       FORMDATA(006)=FORMAT("99/99/9999",LBDAY(VALUE(RESPVA)))
       WINDOWSSEND(332,"ID=006,VA="+FORMDATA(006))
       
       FORMDATA(046)=FORMAT("99/99/9999",LBDAY(VALUE(RESPVA)))
       WINDOWSSEND(332,"ID=046,VA="+FORMDATA(046))
       
       FORMDATA(081)=LNAME(VALUE(RESPVA))  
       WINDOWSSEND(332,"ID=081,VA="+FORMDATA(081))
      END
    END      
   END 
  IF NAMEMAX>1 THEN
   DO
    IF VALUE(RESPID)=007 THEN 
     DO 
      IF VALUE(RESPVA)<=0 THEN 
       DO 
        POPUPMESSAGE(0,"Member name cannot be blank! ") 
        RESPSF="7" 
       END 
      ELSE 
       DO        
        IF LADDR1(VALUE(RESPVA))<>"" THEN
         DO
          FORMDATA(047)=LNAME(VALUE(RESPVA))  
          WINDOWSSEND(332,"ID=047,VA="+FORMDATA(047))
       
          FORMDATA(008)=LADDR1(VALUE(RESPVA))  
          WINDOWSSEND(332,"ID=008,VA="+FORMDATA(008)) 
          
          FORMDATA(048)=LADDR1(VALUE(RESPVA))  
          WINDOWSSEND(332,"ID=048,VA="+FORMDATA(048)) 
     
          FORMDATA(009)=LADDR2(VALUE(RESPVA)) 
          WINDOWSSEND(332,"ID=009,VA="+FORMDATA(009)) 
          
          FORMDATA(049)=LADDR2(VALUE(RESPVA)) 
          WINDOWSSEND(332,"ID=049,VA="+FORMDATA(049))
     
          FORMDATA(010)=LADDR3(VALUE(RESPVA)) 
          WINDOWSSEND(332,"ID=010,VA="+FORMDATA(010))
          
          FORMDATA(050)=LADDR3(VALUE(RESPVA)) 
          WINDOWSSEND(332,"ID=050,VA="+FORMDATA(050)) 
     
          FORMDATA(011)=LEMAIL(VALUE(RESPVA)) 
          WINDOWSSEND(332,"ID=011,VA="+FORMDATA(011)) 
          
          FORMDATA(051)=LEMAIL(VALUE(RESPVA)) 
          WINDOWSSEND(332,"ID=051,VA="+FORMDATA(051))
     
          FORMDATA(012)=FORMAT("99/99/9999",LBDAY(VALUE(RESPVA)))
          WINDOWSSEND(332,"ID=012,VA="+FORMDATA(012))
          
          FORMDATA(052)=FORMAT("99/99/9999",LBDAY(VALUE(RESPVA)))
          WINDOWSSEND(332,"ID=052,VA="+FORMDATA(052)) 
          
          FORMDATA(083)=LNAME(VALUE(RESPVA))  
          WINDOWSSEND(332,"ID=083,VA="+FORMDATA(083))
         END 
        ELSE
         DO
          FORMDATA(047)=LNAME(VALUE(RESPVA))  
          WINDOWSSEND(332,"ID=047,VA="+FORMDATA(047))
          
          FORMDATA(008)=LADDR2(VALUE(RESPVA)) 
          WINDOWSSEND(332,"ID=008,VA="+FORMDATA(008)) 
          
          FORMDATA(048)=LADDR2(VALUE(RESPVA)) 
          WINDOWSSEND(332,"ID=048,VA="+FORMDATA(048))
     
          FORMDATA(009)=LADDR3(VALUE(RESPVA)) 
          WINDOWSSEND(332,"ID=009,VA="+FORMDATA(009)) 
          
          FORMDATA(049)=LADDR3(VALUE(RESPVA)) 
          WINDOWSSEND(332,"ID=049,VA="+FORMDATA(049)) 
     
          FORMDATA(010)="" 
          WINDOWSSEND(332,"ID=010,VA="+FORMDATA(010)) 
          
          FORMDATA(050)="" 
          WINDOWSSEND(332,"ID=050,VA="+FORMDATA(050))
     
          FORMDATA(011)=LEMAIL(VALUE(RESPVA)) 
          WINDOWSSEND(332,"ID=011,VA="+FORMDATA(011))
          
          FORMDATA(051)=LEMAIL(VALUE(RESPVA)) 
          WINDOWSSEND(332,"ID=051,VA="+FORMDATA(051))
     
          FORMDATA(012)=FORMAT("99/99/9999",LBDAY(VALUE(RESPVA)))
          WINDOWSSEND(332,"ID=012,VA="+FORMDATA(012))
          
          FORMDATA(052)=FORMAT("99/99/9999",LBDAY(VALUE(RESPVA)))
          WINDOWSSEND(332,"ID=052,VA="+FORMDATA(052))
          
          FORMDATA(083)=LNAME(VALUE(RESPVA))  
          WINDOWSSEND(332,"ID=083,VA="+FORMDATA(083))
         END
       END      
     END
   END 
  
  IF RESPSP<>"" THEN
    WINDOWSSEND(332,"SP="+RESPSP)
  IF RESPSF<>"" THEN
    WINDOWSSEND(332,"SF="+RESPSF)
END


[Values passed will be RESPTID to let you know what tool bar control
 was used and RESPTVA to respond back what item was selected.
]
PROCEDURE PROCESSTOOLBAREVENT
END

PROCEDURE GETLOANINFO
 [**LIST BOX FOR NAME SELECTION]
 CLOSEAPP=FALSE
 [**REMOVE LEADING ZEROS]
 ACCTNO=ACCOUNT:NUMBER
 WHILE SEGMENT(ACCTNO,1,1)="0"
  DO
   ACCTNO=SEGMENT(ACCTNO,2,LENGTH(ACCTNO))
  END
 [**TYPE 44 WARNING CHECK]
 IF ANYWARNING(ACCOUNT,44) THEN 
  DO
   JTINSWARNING=TRUE 
  END
 ELSE JTINSWARNING=FALSE
 FORMDATE=SYSTEMDATE
 [**PROMPT USER FOR LOAN ID IF MORE THAN 1]
 LOANCT=0
 FOR EACH LOAN WITH (LOAN:CLOSEDATE='--/--/--' AND LOAN:TYPE<>98)
  DO
   LOANCT=LOANCT+1
   LNID(LOANCT)=LOAN:ID
   LNDESC(LOANCT)=LOAN:DESCRIPTION
   LNPAYMENTCOUNT(LOANCT)=LOAN:PAYMENTCOUNT
   LNINSURTYPE(LOANCT)=LOAN:INSURANCETYPE
   LNBALANCE(LOANCT)=LOAN:BALANCE
  END
 IF LOANCT<1 THEN
  DO
   POPUPMESSAGE(2,"There are no loans on this account")
   TERMINATE
  END
 ELSE IF LOANCT=1 THEN 
  DO
   LOANID=LNID(LOANCT)
   LOANPAYCOUNT=LNPAYMENTCOUNT(LOANCT)
   LOANINSURANCETYPE=LNINSURTYPE(LOANCT)
   LOANBALANCE=LNBALANCE(LOANCT)   
  END
 ELSE
  DO
   DIALOGSTART("Select a Loan",100%,1)
   DIALOGPROMPTCOMBOSTART("Loan ID",LOANCT)
   FOR I=1 TO LOANCT
    DO
     DIALOGPROMPTCOMBOOPTION(I,LNID(I)+"-"+LNDESC(I))
    END
   DIALOGPROMPTCOMBOEND
   DIALOGDISPLAY
   COMBOSELECT=ENTERCODE("Loan ID",LOANCT,LOANCT)
   DIALOGCLOSE
   LOANID=LNID(COMBOSELECT)
   LOANPAYCOUNT=LNPAYMENTCOUNT(COMBOSELECT)
   LOANINSURANCETYPE=LNINSURTYPE(COMBOSELECT)
   LOANBALANCE=LNBALANCE(COMBOSELECT)
  END
  [ACCTNO=ACCTNO+"-"+LOANID  ]   
  [**COLLECT NAMES FOR SYMFORM]
  NAMECT=0
  FOR EACH NAME WITH (NAME:TYPE<2 AND (NAME:EXPIRATIONDATE='--/--/--' OR NAME:EXPIRATIONDATE>SYSTEMDATE))
   DO
    NAMECT=NAMECT+1
    NAMELIST(NAMECT)=NAME:LONGNAME
   END
  FOR EACH LOAN WITH (LOAN:ID=LOANID)
   DO
    FOR EACH LOAN NAME WITH (LOAN NAME:TYPE=1 AND (LOAN NAME:EXPIRATIONDATE='--/--/--' OR NAME:EXPIRATIONDATE>SYSTEMDATE))
     DO
      NAMECT=NAMECT+1
      NAMELIST(NAMECT)=LOAN NAME:LONGNAME
     END
    IF NAMECT<3 THEN
     DO 
      IF JTINSWARNING=TRUE THEN
       DO
        NAME1=1
        NAME2=0
       END
      ELSE 
       DO
        NAME2=1
        NAME1=0
       END
     END
    EXITAPP=FALSE
    INSTYPE=LOAN:INSURANCETYPE
   END     
  [**LIST BOX GENERATION FOR PRIMARY AND JOINT NAMES]
  X=0
  NAMENUM=0
  JTNUM=0
  IF JTINSWARNING=FALSE THEN
   DO
    FOR EACH NAME WITH(NAME:TYPE=0 OR NAME:TYPE=1) 
     DO
      X=X+1
      LEVEL(X)="A"
      LNAME(X)=NAME:LONGNAME
      LADDR1(X)=NAME:EXTRAADDRESS
      LADDR2(X)=NAME:STREET
      LADDR3(X)=NAME:CITY + " " + NAME:STATE + " " + NAME:ZIPCODE
      LEMAIL(X)=NAME:EMAIL
      LBDAY(X)=NAME:BIRTHDATE
      IF NAMENUM=0 THEN NAMENUM=X
     END
    FOR EACH LOAN WITH(LOAN:ID=LOANID)
     DO 
      FOR EACH LOAN NAME WITH(LOAN NAME:TYPE=1)
       DO
        X=X+1
        LEVEL(X)="L"
        LNAME(X)=LOAN NAME:LONGNAME
        LADDR1(X)=LOAN NAME:EXTRAADDRESS
        LADDR2(X)=LOAN NAME:STREET
        LADDR3(X)=LOAN NAME:CITY + " " + LOAN NAME:STATE + " " + LOAN NAME:ZIPCODE
        LEMAIL(X)=LOAN NAME:EMAIL
        LBDAY(X)=LOAN NAME:BIRTHDATE        
        IF JTNUM=0 THEN JTNUM=X
       END     
     END
   END
  NAMEMAX=X  
  IF JTINSWARNING=TRUE THEN
   DO
    X=0
    NAMEMAX=0
    NAMENUM=0
    JTNUM=0
    FOR EACH NAME WITH(NAME:TYPE=0 OR NAME:TYPE=1) 
     DO 
      X=X+1
      LEVEL(X)="A"
      LNAME(X)=NAME:LONGNAME
      LADDR1(X)=NAME:EXTRAADDRESS
      LADDR2(X)=NAME:STREET
      LADDR3(X)=NAME:CITY + " " + NAME:STATE + " " + NAME:ZIPCODE
      LEMAIL(X)=NAME:EMAIL
      LBDAY(X)=NAME:BIRTHDATE
      IF JTNUM=0 THEN JTNUM=X
     END
    FOR EACH LOAN WITH(LOAN:ID=LOANID)
     DO 
      FOR EACH LOAN NAME WITH(LOAN NAME:TYPE=1)
       DO
        X=X+1
        LEVEL(X)="L"
        LNAME(X)=LOAN NAME:LONGNAME
        LADDR1(X)=LOAN NAME:EXTRAADDRESS
        LADDR2(X)=LOAN NAME:STREET
        LADDR3(X)=LOAN NAME:CITY + " " + LOAN NAME:STATE + " " + LOAN NAME:ZIPCODE
        LEMAIL(X)=LOAN NAME:EMAIL
        LBDAY(X)=LOAN NAME:BIRTHDATE
        IF NAMENUM=0 THEN NAMENUM=X
       END
     END
   END
   NAMEMAX=X   
  [**TYPE 44 ERROR ON NON JOINT LOAN]
  IF JTINSWARNING=TRUE AND NAMEMAX<2 THEN
   DO
    POPUPMESSAGE(2,"There is an error with the insurance type 44 on this loan.")
    TERMINATE
   END     
END

PROCEDURE GETINSURANCEESTIMATE
 FOR EACH LOAN WITH LOAN:ID=LOANID
  DO
   LOANPROJECTINIT(1,0)
   @LOANPROJECTFIRSTINSBIRTHDATE=LBDAY(1)
   @LOANPROJECTSECONDINSBIRTHDATE=LBDAY(2)
   @LOANPROJECTINSURANCETYPE=LOANINSURANCETYPE
   @LOANPROJECTLOANAMOUNT=LOANBALANCE
   LOANPROJECTCALC 
   IF @LOANPROJECTLIFEERROR<>"" THEN 
    POPUPMESSAGE(2,"Life Error: "+@LOANPROJECTLIFEERROR)
   IF @LOANPROJECTDISABILITYERROR<>"" THEN 
    POPUPMESSAGE(2,"Disab. Error: "+@LOANPROJECTDISABILITYERROR)
   IF @LOANPROJECTERROR<>"" THEN 
    POPUPMESSAGE(2,"Project Error: "+@LOANPROJECTERROR) 
    
   ESTLIFE=@LOANPROJECTLIFE
   ESTDISB=@LOANPROJECTDISABILITY 
   
   LIFETERMDATE=LOAN:MATURITYDATE
   DISBTERMDATE=LOAN:MATURITYDATE
   
   IF LOANINSURANCETYPE<>0 THEN
    DO
     LIFETABLE=GETDATANUMBER(GETPARAMINSTYPELIFETABLE,LOANINSURANCETYPE) 
     DISBTABLE=GETDATANUMBER(GETPARAMINSTYPEDISTABLE,LOANINSURANCETYPE) 
     
     LIFETABLEMAXAGE=GETDATANUMBER(GETPARAMINSTABLEMAXAGE,LIFETABLE)
     LIFETABLEMAXJTAGE=GETDATANUMBER(GETPARAMINSTABLEMAXAGEJOINT,LIFETABLE) 
     
     DISBTABLEMAXAGE=GETDATANUMBER(GETPARAMINSTABLEMAXAGE,DISBTABLE)
     DISBTABLEMAXJTAGE=GETDATANUMBER(GETPARAMINSTABLEMAXAGEJOINT,DISBTABLE)
     
     AGEBORROWER1=NUMBER((SYSTEMDATE-LBDAY(1))/365.25)
     IF LBDAY(2)<>'--/--/--' THEN
      DO
       AGEBORROWER2=NUMBER((SYSTEMDATE-LBDAY(2))/365.25)
      END
     
     BORROWER1LIFEBDATE=DATEOFFSET(LBDAY(1),LIFETABLEMAXAGE*12,0)
     LIFEDATE=BORROWER1LIFEBDATE
     IF LBDAY(2)<>'--/--/--' THEN
      DO
       BORROWER2LIFEBDATE=DATEOFFSET(LBDAY(2),LIFETABLEMAXJTAGE*12,0)
       IF BORROWER2LIFEBDATE<LIFEDATE THEN LIFEDATE=BORROWER2LIFEBDATE
      END
     
     BORROWER1DISBBDATE=DATEOFFSET(LBDAY(1),DISBTABLEMAXAGE*12,0)
     DISBDATE=BORROWER1DISBBDATE
     IF LBDAY(2)<>'--/--/--' THEN
      DO
       BORROWER2DISBBDATE=DATEOFFSET(LBDAY(2),DISBTABLEMAXJTAGE*12,0)
       IF BORROWER2DISBBDATE<DISBDATE THEN DISBDATE=BORROWER2DISBBDATE
      END
     
     IF LIFEDATE<LIFETERMDATE THEN LIFETERMDATE=LIFEDATE
     IF DISBDATE<DISBTERMDATE THEN DISBTERMDATE=DISBDATE
     [
     POPUPMESSAGE(0,"LOAN:MATURITYDATE = "+FORMAT("99/99/9999",LOAN:MATURITYDATE))
     POPUPMESSAGE(0,"LOANINSURANCETYPE = "+FORMAT("###9",LOANINSURANCETYPE))
     POPUPMESSAGE(0,"LIFETABLE = "+FORMAT("###9",LIFETABLE))
     POPUPMESSAGE(0,"DISBTABLE = "+FORMAT("###9",DISBTABLE))
     POPUPMESSAGE(0,"LIFETABLEMAXAGE = "+FORMAT("###9",LIFETABLEMAXAGE))
     POPUPMESSAGE(0,"LIFETABLEMAXJTAGE = "+FORMAT("###9",LIFETABLEMAXJTAGE))
     POPUPMESSAGE(0,"DISBTABLEMAXAGE = "+FORMAT("###9",DISBTABLEMAXAGE))
     POPUPMESSAGE(0,"DISBTABLEMAXJTAGE = "+FORMAT("###9",DISBTABLEMAXJTAGE))
     POPUPMESSAGE(0,"AGEBORROWER1 = "+FORMAT("###9",AGEBORROWER1))
     POPUPMESSAGE(0,"AGEBORROWER2 = "+FORMAT("###9",AGEBORROWER2))
     POPUPMESSAGE(0,"BORROWER1LIFEBDATE = "+FORMAT("99/99/9999",BORROWER1LIFEBDATE))
     POPUPMESSAGE(0,"BORROWER2LIFEBDATE = "+FORMAT("99/99/9999",BORROWER2LIFEBDATE))
     POPUPMESSAGE(0,"BORROWER1DISBBDATE = "+FORMAT("99/99/9999",BORROWER1DISBBDATE))
     POPUPMESSAGE(0,"BORROWER2DISBBDATE = "+FORMAT("99/99/9999",BORROWER2DISBBDATE))
     ]
    END
      
  END 
END

  #INCLUDE "RD.SYMFORM.PRO"
  #INCLUDE "RD.NAME.AND.ACCOUNT.PRO"
  #INCLUDE "RD.STICKYNOTESACCOUNT.PRO"
  #INCLUDE "INS.ELEC.FORM.INC"
  #INCLUDE "INS.ELEC.FORM.SYMFORM"

