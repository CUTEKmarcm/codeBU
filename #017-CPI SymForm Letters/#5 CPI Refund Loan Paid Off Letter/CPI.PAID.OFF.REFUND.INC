[Created by RD.SYMFORM.DESIGNER on 04/04/2023 at 07:09
 Driver           - CPI.PAID.OFF.REFUND
 Field Assignment - CPI.PAID.OFF.REFUND.INC
 Symform Commands - CPI.PAID.OFF.REFUND.SYMFORM
 Form file name   - CPI.PAID.OFF.REFUND.SFF
]

[Populate FORMDATA array]
PROCEDURE ASSIGNFIELDVARIABLES
  TOTALINDEX    = 0
  FIELDMAX      = 020
  DATACOUNT(01) = 020
  
  SPELLDATE=SYSTEMDATE
  CALL DATESPELL   
  FORMDATA(001)=SPELLCHAR
  
  FORMDATA(002)=CAPITALIZE(MEMBERNAME)
  IF JOINTMEMBERNAME<>"" THEN
   DO
    FORMDATA(003)=CAPITALIZE(JOINTMEMBERNAME)
    FORMDATA(004)=CAPITALIZE(MEMBERSTREET)
    IF MEMBEREXADDRESS<>"" THEN
     DO
      FORMDATA(004)=CAPITALIZE(MEMBERSTREET)+" "+CAPITALIZE(MEMBEREXADDRESS)
     END
    FORMDATA(005)=CAPITALIZE(MEMBERCITY)+", "+MEMBERSTATE+"  "+MEMBERZIP
   END
  ELSE
   DO
    FORMDATA(003)=CAPITALIZE(MEMBERSTREET)
    IF MEMBEREXADDRESS<>"" THEN
     DO
      FORMDATA(003)=CAPITALIZE(MEMBERSTREET)+" "+CAPITALIZE(MEMBEREXADDRESS)
     END
    FORMDATA(004)=CAPITALIZE(MEMBERCITY)+", "+MEMBERSTATE+"  "+MEMBERZIP    
    FORMDATA(005)=""
   END
  FORMDATA(006)=CAPITALIZE(MEMBERFIRSTNAME)+","  
  FORMDATA(007)=ACCTNO+"-"+LOANID
  
  SPELLDATE=LADVDATE
  CALL DATESPELL
  FORMDATA(008)=SPELLCHAR  
  
  FORMDATA(009)=FORMAT("#,##9.99",LADVAMNT)
  
  SPELLDATE=ADDEDFROMDATE
  CALL DATESPELL  
  FORMDATA(010)=SPELLCHAR
  
  SPELLDATE=ADDEDTODATE
  CALL DATESPELL
  FORMDATA(011)=SPELLCHAR  

  FORMDATA(012)=FORMAT("#,##9.99",LREFUNDAMNT)
  
  SPELLDATE=REFUNDFROMDATE
  CALL DATESPELL  
  FORMDATA(013)=SPELLCHAR
  
  SPELLDATE=REFUNDTODATE
  CALL DATESPELL
  FORMDATA(014)=SPELLCHAR  
  
  SPELLDATE=LCLOSEDATE
  CALL DATESPELL
  FORMDATA(015)=SPELLCHAR 
  
  FORMDATA(016)=""
  FORMDATA(017)=""
  FORMDATA(018)=""
  FORMDATA(019)=""
  FORMDATA(020)=""

  FOR FORMLOOP=1 TO FIELDMAX
   DO
    TEMPCHAR=FORMDATA(FORMLOOP)
    CALL SLASHOUTPUT
    FORMDATA(FORMLOOP)=TEMPCHAR
   END
END

[Assign FORMDATA back for FM]
PROCEDURE UPDATEFIELDVARIABLES
END
