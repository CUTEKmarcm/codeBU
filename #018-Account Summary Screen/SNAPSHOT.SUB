[SNAPSHOT.SUB This is the account snapshot demand repgen SUBROUTINE that pops up everytime
  the account is brought up in Teller Transactions or Account Manager.
  It has the following functions:
    *Check for account sensitivity and user privilege.
    *Display account number & primary name at top with Probation or New Account warning.
    *Display member information about primary and all joints on shares and loans
    *Address, Base Hold Amount, and current hold information
    *Share listing including average deposits, average balance, and NSF/Courtesy pay history.
    *Loan listing if needed.
    *Deposit history.     ]

[ 04/21/05 GH Added Joints not on other shares - shows in Purple]
[ 05/06/05 GH Added RED for negative share amounts]
[ 05/13/05 GH Added Cross account base holds to screen per James - shows in blue]
[ 10/05/05 GH Modified to verify name lookup on other account is not expired]
[ 10/12/05 GH Added Opened Share, MMN, Branch and DL#.  eMail and WK will show even if blank]
[ 10/31/05 GH Added Security Question, WK and Cell to display]
[ 11/02/05 GH changed License to D/S/P for Drivers License, State ID and Passport]
[ 11/15/05 GH Fixed problem with benificiaries and signers no showing up as NOT joint]
[ 11/21/05 GH Added ReOpened Warning logo and date at top and display all shares even closed if  warning 56]
[ 01/10/06 GH Added wording and name review for business account authorized signers and fixed  signer 
              wording in name type]
[ 02/07/06 GH Added columns for Maturity date and rate to share sections per James]
[ 05/30/06 GH Added CU Mortgage Information and removed loan deposits for average deposits]
[ 07/28/06 GH Removed beneficiaries from diplaying per Karen]
[ 09/05/06 GH Modified to reduce font size for better printing]
[ 01/03/07 GH Added Account Type 98 to show closed share history and chargedoff loan history]
[ 02/27/07 GH Added routine to store share comments and then match them to deposit transactions]
[ 06/26/07 GH Added new Name Types and changed wording for names not found on shares to 
              CANNOT DO TRANSACTIONS ON and added code for a POA on Account]
[ 07/02/07 GH Changed wording for a trustee found at the account level or on any 
              individual share is a trustee on ALL shares]
[ 07/20/07 GH ADDED 4 NEW BRANCHES]
[ 09/25/07 GH Added coloring change for Mortgages in our portfolio per Tony]
[ 10/30/07 GH Added color MAROON to certs in their grace period]
[ 01/03/08 GH Changed certs to verify orig date<>opendate to change color for grace period]
[ 12/04/08 GH Added interest due to loan balance on VISA Card loans per Tony]
[ 12/08/08 GH Added new flashing sign for warning 75 - needs new id scanned]
[ 04/29/09 GH Modofied to stop multiple incomplete credit reports when Equifax is down]
[ 05/26/09 GH Modified to use IS.DEF and IS.SETUP for branch names]
[ 08/03/09 GH Added all closed checking 80-89 to display per Karen]
[             Also added reduced payment instead of normal if amount found in payment bucket 2  and not expired]
[ 08/06/09 GH Added display of current email status to top of page]
[ 10/27/09 GH Added color change for different types of accounts and minors]
[ 11/12/09 GH Added birthdaye color change to red if current date is their birthday]
[ 01/27/10 GH Added expired identification/license for 1st record found for each SSN per Karen]
[ 03/11/10 GH Added CANNOT DO TRANSACTION for names only on Loans and no shares]
[ 03/11/11 gh Added lines to show POA comments]
[ 03/17/11 GH Added comment search to look for password]
[ 05/13/11 GH Added negative sign to hold amounts and move negative sign to front of amounts.   OK'd per Karen]
[ 06/16/11 GH Modified Reopened date to allways show if found and to swap positions with open  date if found]
[ 07/12/11 GH Modified to include Adverse Action Codes and create new Tracking 31 if credit  report found with no tracking 31]
[ 07/13/11 GH Modified to exclude Employee, family and Board accts from auto updates per Raye  Anne.  Will  still update at night.]
[ 07/19/11 GH MOVED CREDIT REPORT UPDATE AND PULL OUT OF SNAPSHOT.SUB AND PUT IN NEWTELLER.SCR]
[ 08/10/11 GH Added Account Level Authorized signer to "all shares"]
[ 10/12/11 GH Added new licens lookup link to the SSN]
[ 03/27/12 CB Added Reg D Count and changed "Overdraft Tolerance" to "Overdraft Privilege ]
[ 04/10/12 GH Added last statement balance for VISA cards]
[ 04/24/12 CB Changed ODT to ODP (Overdraft Privilege) Approved by Sandie Pena, AVP of Branch Operations]
[ 07/13/12 GH Added Beacon score check for newer SerTech tracking 55 if found per Tony]
[ 08/21/12 GH Added popup html screen for board and Supervisory per James]
[ 10/03/12 CB Changed wording "Important Note" to "PASSWORD REQUIRED"]
[ 09/24/13 CB Changed Bill Pay to look at Tracking 59 instead of Card Type 21 - Converted to WRG Bill Pay on September 18, 2013]
[ 06/02/14 GH Added closed account per Karen - In New Online Account Opening meeting]
[ 06/05/14 GH Added flashing Opened Online for oflows accounts]
[ 02/17/15 GH Added tracking review for last online banling login]
[ 06/09/15 GH Modified GLENTRY section for money received that only paid a loan with no deposit]
[ 12/01/15 GH Added SSN Masking]
[ 01/06/16 GH ADDED B - Birth certificate and G - Gun License]
[ 06/07/16 GH Added FMPerform if Micr on checking is blank or incorrect]
[ 02/07/17 GH Added Closed date to screen]
[ 07/20/17 GH Added code to look for trust or business name on account]
[ 06/07/19 GH Removed CoWWW ID lookup because we now only use Synergy]
[ 01/14/20 GH Added Total for Loan Section]
[ 09/14/20 JJ Added age and logic to recognize SYMAPP accounts as online openings. ]

SUBROUTINE DEMAND

WINDOWS

TARGET=ACCOUNT

DEFINE
 #INCLUDE "IS.DEF"
 #INCLUDE "SNAPSHOT.CREDIT.REPORT.DEF"
 #INCLUDE "SNAPSHOT.REDFLAG.SNAPSHOT.DEF"
 [HTML Shortcuts]
 MFORMAT="$ +###,###,##9.99" 
 NFORMAT="###,###,##9.99"                         [Used on holds to allow addition of negative  sign]
 DFORMAT="99/99/99"
 RFORMAT="###,##9.99#%"
 Q=CHARACTER
 SP="&nbsp;"
 CNEG="<B><font face=arial color=RED>"
 ECNEG="</font></font>"


 BEACONCOLOR=CHARACTER
 STOPLIGHT=CHARACTER

 [Account Info Storage]
 USERACCT=CHARACTER(10) ARRAY(50)
 ACCTRESTINQ=NUMBER
 ACCTSENSINQ=NUMBER
 EMPACCTREST=NUMBER
 EMPACCTOTHR=NUMBER
 EMPACCTSENS=NUMBER
 EMPACCTFAM=NUMBER
 EMPACCTFAMSENS=NUMBER
 RESTRICTED=NUMBER
 ALCOUNT=NUMBER
 ADDLINE=CHARACTER ARRAY(15)
 MAILADD=NUMBER
 HCOUNT=NUMBER
 HDESC=CHARACTER ARRAY(15)
 HAMT=CHARACTER ARRAY(15)
 HEXP=CHARACTER ARRAY(15)
 BALANCE=MONEY
 SLOT=NUMBER
 DAILYBALANCE=MONEY ARRAY(400)
 TOTDAILYBAL=MONEY
 SHAREAVGDAILYBAL=MONEY
 LCDEPS=MONEY           ARRAY(500)
 LCDATE=DATE            ARRAY(500)
 LC=NUMBER
 FOUNDLCDEP=CHARACTER(1)
 AVGDEPS=MONEY
 TOTAVGDEPS=MONEY
 TOTSHAREAVGBAL=MONEY
 TOTAVAILBALANCE=MONEY
 TOTBALANCE=MONEY
 LOANFOUND=NUMBER
 DEPDATE=DATE ARRAY (500)
 DEPDESC=CHARACTER ARRAY (500)
 DEPAMT=MONEY ARRAY (500)
 DEPFLAG=NUMBER ARRAY (500)
 HALFDEP=NUMBER
 RCLR=CHARACTER(10)
 CAPDESC=CHARACTER
 
 [Various]
 MAX=NUMBER
 TRUE=1
 FALSE=0
 OUTLINE=CHARACTER

 [MISMATCH JOINT VARIABLES]
 SNAMES=CHARACTER(40)       ARRAY(999,6)
 UNIQUENAMES=CHARACTER(40)  ARRAY(999,6)
 FOUNDUNIQUE=CHARACTER(1)
 U=NUMBER
 UN=NUMBER
 MI=NUMBER
 MJ=NUMBER
 ML=NUMBER
 MO=NUMBER
 MW=NUMBER
 MX=NUMBER
 MSP=NUMBER
 CNT=NUMBER
 SHIDS=CHARACTER
 ONIDS=CHARACTER
 ALLIDS=CHARACTER
 WORKED=CHARACTER(40)     ARRAY(999,5)
 FOUNDNAME=CHARACTER(1)
 OUTMISLINE=CHARACTER     ARRAY(200,3)
 POANAMES=CHARACTER(80)   ARRAY(100,3)
 PO=NUMBER
 PA=NUMBER
 FOUNDPOA=CHARACTER(1)
 
 [VARIABLES FOR CROSS ACCOUNT BASE HOLDS]
 SSNARRAY=CHARACTER(40)   ARRAY(500,2)
 SCNT=NUMBER
 ACCTINFO=CHARACTER(40)   ARRAY(500,3)
 ACCTHOLD=MONEY           ARRAY(500)
 ACNT=NUMBER
 FOUNDACCT=CHARACTER(1)
 FULLACCT=CHARACTER(10)
 PREVSSN=CHARACTER(40)
 LCNT=NUMBER
 SA=NUMBER
 SN=NUMBER
 FIRSTOTHER=CHARACTER(1)
 FOUNDVALIDSNAME=CHARACTER(1)
 BILLPAY=CHARACTER(1)
 REOPENDATE=DATE
 FIRSTTRAN=CHARACTER(1)

 [Variables for printing]
 #INCLUDE "RD.OUTPUT.DEF"
 BRNO=NUMBER
 PRNO=NUMBER              ARRAY(500)
 PRNT=NUMBER
 ERROR=CHARACTER
 ANAME=CHARACTER(40)
 NAMEINFO=CHARACTER(20)  ARRAY(500,8)
 NI=NUMBER
 NJ=NUMBER
 HP=CHARACTER(40) 
 WP=CHARACTER(40)
 CELL=CHARACTER(40)
 EM=CHARACTER(40)
 FOUNDDOUBLE=NUMBER

 PERCENTPLEDGED=RATE
 LPACCT=CHARACTER(10)
 LPID=CHARACTER(4)
 TOTHOLD=MONEY
 LNACCT=CHARACTER(10)
 LNID=CHARACTER(4)
 LOANPLEDGES=CHARACTER       ARRAY(250)
 LP=NUMBER
 LPC=NUMBER
 
 TRANSCOMMENTS=CHARACTER(40) 
 TRANSTIME=NUMBER                  
 TRANSSEQ=NUMBER             
 TRANSDATE=DATE               
 TRANSUSER=NUMBER              
 TRANSID=CHARACTER(2)          
 TRANSCONT=CHARACTER(1) 
 TRANSHOLD=CHARACTER(1)  
 MORTGAGETYPES=CHARACTER(30)  ARRAY(100)    
 MS=NUMBER
 MCOLOR=CHARACTER(30)         ARRAY(2)
 MCEND=CHARACTER(15)          ARRAY(2)
 MC=NUMBER
 MASOF=NUMBER
 GRACEPERIOD=CHARACTER(1)
 OVERRIDECOLOR=CHARACTER
 ISMINOR=CHARACTER(1)
 BDSSN=CHARACTER(9)            ARRAY(100)
 BDD=NUMBER

 SD=NUMBER
 DISPEXP=CHARACTER(1)
 FIRSTNOTE=CHARACTER(1)
 FOUNDCARD=CHARACTER(1)
 OPTINSTATUS=CHARACTER
 POACOMMENTS=CHARACTER(40)    ARRAY(100)
 PI=NUMBER
 PC=NUMBER
 UC=CHARACTER
 PASSWORDCOMMENT=CHARACTER
 PSSN=CHARACTER
 INPUTCOUNT=NUMBER
 INPUTFORM=CHARACTER         ARRAY(100)  
 TMPCHR=CHARACTER
 FNDINPSSN=CHARACTER(1)
 III=NUMBER
 FI=NUMBER
 INPSSNS=CHARACTER           ARRAY(500)
 ENDLESSLOOP=CHARACTER(1)
 NMMN=CHARACTER
 OSSN=CHARACTER(9)              ARRAY(9999,2)
 OS=NUMBER
 MOBILESIGNUP=NUMBER
 MOBILEDEPOSIT=NUMBER
 LASTMOBILELOGIN=DATE
 LASTBAL=MONEY
 ADDCOLUMNS=CHARACTER(1)
 ACSPAN=NUMBER
 PMSCORE=NUMBER
 PMDATE=DATE
 DSCORE=NUMBER
 DDATE=DATE
 RTLASTUPDATE=DATE
 OTCOMMENT=CHARACTER         ARRAY(200,2)
 OT=NUMBER
 OTL=NUMBER
 OI=NUMBER
 PREVSEQ=NUMBER
 INITERROR=CHARACTER
 CLACNT=NUMBER
 CLACCTINFO=CHARACTER       ARRAY(200,3)
 LASTLOGIN=DATE
 OUTCODE=CHARACTER
 FIRSTGLENTRY=CHARACTER(1)
 IDN=NUMBER
 ADDMICR=CHARACTER(2)       ARRAY(100)
 MCR=NUMBER
 MCI=NUMBER
 INUMBER=NUMBER
 IERROR=CHARACTER
 ILINE=CHARACTER
 IERROR2=CHARACTER
 DEBUGTEST=CHARACTER
 NOTEI=NUMBER
 APPONLY=CHARACTER(1)
 APPI=NUMBER
 PDOB=DATE
 DECEASEDATE=DATE
 PNAMEFORMAT=NUMBER
 FNDCOLOROVERRIDE=CHARACTER(1)
 CHGOFFSHARE=CHARACTER(1)
 CHGOFFLOAN=CHARACTER(1)
 TOTLNPMTS=MONEY
 TOTLNDELS=MONEY
 TOTLNBALS=MONEY
 MEMBERAGE=NUMBER
 BSSNMATCH=NUMBER
 Z=NUMBER
 PMSCOREARRAY=NUMBER ARRAY(5)
 PMDATEARRAY=DATE ARRAY(5)
 temp=CHARACTER
 DA=NUMBER
 YR=NUMBER
END

SETUP 
 [FILEOPEN("LETTER","TELLERTEST","READ",INUMBER,IERROR)       
  FILEREADLINE(INUMBER,ILINE,IERROR)
  IF LENGTH(ILINE)>0 THEN DEBUGTEST=SEGMENT(ILINE,1,1)
 FILECLOSE(INUMBER,IERROR)]
 DEBUGTEST="N"
 ILINE=FORMAT("99/99/99",SYSTEMDATE)+"~"+FORMAT("99:99",SYSACTUALTIME)+"~"+ACCOUNT:NUMBER+"~"+FORMAT("9999",SYSUSERNUMBER)+"~7~START~SNAPSHOT.SUB "
 IF DEBUGTEST="Y" THEN
  DO
   FILEOPEN("LETTER","FINDBUG","APPEND",INUMBER,IERROR)       
    FILEWRITELINE(INUMBER,ILINE,IERROR)
    IF IERROR<>"" THEN FILEWRITELINE(INUMBER,"~7~START Error:~"+IERROR,IERROR2)
   FILECLOSE(INUMBER,IERROR)
  END
 DEBUGTEST="N"
 #INCLUDE "IS.SETUP"
 BRNO=GETDATANUMBER(GETCONSOLEBRANCH,SYSCONSOLENUM)
 PSSN=NAME:SSN
 PDOB='--/--/--'
 DECEASEDATE='--/--/--'
 IF NAME:DEATHDATE<>'--/--/--' THEN DECEASEDATE=NAME:DEATHDATE
 ELSE IF ACCOUNT:TYPE<10 AND NAME:BIRTHDATE<>'--/--/--' AND 
    NAME:BIRTHDATE<=DATEOFFSET(SYSTEMDATE,-60*12,0) THEN PDOB=NAME:BIRTHDATE
 LOANFOUND=FALSE
 FULLACCT=ACCOUNT:NUMBER
 PSSN=NAME:SSN
 PNAMEFORMAT=NAME:NAMEFORMAT
 NMMN=NAME:MOTHERSMAIDENNAME
 ANAME=CAPITALIZE(NAME:LONGNAME)
 OVERRIDECOLOR=""
 IF ACCOUNT:TYPE=4 OR ACCOUNT:TYPE=5 OR ACCOUNT:TYPE=8 OR ANYWARNING(ACCOUNT,87) THEN CALL BOARDMEMBER
 CALL FILLINNAMETYPE
 OUTPUTOPEN(OUTPUTDEVCONSOLE,0,"Screen","",OUTPUTCHANNEL1,ERRORTEXT)
 MO=2
 Q=CTRLCHR(34)
 ACCTNO=ACCOUNT:NUMBER
 WHILE SEGMENT(ACCTNO,1,1)="0"
  DO
   ACCTNO=SEGMENT(ACCTNO,2,LENGTH(ACCTNO))
  END
 IF NAME:BIRTHDATE='--/--/--' OR DATEOFFSET(SYSTEMDATE,-18*12,0)>=NAME:BIRTHDATE THEN ISMINOR="N"
 ELSE ISMINOR="Y"
 LASTLOGIN='--/--/--'
 IF ACCOUNT:USERDATE2<>'--/--/--' THEN LASTLOGIN=ACCOUNT:USERDATE2
 BILLPAY="N"
 FOUNDCARD="N"
 WHILELIMIT=8000000
 FOR OS=1 TO 9999
  DO
   OSSN(OS,1)=""
   OSSN(OS,2)=""
  END
 FOR EACH TRACKING WITH TRACKING:EXPIREDATE='--/--/--'
  DO
   IF TRACKING:TYPE=0 THEN LOANFOUND=TRUE
   IF TRACKING:TYPE=59 THEN
    DO
     IF TRACKING:USERDATE3<>'--/--/--' THEN BILLPAY="Y"
     IF TRACKING:USERDATE5>LASTLOGIN THEN LASTLOGIN=TRACKING:USERDATE5
    END
  END

 FOR EACH CARD WITH CARD:STATUS<2 AND (CARD:EXPIRATIONDATE>SYSTEMDATE OR  CARD:EXPIRATIONDATE='--/--/--')
  DO
   IF CARD:TYPE=20 OR CARD:TYPE=30 THEN
    DO
     FOUNDCARD="Y"
    END
  END

 CHGOFFLOAN="N"
 IF ANYWARNING(ACCOUNT,9) OR ANYWARNING(LOAN,9) THEN CHGOFFLOAN="Y"
 CHGOFFSHARE="N"
 IF CHGOFFLOAN="N" THEN
  DO
   FOR EACH LOAN
    DO
     IF ANYWARNING(LOAN,9) OR LOAN:CHARGEOFFDATE<>'--/--/--' THEN CHGOFFLOAN="Y"
    END
  END
 IF ANYWARNING(ACCOUNT,186) OR ANYWARNING(LOAN,186) THEN CHGOFFSHARE="Y"
 IF CHGOFFSHARE="N" THEN
  DO
   FOR EACH SHARE
    DO
     IF ANYWARNING(SHARE,186) OR SHARE:CHARGEOFFDATE<>'--/--/--' THEN CHGOFFSHARE="Y"
    END
  END

 REOPENDATE='--/--/--'
 FOR EACH COMMENT WITH COMMENT:EXPIRATIONDATE='--/--/--'
  DO
   UC=UPPERCASE(COMMENT:COMMENT)
   IF CHARACTERSEARCH(UC,"PASSWORD")>0 THEN PASSWORDCOMMENT=COMMENT:COMMENT
   IF REOPENDATE='--/--/--' AND SEGMENT(UC,1,16)="ACCOUNT REOPENED" THEN REOPENDATE=DATEVALUE (SEGMENT(COMMENT:COMMENT,18,27))
   IF CHARACTERSEARCH(UC,"POA")>0 OR CHARACTERSEARCH(UC,"P O A")>0 OR CHARACTERSEARCH (UC,"P.O.A.")>0 OR CHARACTERSEARCH(UC,"P. O. A.")>0 THEN
    DO
     PC=PC+1
     POACOMMENTS(PC)=COMMENT:COMMENT
    END
  END

 RESTRICTED=FALSE
 IF ACCOUNT:RESTRICT<>0 THEN CALL CHECKRESTRICTED
 CALL GETBEACON
 FOR I=0 TO 15
  DO
   HDESC(I)=""
   HAMT(I)=""
   HEXP(I)=""
   ADDLINE(I)=""
  END
 FOR I=0 TO 500
  DO
   DEPDATE(I)='--/--/--'
   DEPDESC(I)=""
   DEPAMT(I)=$0.00
   DEPFLAG(I)=0
  END
 HCOUNT=1
 MAILADD=FALSE
 TOTAVGDEPS=$0.00
 TOTSHAREAVGBAL=$0.00
 TOTAVAILBALANCE=$0.00
 TOTBALANCE=$0.00
 IF ACCOUNT:NUMBER<>"0000090000" AND ACCOUNT:NUMBER<>"0000090001" AND 
    PSSN<>"000000000" AND LENGTH(PSSN)>0 THEN CALL GETOTHERHOLDS
 CALL GETLOANDEPOSITS
 ENDLESSLOOP="Y"
 WHILE ENDLESSLOOP="Y"
  DO
   FOR III=1 TO FI
    DO
     INPSSNS(III)=""
    END
   CALL MAINSCREEN
  END
 ILINE=FORMAT("99/99/99",SYSTEMDATE)+"~"+FORMAT("99:99",SYSACTUALTIME)+"~"+ACCOUNT:NUMBER+"~"+FORMAT("9999",SYSUSERNUMBER)+"~7~END~SNAPSHOT.SUB "
 IF DEBUGTEST="Y" THEN
  DO
   FILEOPEN("LETTER","FINDBUG","APPEND",INUMBER,IERROR)       
    FILEWRITELINE(INUMBER,ILINE,IERROR)
    IF IERROR<>"" THEN FILEWRITELINE(INUMBER,"~7~END Error:~"+IERROR,IERROR2)
   FILECLOSE(INUMBER,IERROR)
  END
 DEBUGTEST="N"
END

PRINT TITLE="ACCOUNT SNAPSHOT"
 SUPPRESSNEWLINE
END

PROCEDURE MAINSCREEN
[ IF RESTRICTED=FALSE THEN
  DO
   FOR MCI=1 TO MCR                                            [Clear array]
    DO
     ADDMICR(MCI)=""
    END
   MCR=0
   FOR EACH SHARE WITH SHARE:TYPE>=80 AND SHARE:TYPE<=89 AND   [Check Micr on each checking - Added 6/7/16]
                       SHARE:CLOSEDATE='--/--/--'  
    DO
     IF SHARE:MICRACCTNUMBER<>"1"+ADDMICR(MCI)+SEGMENT(ACCOUNT:NUMBER,4,10) THEN
      DO
       MCR=MCR+1
       ADDMICR(MCR)=SHARE:ID
      END
    END
   FOR MCI=1 TO MCR
    DO
     FMPERFORM REVISE SHARE ADDMICR(MCI) (0,0,ERRORTEXT)       [Update MICR if incorrect]
      DO
       SET MICRACCTNUMBER TO "1"+ADDMICR(MCI)+SEGMENT(ACCOUNT:NUMBER,4,10)
      END
     IF ERRORTEXT<>"" THEN POPUPMESSAGE(0,"Error setting Micr: "+ERRORTEXT)
    END
  END]

 FOR EACH TRACKING WITH TRACKING:TYPE=59
  DO
   LASTMOBILELOGIN=TRACKING:USERDATE18
   IF TRACKING:EXPIREDATE='--/--/--' THEN 
    DO
     MOBILESIGNUP=TRUE
     IF TRACKING:USERNUMBER15=1 THEN MOBILEDEPOSIT=TRUE
    END
  END
 [IF SYSSYMDIRECTORY=0 AND SYSUSERNUMBER<>372 AND SYSUSERNUMBER<>484 AND 
    SYSUSERNUMBER<>40 AND SYSUSERNUMBER<>38 AND SYSUSERNUMBER<>159 AND [EXCLUDE REBECCA, GEORGIA,COREY AND SANDIE FROM EMAILS]
    (ANYWARNING(ACCOUNT,4) OR ANYWARNING(LOAN,4)) THEN                 [Specific Collection  Warning]
  DO
   OUTLINE="Collections account "+ACCOUNT:NUMBER+" accessed by "+FORMAT("##99",SYSUSERNUMBER)+"  "+SYSUSERNAME(SYSUSERNUMBER)
   OUTLINE=OUTLINE+" on "+FORMAT("99/99/99",SYSTEMDATE)+" at "+FORMAT("99:99",SYSACTUALTIME)
   EMAILSTART("","","",ERRORTEXT)                                      [SEND AUTOMATIC EMAIL]
   EMAILLINE("From: reports@atfcu.org",ERRORTEXT)
   EMAILLINE("To: rsoriano@atfcu.org",ERRORTEXT)
   EMAILLINE("Subject: Collection Account Accessed",ERRORTEXT)
   EMAILLINE(OUTLINE,ERRORTEXT)
   EMAILSEND(ERRORTEXT)
  END ]
 IF SYSSYMDIRECTORY=0 AND SYSUSERNUMBER<>40 AND SYSUSERNUMBER<>87 AND [SANDIE, JOHN PAUL]
    SYSUSERNUMBER<>170 AND SYSUSERNUMBER<>484 AND                     [DOLLY, GEORGIA ]
    (ANYWARNING(ACCOUNT,90) OR ANYWARNING(SHARE,90)) THEN             [ChargeBack History Warning]
  DO
   OUTLINE="ChargeBack History Warning on "+ACCOUNT:NUMBER+" accessed by "+FORMAT("##99",SYSUSERNUMBER)+"  "
   OUTLINE=OUTLINE+SYSUSERNAME(SYSUSERNUMBER)+" on "+FORMAT("99/99/99",SYSTEMDATE)+" at "+FORMAT("99:99",SYSACTUALTIME)
   EMAILSTART("","","",ERRORTEXT)                                     [SEND AUTOMATIC EMAIL]
   EMAILLINE("From: reports@atfcu.org",ERRORTEXT)
   EMAILLINE("To: jramirez@atfcu.org",ERRORTEXT)
   EMAILLINE("Cc: spena@atfcu.org",ERRORTEXT)
   EMAILLINE("Subject: ChargeBack Account Accessed",ERRORTEXT)
   EMAILLINE(OUTLINE,ERRORTEXT)
   EMAILSEND(ERRORTEXT)
  END   
 WHILELIMIT=2147483647
 DEBUGTEST="N"
 ILINE=FORMAT("99/99/99",SYSTEMDATE)+"~"+FORMAT("99:99",SYSACTUALTIME)+"~"+ACCOUNT:NUMBER+"~"+FORMAT("9999",SYSUSERNUMBER)+"~7~H1 START~MAIN SCREEN "
 IF DEBUGTEST="Y" THEN
  DO
   FILEOPEN("LETTER","FINDBUG","APPEND",INUMBER,IERROR)       
    FILEWRITELINE(INUMBER,ILINE,IERROR)
    IF IERROR<>"" THEN FILEWRITELINE(INUMBER,"~7~H1 START Error:~"+IERROR,IERROR2)
   FILECLOSE(INUMBER,IERROR)
  END
 HTMLVIEWOPEN(0)
 HTMLVIEWLINE("<head>")
 HTMLVIEWLINE("<title>Account Snapshot</title>")
 HTMLVIEWLINE("<meta http-equiv=Content-Type content=text/html; charset=utf-8>")
 HTMLVIEWLINE("<title>Account Change Card</title>")
 HTMLVIEWLINE("</head>")
 HTMLVIEWLINE("<body bgcolor=#E0E0E0>")
 HTMLVIEWLINE("<font face=arial>")
 HTMLVIEWLINE(" <form name=Accounts METHOD=POST ACTION=symitar://HTMLView~Action=Post>")

 [*Display account number & primary name at top with Probation or New Account warning.]
 IF ACCOUNT:TYPE<>21 AND PNAMEFORMAT=0 THEN           [Not a Trust and name is an individual name (not business)]
  DO
   FOR EACH NAME WITH NAME:TYPE=2 AND                     [Review mail override for business name]
                      NAME:EXPIRATIONDATE='--/--/--' AND  [Mail Override is not expired]
                      NAME:NAMEFORMAT=1                   [Mail Override name is a non individual name]
    DO
     ANAME=CAPITALIZE(NAME:LONGNAME)
    END
  END 
 ELSE IF ACCOUNT:TYPE=21 THEN                             [Account is a Trust]
  DO
   IF CHARACTERSEARCH(ANAME,"TRUST")=0 THEN               [If the word TRUST is not in the Primary name - look for Mail override]
    DO
     FOR EACH NAME WITH NAME:TYPE=2 AND                   [Use mail override for business name]
              NAME:EXPIRATIONDATE='--/--/--'              [Mail Override is not expired]
      DO
       ANAME=CAPITALIZE(NAME:LONGNAME)
      END
    END
  END
 HTMLVIEWLINE("<TABLE BORDER=0 CELLPADDING=2 WIDTH=100%>")
 HTMLVIEWLINE("<TR>")
 HTMLVIEWLINE("   <TD COLSPAN=2><FONT SIZE=5><B>"+ACCTNO+" - "+"</FONT><FONT SIZE=5><B>"+ANAME +"</B></FONT>")
 IF DECEASEDATE<>'--/--/--' THEN HTMLVIEWLINE("<FONT SIZE=5 color=RED><B> * Deceased "+FORMAT("99/99/99",DECEASEDATE)+" *</B></FONT>")
 ELSE IF PDOB<>'--/--/--' THEN HTMLVIEWLINE("<FONT SIZE=5 color=#cc6600><B> * VIM Member *</B></FONT>")
 HTMLVIEWLINE("   </TD>")
 IF ACCOUNT:CLOSEDATE<>'--/--/--' THEN 
   HTMLVIEWLINE("<TD ALIGN=LEFT><IMG SRC=closed.gif WIDTH=250 HEIGHT=50></TD>")
 ELSE IF ACCOUNT:TYPE=97 THEN 
   HTMLVIEWLINE("<TD ALIGN=LEFT><IMG SRC=telcoacct.gif WIDTH=250 HEIGHT=50></TD>")
 ELSE IF ANYWARNING(ACCOUNT,4) THEN 
   HTMLVIEWLINE("<TD ALIGN=LEFT><IMG SRC=Collections.gif WIDTH=400 HEIGHT=50></TD>")
 ELSE IF ACCOUNT:TYPE=98 THEN 
   HTMLVIEWLINE("<TD ALIGN=LEFT><IMG SRC=chgoffacct.gif WIDTH=250 HEIGHT=50></TD>")
 ELSE IF CHGOFFLOAN="Y" THEN 
   HTMLVIEWLINE("<TD ALIGN=LEFT><IMG SRC=chgoffloan.gif WIDTH=250 HEIGHT=50></TD>")
 ELSE IF CHGOFFSHARE="Y" THEN 
   HTMLVIEWLINE("<TD ALIGN=LEFT><IMG SRC=chgoffshare.gif WIDTH=260 HEIGHT=50></TD>")
 ELSE IF ANYWARNING(ACCOUNT,56) AND ACCOUNT:OPENDATE<DATEOFFSET(SYSTEMDATE,-3,0) THEN 
  HTMLVIEWLINE("<TD ALIGN=LEFT><IMG SRC=reopened.gif WIDTH=250 HEIGHT=50></TD>")
 ELSE IF ANYWARNING(ACCOUNT,24)THEN 
  HTMLVIEWLINE("<TD ALIGN=LEFT><IMG SRC=ProbAcctAnim.gif WIDTH=250 HEIGHT=50></TD>")
 ELSE IF SEGMENT(ACCOUNT:REFERENCE,1,3)="NWL" THEN
  HTMLVIEWLINE("<TD ALIGN=LEFT><IMG SRC=NWL_Former_Member.gif WIDTH=250 HEIGHT=50></TD>")
 ELSE IF ACCOUNT:TYPE=96 THEN
  HTMLVIEWLINE("<TD ALIGN=LEFT><FONT SIZE=5><B>***** NON MEMBER - APPLICATION ONLY ACCOUNT *****</B></FONT></TD>")
 ELSE IF SYSTEMDATE-ACCOUNT:OPENDATE<180 THEN 
  DO
   HTMLVIEWLINE("<TD ALIGN=LEFT>")
   IF ACCOUNT:CREATEDBYUSER=820 OR ANY SHARE WITH (SHARE:TYPE=0 AND (SHARE:CREATEDBYUSER=802 OR SHARE:CREATEDATBRANCH=5)) THEN 
    HTMLVIEWLINE("<IMG SRC=onlineaccount.gif WIDTH=255 HEIGHT=50>")
   ELSE HTMLVIEWLINE("<IMG SRC=NewAcctAnim.gif WIDTH=250 HEIGHT=50>")
   HTMLVIEWLINE("</TD>")
  END
 ELSE HTMLVIEWLINE("<TD ALIGN=LEFT>"+SP+"</TD>")
 HTMLVIEWLINE("   <TD COLSPAN=4 ALIGN=RIGHT>")
 HTMLVIEWLINE("   <INPUT type=SUBMIT name=CLOSE value='Click Here to Continue'") 
 HTMLVIEWLINE("   onMouseOver=this.style.color='#003300' onMouseOut=this.style.color='#003300'")  
 HTMLVIEWLINE("   style=color:RED; font-family:Arial black; font-weight:bold;font- size:20px;background-")
 HTMLVIEWLINE("   image:url();border-color:blue;border-width:3px;cursor:hand>")
 HTMLVIEWLINE("   </TD>")
 HTMLVIEWLINE("</TR>")
 HTMLVIEWLINE("</TABLE>")
 HTMLVIEWLINE("<TABLE BORDER=0 CELLPADDING=2 WIDTH=100%>")
 HTMLVIEWLINE("<TR>")
 IF REOPENDATE<>'--/--/--' THEN
  DO
   HTMLVIEWLINE("   <TD COLSPAN=2><FONT COLOR=BLACK SIZE=2>ReOpened: ")
   IF ANYWARNING(ACCOUNT,56) THEN HTMLVIEWLINE("</FONT><FONT COLOR=RED SIZE=2>")
   ELSE HTMLVIEWLINE("<FONT COLOR=BLUE SIZE=2>")
   HTMLVIEWLINE("<B>"+FORMAT("99/99/99",REOPENDATE)+"</B></FONT></TD>")
   IF ACCOUNT:CLOSEDATE<>'--/--/--' THEN 
    DO
     HTMLVIEWLINE("<TD><FONT COLOR=RED SIZE=3><B>Closed:</B> ")
     HTMLVIEWLINE("  </FONT><FONT COLOR=RED SIZE=3><B>"+FORMAT("99/99/99",ACCOUNT:CLOSEDATE)+"</B></FONT></TD>")
    END
   ELSE 
    DO
     HTMLVIEWLINE("<TD><FONT COLOR=BLACK SIZE=2>Originally Opened: ")
     HTMLVIEWLINE("</FONT><FONT COLOR=BLUE SIZE=2><B>"+FORMAT("99/99/99",ACCOUNT:OPENDATE)+"</B></FONT></TD>")
    END
  END
 ELSE 
  DO
   IF ACCOUNT:CLOSEDATE<>'--/--/--' THEN 
    DO
     HTMLVIEWLINE("<TD><FONT COLOR=BLACK SIZE=2>Opened: ")
     HTMLVIEWLINE("</FONT><FONT COLOR=BLUE SIZE=2><B>"+FORMAT("99/99/99",ACCOUNT:OPENDATE)+"</B></FONT></TD>")
     HTMLVIEWLINE("<TD COLSPAN=2><FONT COLOR=RED SIZE=3><B>Closed:</B> </FONT><FONT COLOR=RED ")
     HTMLVIEWLINE("  SIZE=3><B>"+FORMAT("99/99/99",ACCOUNT:CLOSEDATE)+"</B></FONT></TD>")
    END
   ELSE 
    DO
     HTMLVIEWLINE("<TD COLSPAN=3><FONT COLOR=BLACK SIZE=2>Opened: ")
     HTMLVIEWLINE("</FONT><FONT COLOR=BLUE  SIZE=2><B>"+FORMAT("99/99/99",ACCOUNT:OPENDATE)+"</B></FONT></TD>")
    END
  END
 HTMLVIEWLINE("    <td>&nbsp;</td>")
 HTMLVIEWLINE("     <TD COLSPAN=2 ALIGN=RIGHT><IMG SRC="+STOPLIGHT+" WIDTH=98 HEIGHT=32></TD>")
 HTMLVIEWLINE("</TR>")
 HTMLVIEWLINE("<TR>") 
 HTMLVIEWLINE("    <TD><FONT COLOR=BLACK SIZE=2>Branch: </FONT><FONT COLOR=BLUE  SIZE=2><B>"+BRANCHNAME(ACCOUNT:BRANCH)+"</B></FONT></TD>")
 HTMLVIEWLINE("    <TD><FONT COLOR=BLACK SIZE=2>MMN: </FONT><FONT COLOR=BLUE SIZE=2><B>"+NMMN +"</B></FONT></TD>")
 HTMLVIEWLINE("    <TD><FONT COLOR=BLACK SIZE=2>Acct Type: </FONT><FONT COLOR="+BEACONCOLOR+"  SIZE=2><B>"+CAPITALIZE(GETDATACHARACTER(301,ACCOUNT:TYPE))+"</B></FONT></TD>")
 HTMLVIEWLINE("    <TD><FONT COLOR=BLACK SIZE=2>Last Online Banking Login: </FONT><FONT COLOR=GREEN  SIZE=2><B>")
 IF LASTLOGIN='--/--/--' THEN HTMLVIEWLINE("<FONT COLOR=RED SIZE=2><B>Never Logged In</B></FONT></TD>")
 ELSE HTMLVIEWLINE(FORMAT("99/99/99",LASTLOGIN)+"</B></FONT></TD>")
 IF BILLPAY="Y" THEN
  HTMLVIEWLINE("    <TD><FONT COLOR=BLACK SIZE=2>Bill Pay: </FONT><FONT COLOR=GREEN  SIZE=2><B>Yes</B></FONT></TD>")
 ELSE HTMLVIEWLINE("    <TD><FONT COLOR=BLACK SIZE=2>Bill Pay: </FONT><FONT COLOR=RED  SIZE=2><B>No</B></FONT></TD>")
 HTMLVIEWLINE("</TR>")
 HTMLVIEWLINE("<TR>") 
 HTMLVIEWLINE("    <TD><FONT COLOR=BLACK SIZE=2>Security Question: </FONT><FONT COLOR=BLUE  SIZE=2><B>"+ACCOUNT:USERCHAR1+"</B></FONT></TD>")
 HTMLVIEWLINE("    <TD><FONT COLOR=BLACK SIZE=2>Answer: </FONT><FONT COLOR=BLUE  SIZE=2><B>"+ACCOUNT:USERCHAR2+"</B></FONT></TD>")
 IF UPPERCASE(ACCOUNT:USERCHAR4)="HIGH" THEN
  HTMLVIEWLINE("   <TD><FONT COLOR=BLACK SIZE=2>BSA Risk: </FONT><FONT COLOR=RED  SIZE=2><B>"+ACCOUNT:USERCHAR4+"</B></FONT></TD>")
 ELSE IF UPPERCASE(ACCOUNT:USERCHAR4)="MEDIUM" THEN 
  HTMLVIEWLINE("   <TD><FONT COLOR=BLACK SIZE=2>BSA Risk: </FONT><FONT COLOR=ORANGE  SIZE=2><B>"+ACCOUNT:USERCHAR4+"</B></FONT></TD>")
 ELSE IF UPPERCASE(ACCOUNT:USERCHAR4)="LOW" THEN 
  HTMLVIEWLINE("   <TD><FONT COLOR=BLACK SIZE=2>BSA Risk: </FONT><FONT COLOR=GREEN  SIZE=2><B>"+ACCOUNT:USERCHAR4+"</B></FONT></TD>")
 HTMLVIEWLINE("    <TD><FONT COLOR=BLACK SIZE=2>Last Mobile Banking Login: ")
 IF MOBILESIGNUP=TRUE THEN HTMLVIEWLINE("</FONT><FONT COLOR=GREEN SIZE=2><B>"+FORMAT ("99/99/99",LASTMOBILELOGIN)+"</B></FONT></TD>")
 ELSE HTMLVIEWLINE("</FONT><FONT COLOR=RED SIZE=2><B>Not Registered</B></FONT></TD>")
 HTMLVIEWLINE("    <TD><FONT COLOR=BLACK SIZE=2>eStatements: ")
 IF ACCOUNT:STATEMENTMAILCODE=4 THEN  HTMLVIEWLINE("</FONT><FONT COLOR=GREEN  SIZE=2><B>Yes</B></FONT></TD>")
 ELSE HTMLVIEWLINE("</FONT><FONT COLOR=RED SIZE=2><B>No</B></FONT></TD>")
 HTMLVIEWLINE("</TR>")

 IF PASSWORDCOMMENT<>"" THEN
  DO
   HTMLVIEWLINE("<TR>") 
   HTMLVIEWLINE("   <TD COLSPAN=6><B><FONT SIZE=+3 COLOR=RED>**PASSWORD REQUIRED** </font>")
   HTMLVIEWLINE("   <FONT SIZE=+2 COLOR=PURPLE>"+PASSWORDCOMMENT+" </FONT></b></TD>")
   HTMLVIEWLINE("</TR>")
  END
 HTMLVIEWLINE("</TABLE>")
 FOR EACH NAME WITH (NAME:TYPE=8 OR ((NAME:TYPE=6 OR NAME:TYPE=9) AND (ACCOUNT:TYPE=20 OR  ACCOUNT:TYPE=21 OR ACCOUNT:TYPE=22))) AND 
         (NAME:EFFECTIVEDATE<=SYSTEMDATE AND 
         (NAME:EXPIRATIONDATE='--/--/--' OR NAME:EXPIRATIONDATE>SYSTEMDATE))
  DO
   PO=PO+1
   POANAMES(PO,1)=NAME:SSN
   POANAMES(PO,2)=NAME:LONGNAME
   IF NAME:TYPE=8 THEN POANAMES(PO,3)="P"
   ELSE IF NAME:TYPE=9 THEN POANAMES(PO,3)="A"
   ELSE POANAMES(PO,3)="T"
  END
 CALL MISMATCHJOINT
 [*Check for account sensitivity and user privilege before continueing.]
 IF RESTRICTED=TRUE THEN HTMLVIEWLINE("<CENTER><H1>Account Restricted</H1></CENTER>")
 ELSE
  DO
   [*Display member information about primary and all joints on shares and loans.]
   HTMLVIEWLINE("<TABLE BORDER=0 CELLPADDING=2 CELLSPACING=0 WIDTH=100%>")
   HTMLVIEWLINE("<TR BGCOLOR="+BEACONCOLOR+">")
   HTMLVIEWLINE("    <TH ALIGN=LEFT><FONT SIZE=-1>Member</FONT></TH>")
   HTMLVIEWLINE("    <TH><FONT SIZE=-1>Type</FONT></TH>")
   HTMLVIEWLINE("    <TH><FONT SIZE=2>D/S/P/B/G</FONT></TH>")
   HTMLVIEWLINE("    <TH><FONT SIZE=-1>Birthdate</FONT></TH>")
   HTMLVIEWLINE("    <TH><FONT SIZE=-1>Age</FONT></TH>")
   HTMLVIEWLINE("    <TH><FONT SIZE=-1>SSN/TIN</FONT></TH>")
   HTMLVIEWLINE("    <TH><FONT SIZE=-1>Beacon - Date</FONT></TH>")
   HTMLVIEWLINE("    <TH ALIGN=LEFT><FONT SIZE=-1>Employer</FONT></TH>")
   HTMLVIEWLINE("</TR>")
   FOR I=0 TO 15
    DO
     HDESC(I)=""
     HAMT(I)=""
     HEXP(I)=""
     ADDLINE(I)=""
    END
   HCOUNT=1
   FOR EACH NAME WITH (NAME:EFFECTIVEDATE<=SYSTEMDATE AND (NAME:EXPIRATIONDATE='--/--/--' OR  NAME:EXPIRATIONDATE>SYSTEMDATE))
    DO
     CALL DISPLAYACCTNAMES
     IF NAME:TYPE=0 OR NAME:MAILOVERRIDE=1 THEN CALL GETADDRESSINFO
    END
   ADDCOLUMNS="N"
   FOR OI=1 TO OT                    [CLEAR ALL INFORMATION]
    DO
     OTCOMMENT(OI,1)=""
     OTCOMMENT(OI,2)=""
    END
   OT=0
   FOR EACH SHARE WITH (SHARE:CLOSEDATE='--/--/--' OR ACCOUNT:TYPE=98 OR  ACCOUNT:CLOSEDATE<>'--/--/--')
    DO
     IF SHARE:MATURITYDATE<>'--/--/--' OR SHARE:DIVRATE<>000.000% THEN ADDCOLUMNS="Y"
     CALL DISPLAYSHARENAMES
     IF SHARE:BALANCE-SHARE:MINIMUMBALANCE>SHARE:AVAILABLEBALANCE THEN CALL GETSHAREHOLDS
     FOR EACH SHARE TRANSACTION WITH SHARE TRANSACTION:VOIDCODE=0 AND SHARE TRANSACTION:POSTDATE=SYSTEMDATE AND 
              [SHARE TRANSACTION:BRANCH<>BRNO AND] SHARE TRANSACTION:BRANCH>0 AND 
              (SHARE TRANSACTION:USERNUMBER<800 OR SHARE TRANSACTION:USERNUMBER>999)
      DO
       IF SHARE TRANSACTION:COMMENTCODE=1 AND 
          (CHARACTERSEARCH(SHARE TRANSACTION:COMMENT,"CHECK CASHED")>0 OR 
           CHARACTERSEARCH(SHARE TRANSACTION:COMMENT,"CASHED CK")>0) THEN
        DO
         OT=OT+1
         OTCOMMENT(OT,1)=BRANCHNAME(SHARE TRANSACTION:BRANCH)
         OTCOMMENT(OT,2)=SHARE TRANSACTION:COMMENT
        END
      END
    END
   FOR EACH LOAN WITH LOAN:TYPE<>49 AND (LOAN:CLOSEDATE='--/--/--' OR ACCOUNT:CLOSEDATE<>'--/--/--' OR  (ACCOUNT:TYPE=98 AND LOAN:CHARGEOFFDATE<>'--/--/--'))
    DO
     CALL DISPLAYLOANNAMES
     CALL GETLOANHOLDS                    [OLD - IF LOAN:LOANCODE=3 THEN]
     LOANFOUND=TRUE
    END
   HTMLVIEWLINE("</TABLE>")
   IF ANYWARNING(ACCOUNT,75) THEN HTMLVIEWLINE("<IMG SRC=PrimaryIDAnim.gif><BR>")
   IF ANYWARNING(ACCOUNT,76) THEN HTMLVIEWLINE("<IMG SRC=JointIDAnim.gif><BR>")
   FOR PA=1 TO PO
    DO
     HTMLVIEWLINE("<B><FONT SIZE=+1>"+CAPITALIZE(POANAMES(PA,2))+"</FONT>")
     IF POANAMES(PA,3)="P" THEN HTMLVIEWLINE("<FONT SIZE=+2 COLOR=RED>&nbsp;HAS POWER OF  ATTORNEY&nbsp;</FONT>")
     ELSE IF POANAMES(PA,3)="A" THEN HTMLVIEWLINE("<FONT SIZE=+2 COLOR=RED>&nbsp;IS AN AUTHORIZED  SIGNER&nbsp;</FONT>")
     ELSE HTMLVIEWLINE("<FONT SIZE=+2 COLOR=RED>&nbsp;IS A TRUSTEE&nbsp;</FONT>")
     HTMLVIEWLINE("<FONT SIZE=+1>&nbsp;on all Shares</FONT></B><BR>") 
    END 
   FOR MI=1 TO MO
    DO
     HTMLVIEWLINE("<B><FONT SIZE=+1>"+OUTMISLINE(MI,1)+"</FONT>")
     HTMLVIEWLINE("<FONT SIZE=+2 COLOR=RED>&nbsp;"+OUTMISLINE(MI,2)+"&nbsp;</FONT>")
     HTMLVIEWLINE("on Share(s) <FONT SIZE=+1>&nbsp;")
     IF LENGTH(OUTMISLINE(MI,3))>50 THEN
      DO
       HTMLVIEWLINE(SEGMENT(OUTMISLINE(MI,3),1,50))
       HTMLVIEWLINE(SEGMENT(OUTMISLINE(MI,3),51,LENGTH(OUTMISLINE(MI,3))))
      END
     ELSE HTMLVIEWLINE(OUTMISLINE(MI,3))
     HTMLVIEWLINE("</FONT></B><BR>")
    END
   IF PC>0 THEN
    DO
     HTMLVIEWLINE("<FONT SIZE=+2 COLOR=PURPLE><B>POA Comments: </B></FONT>")
     FOR PI=1 TO PC
      DO
       IF PI>1 THEN
        DO
         HTMLVIEWLINE ("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;")
         HTMLVIEWLINE ("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;")
         HTMLVIEWLINE ("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;")
        END
       HTMLVIEWLINE("<FONT SIZE=+1 COLOR=PURPLE>"+POACOMMENTS(PI)+"</FONT><BR>")
      END
    END
   IF ACNT>0 THEN
    DO
     HTMLVIEWLINE("<TABLE BORDER=0>")
     HTMLVIEWLINE("<TR>")
     HTMLVIEWLINE("    <TD><FONT COLOR=blue SIZE=-1><B>Other base holds: ")
     FIRSTOTHER="Y"
     FOR SN=1 TO SCNT
      DO
       LCNT=0
       PREVSSN=""
       FOR SA=1 TO ACNT
        DO
         LCNT=LCNT+1
         IF ACCTINFO(SA,3)=SSNARRAY(SN,1) THEN 
          DO
           HTMLVIEWLINE("          </TD>")
           IF PREVSSN<>ACCTINFO(SA,3) THEN
            DO
             IF FIRSTOTHER="N" THEN
              DO 
               HTMLVIEWLINE("<TR>")
               HTMLVIEWLINE("<TD></TD>")
              END
             FIRSTOTHER="N"
             HTMLVIEWLINE("     <TD><FONT COLOR=blue SIZE=-1><B>"+CAPITALIZE(ACCTINFO(SA,2))+SP +SP+SP+SP)
             LCNT=1
             PREVSSN=ACCTINFO(SA,3)
            END
           IF LCNT>4 THEN
            DO
             HTMLVIEWLINE("</TR>")
             HTMLVIEWLINE(" <TR>")
             HTMLVIEWLINE("     <TD></TD>")
             HTMLVIEWLINE("     <TD>")
             LCNT=1
            END
           HTMLVIEWLINE("           </B></FONT></TD>")
           HTMLVIEWLINE("       <TD><FONT COLOR=blue SIZE=-1><B>"+ACCTINFO(SA,1)+" - "+FORMAT (MFORMAT,ACCTHOLD(SA))+SP+SP+SP+"</B></FONT></TD>")
          END
        END
      END
     HTMLVIEWLINE("</TABLE>")
    END
   IF CLACNT>0 THEN
    DO
     HTMLVIEWLINE("<TABLE BORDER=0>")
     HTMLVIEWLINE("<TR>")
     HTMLVIEWLINE("    <TD><FONT COLOR=RED SIZE=-1><B>Closed Accounts: "+SP+SP)
     FIRSTOTHER="Y"
     FOR SN=1 TO SCNT
      DO
       LCNT=0
       PREVSSN=""
       FOR SA=1 TO CLACNT
        DO
         LCNT=LCNT+1
         IF CLACCTINFO(SA,3)=SSNARRAY(SN,1) THEN 
          DO
           HTMLVIEWLINE("          </TD>")
           IF PREVSSN<>CLACCTINFO(SA,3) THEN
            DO
             IF FIRSTOTHER="N" THEN
              DO 
               HTMLVIEWLINE("<TR>")
               HTMLVIEWLINE("<TD></TD>")
              END
             FIRSTOTHER="N"
             HTMLVIEWLINE("     <TD><FONT COLOR=RED SIZE=-1><B>"+CAPITALIZE(CLACCTINFO(SA,2))+SP +SP+SP+SP)
             LCNT=1
             PREVSSN=CLACCTINFO(SA,3)
            END
           IF LCNT>4 THEN
            DO
             HTMLVIEWLINE("</TR>")
             HTMLVIEWLINE(" <TR>")
             HTMLVIEWLINE("     <TD></TD>")
             HTMLVIEWLINE("     <TD>")
             LCNT=1
            END
           HTMLVIEWLINE("           </B></FONT></TD>")
           HTMLVIEWLINE("       <TD><FONT COLOR=RED SIZE=-1><B>"+CLACCTINFO(SA,1)+SP+SP+SP+"</B></FONT></TD>")
          END
        END
      END
     HTMLVIEWLINE("</TABLE>")
    END

   CALL GETTODAY

   [CALL READGLENTRY]

   [*Address, Base Hold Amount, and current hold information.]
   HTMLVIEWLINE("<br>")
   HTMLVIEWLINE("<font face=arial>")
   HTMLVIEWLINE("<TABLE BORDER=0 CELLPADDING=2 CELLSPACING=0 WIDTH=100%>")
   HTMLVIEWLINE("<TR BGCOLOR="+BEACONCOLOR+">")
   HTMLVIEWLINE("    <TH ALIGN=LEFT><FONT SIZE=-1>Address</FONT></TH>")
   HTMLVIEWLINE("    <TH><FONT SIZE=-1>Base Hold</FONT></TH>")
   HTMLVIEWLINE("    <TH ALIGN=LEFT><FONT SIZE=-1>Current Holds</FONT></TH>")
   HTMLVIEWLINE("    <TH ALIGN=RIGHT><FONT SIZE=-1>Amount</FONT></TH>")
   HTMLVIEWLINE("    <TH ALIGN=RIGHT><FONT SIZE=-1>Expiration</FONT></TH>")
   HTMLVIEWLINE("</TR>")
   HCOUNT=HCOUNT-1
   IF HCOUNT>ALCOUNT THEN MAX=HCOUNT 
   ELSE MAX=ALCOUNT
   IF (ANYWARNING(ACCOUNT,40) OR ANYWARNING(ACCOUNT,43)) AND MAX<6 THEN MAX=6
   IF ANYWARNING(ACCOUNT,40) AND ANYWARNING(ACCOUNT,43) AND MAX<9 THEN MAX=9
   IF MAX=15 THEN MAX=16
   FOR I=1 TO MAX
    DO
     IF I=1 THEN
      DO
       HTMLVIEWLINE(" <TR>")
       IF ((ACCOUNT:STATEMENTMAILCODE=3 OR ANYWARNING(ACCOUNT,20)) OR ACCOUNT:PAYEELINE:2="") AND  ACCOUNT:CLOSEDATE='--/--/--' THEN 
        HTMLVIEWLINE("    <TD ROWSPAN=3 ALIGN=CENTER><IMG SRC=New_Address.gif></TD>")
       ELSE HTMLVIEWLINE("<TD><FONT SIZE=-1>"+ADDLINE(I)+"</FONT></TD>")
       HTMLVIEWLINE("     <TD ROWSPAN=3 ALIGN=CENTER><FONT COLOR=BLUE SIZE=4><B>"+FORMAT (MFORMAT,ACCOUNT:KRHOLDBASEAMOUNT)+"</B></FONT></TD>")
       IF I<=HCOUNT THEN 
        DO
         HTMLVIEWLINE("   <TD><FONT SIZE=-1>"+HDESC(I)+"</FONT></TD>")
         HTMLVIEWLINE("   <TD ALIGN=RIGHT><FONT SIZE=-1>"+HAMT(I)+"</FONT></TD>")
         HTMLVIEWLINE("   <TD ALIGN=RIGHT><FONT SIZE=-1>"+HEXP(I)+"</FONT></TD>")
        END
        HTMLVIEWLINE("</TR>")
      END
     ELSE IF I<=3 THEN
      DO
       IF ACCOUNT:STATEMENTMAILCODE<>3 AND NOT ANYWARNING(ACCOUNT,20) AND I<=ALCOUNT THEN 
        DO
         HTMLVIEWLINE("<TR>")
         HTMLVIEWLINE("   <TD><FONT SIZE=-1>"+ADDLINE(I)+"</FONT></TD>")
        END
       IF I<=HCOUNT THEN 
        DO
         HTMLVIEWLINE("   <TD><FONT SIZE=-1>"+HDESC(I)+"</FONT></TD>")
         HTMLVIEWLINE("   <TD ALIGN=RIGHT><FONT SIZE=-1>"+HAMT(I)+"</FONT></TD>")
         HTMLVIEWLINE("   <TD ALIGN=RIGHT><FONT SIZE=-1>"+HEXP(I)+"</FONT></TD>")
        END
       HTMLVIEWLINE(" </TR>")
      END
     ELSE IF I=4 THEN
      DO
       HTMLVIEWLINE(" <TR>")
       IF I<=ALCOUNT THEN 
        HTMLVIEWLINE("    <TD><FONT SIZE=-1>"+ADDLINE(I)+"</FONT></TD>") 
       ELSE HTMLVIEWLINE("<TD>"+SP+"</TD>")
       HTMLVIEWLINE("     <TD ROWSPAN=3 ALIGN=CENTER>")
       IF ANYWARNING(ACCOUNT,40) OR ANYWARNING(ACCOUNT,43) THEN
        DO
         IF ANYWARNING(ACCOUNT,40) THEN HTMLVIEWLINE("<IMG SRC=CK_Stolen.gif>") 
         ELSE HTMLVIEWLINE("<IMG SRC=ID_Stolen.gif>")
         HTMLVIEWLINE("        </TD>")
        END
       ELSE HTMLVIEWLINE(SP+"  </TD>")
       IF I<=HCOUNT THEN 
        DO
         HTMLVIEWLINE("   <TD><FONT SIZE=-1>"+HDESC(I)+"</FONT></TD>")
         HTMLVIEWLINE("   <TD ALIGN=RIGHT><FONT SIZE=-1>"+HAMT(I)+"</FONT></TD>")
         HTMLVIEWLINE("   <TD ALIGN=RIGHT><FONT SIZE=-1>"+HEXP(I)+"</FONT></TD>")
        END
        [ELSE HTMLVIEWLINE(OTD+SP+CTD+OTD+SP+CTD+OTD+SP+CTD)]
       HTMLVIEWLINE("</TR>")
      END
     ELSE IF I<=6 THEN
      DO
       HTMLVIEWLINE(" <TR>")
       IF I<=ALCOUNT THEN 
        HTMLVIEWLINE("    <TD><FONT SIZE=-1>"+ADDLINE(I)+"</FONT></TD>") 
       ELSE HTMLVIEWLINE("<TD>"+SP+"</TD>")
       IF I<=HCOUNT THEN 
        DO
         HTMLVIEWLINE("   <TD><FONT SIZE=-1>"+HDESC(I)+"</FONT></TD>")
         HTMLVIEWLINE("   <TD ALIGN=RIGHT><FONT SIZE=-1>"+HAMT(I)+"</FONT></TD>")
         HTMLVIEWLINE("   <TD ALIGN=RIGHT><FONT SIZE=-1>"+HEXP(I)+"</FONT></TD>")
        END
      [ELSE HTMLVIEWLINE(OTD+SP+CTD+OTD+SP+CTD+OTD+SP+CTD+</TR>)]
      HTMLVIEWLINE("  </TR>")
      END
     ELSE IF I=7 THEN
      DO
       HTMLVIEWLINE(" <TR>")
       IF I<=ALCOUNT THEN 
        HTMLVIEWLINE("    <TD><FONT SIZE=-1>"+ADDLINE(I)+"</FONT></TD>") 
       ELSE HTMLVIEWLINE("<TD>"+SP+"</TD>")
       HTMLVIEWLINE("     <TD ROWSPAN=3 ALIGN=CENTER>")
       IF ANYWARNING(ACCOUNT,40) AND ANYWARNING(ACCOUNT,43) 
        THEN HTMLVIEWLINE("   <IMG SRC=ID_Stolen.gif>"+"</TD>") 
       ELSE HTMLVIEWLINE(SP+" </TD>")
       IF I<=HCOUNT THEN 
        DO
         HTMLVIEWLINE("   <TD><FONT SIZE=-1>"+HDESC(I)+"</FONT></TD>")
         HTMLVIEWLINE("   <TD ALIGN=RIGHT><FONT SIZE=-1>"+HAMT(I)+"</FONT></TD>")
         HTMLVIEWLINE("   <TD ALIGN=RIGHT><FONT SIZE=-1>"+HEXP(I)+"</FONT></TD>")
        END
       [ELSE HTMLVIEWLINE(OTD+SP+CTD+OTD+SP+CTD+OTD+SP+CTD+</TR>)] 
       HTMLVIEWLINE(" </TR>")
      END
     ELSE IF I<=9 THEN
      DO
       HTMLVIEWLINE(" <TR>")
       IF I<=ALCOUNT THEN 
        HTMLVIEWLINE("    <TD><FONT SIZE=-1>"+ADDLINE(I)+"</FONT></TD>") 
       ELSE HTMLVIEWLINE("<TD>"+SP+"</TD>")
       IF I<=HCOUNT THEN 
        DO
         HTMLVIEWLINE("   <TD><FONT SIZE=-1>"+HDESC(I)+"</FONT></TD>")
         HTMLVIEWLINE("   <TD ALIGN=RIGHT><FONT SIZE=-1>"+HAMT(I)+"</FONT></TD>")
         HTMLVIEWLINE("   <TD ALIGN=RIGHT><FONT SIZE=-1>"+HEXP(I)+"</FONT></TD>")
        END
       [ELSE HTMLVIEWLINE(OTD+SP+CTD+OTD+SP+CTD+OTD+SP+CTD+</TR>)]
       HTMLVIEWLINE(" </TR>")
      END
     ELSE IF I<=15 THEN
      DO
       HTMLVIEWLINE(" <TR>")
       IF I<=ALCOUNT THEN 
        HTMLVIEWLINE("    <TD><FONT SIZE=-1>"+ADDLINE(I)+"</FONT></TD>") 
       ELSE HTMLVIEWLINE("<TD>"+SP+"</TD>")
       HTMLVIEWLINE("     <TD>"+SP+"</TD>")
       IF I<=HCOUNT THEN 
        DO
         HTMLVIEWLINE("   <TD><FONT SIZE=-1>"+HDESC(I)+"</FONT></TD>")
         HTMLVIEWLINE("   <TD ALIGN=RIGHT><FONT SIZE=-1>"+HAMT(I)+"</FONT></TD>")
         HTMLVIEWLINE("   <TD ALIGN=RIGHT><FONT SIZE=-1>"+HEXP(I)+"</FONT></TD>")
        END
       [ELSE HTMLVIEWLINE("<TD>"+SP+"</TD><TD>"+SP+"</TD><TD>"+SP+"</TD></TR>")]
       HTMLVIEWLINE("</TR>")
      END
     ELSE 
      DO
       HTMLVIEWLINE("<TR>")
       HTMLVIEWLINE("    <TD>"+SP+"</TD>")
       HTMLVIEWLINE("    <TD>"+SP+"</TD>")
       HTMLVIEWLINE("    <TD><FONT SIZE=-1>"+HDESC(0)+"</FONT></TD>")
       HTMLVIEWLINE("    <TD>"+SP+"</TD>")
       HTMLVIEWLINE("    <TD>"+SP+"</TD>")
       HTMLVIEWLINE("</TR>")
      END
    END
   HTMLVIEWLINE("</TABLE>")
   [Loan listing]
   IF LOANFOUND=TRUE THEN
    DO
     HTMLVIEWLINE("<br")
     HTMLVIEWLINE("<font face=arial>")
     HTMLVIEWLINE("<TABLE BORDER=0 CELLPADDING=2 CELLSPACING=0 WIDTH=100%>")
     HTMLVIEWLINE("<TR BGCOLOR="+BEACONCOLOR+">")
     HTMLVIEWLINE("   <TH ALIGN=LEFT><FONT SIZE=-1>Loan Description</FONT></TH>")
     HTMLVIEWLINE("   <TH><FONT SIZE=-1>Open Date</FONT></TH>")
     HTMLVIEWLINE("   <TH><FONT SIZE=-1>Due Date</FONT></TH>")
     HTMLVIEWLINE("   <TH ALIGN=RIGHT><FONT SIZE=-1>Rate</FONT></TH>")
     HTMLVIEWLINE("   <TH ALIGN=RIGHT><FONT SIZE=-1>Delinquent</FONT></TH>")
     HTMLVIEWLINE("   <TH ALIGN=RIGHT><FONT SIZE=-1>Payment</FONT></TH>")
     HTMLVIEWLINE("   <TH ALIGN=RIGHT><FONT SIZE=-1>Available</FONT></TH>")
     HTMLVIEWLINE("   <TH ALIGN=RIGHT><FONT SIZE=-1>Balance</FONT></TH>")
     HTMLVIEWLINE("</TR>")
    
     FOR EACH TRACKING WITH TRACKING:TYPE=0 AND TRACKING:EXPIREDATE='--/--/--'
      DO
       IF SEGMENT(UPPERCASE(TRACKING:USERCHAR2),1,2)="CU" OR 
          TRACKING:USERCHAR2="1827" THEN MC=2                         [COLOR - PURPLE/BOLD - MORTGAGE IS IN  PORTFOLIO]
       ELSE MC=1                                                      [COLOR - BLACK MORTGAGE - IS NOT IN  PORTFOLIO]
       [FOR MS=1 TO 16 [2/4/14 CHANGED TO ANY STARTING WITH CU PER TONY]
        DO
         IF TRACKING:USERCHAR2=MORTGAGETYPES(MS) THEN MC=2  [COLOR - PURPLE/BOLD - MORTGAGE IS IN  PORTFOLIO]
        END ]
       HTMLVIEWLINE(" <TR>")
       HTMLVIEWLINE("     <TD>"+MCOLOR(MC)+SP+SP+SP+SP+SP+SP+SP)
       IF MC=2 THEN             HTMLVIEWLINE("Portfolio ")
       ELSE                     HTMLVIEWLINE("Non-Portfolio ")
       HTMLVIEWLINE("#"+TRACKING:USERCHAR1)
       MASOF=CHARACTERSEARCH(TRACKING:USERCHAR3,"as of")
       HTMLVIEWLINE(            CAPITALIZE(SEGMENT(TRACKING:USERCHAR3,1,MASOF+5)))
       HTMLVIEWLINE(            SP+SEGMENT(TRACKING:USERCHAR3,MASOF+6,LENGTH (TRACKING:USERCHAR3))+MCEND(MC)+"</TD>")
       HTMLVIEWLINE("     <TD ALIGN=CENTER>"+MCOLOR(MC)+FORMAT(DFORMAT,TRACKING:USERDATE6)+MCEND (MC)+"</TD>")
       IF TRACKING:USERDATE2<>'--/--/--' THEN 
        HTMLVIEWLINE("    <TD ALIGN=CENTER>"+MCOLOR(MC)+FORMAT(DFORMAT,TRACKING:USERDATE2)+MCEND (MC)+"</TD>")
       ELSE HTMLVIEWLINE("<TD ALIGN=CENTER>"+MCOLOR(MC)+"--/--/--</FONT></TD>")
       HTMLVIEWLINE("     <TD ALIGN=RIGHT>"+MCOLOR(MC)+FORMAT(RFORMAT,TRACKING:USERRATE1)+MCEND (MC)+"</TD>")
       HTMLVIEWLINE("     <TD>"+SP+"</TD>") 
       HTMLVIEWLINE("     <TD ALIGN=RIGHT>"+MCOLOR(MC)+FORMAT (MFORMAT,TRACKING:USERAMOUNT3)+MCEND(MC)+"</TD>")
       HTMLVIEWLINE("     <TD>"+SP+"</TD>")
       HTMLVIEWLINE("     <TD ALIGN=RIGHT>"+MCOLOR(MC)+FORMAT (MFORMAT,TRACKING:USERAMOUNT1)+MCEND(MC)+"</TD>")
       HTMLVIEWLINE("</TR>")
      END
     FOR EACH LOAN WITH LOAN:TYPE<>49 AND (LOAN:CLOSEDATE='--/--/--' OR ACCOUNT:CLOSEDATE<>'--/--/--' OR  (ACCOUNT:TYPE=98 AND LOAN:CHARGEOFFDATE<>'--/--/--'))
      DO
       HTMLVIEWLINE(" <TR>")
       IF LOAN:CHARGEOFFDATE<>'--/--/--' OR ACCOUNT:CLOSEDATE<>'--/--/--' THEN HTMLVIEWLINE ("<TD><FONT COLOR=RED SIZE=-1>")
       ELSE HTMLVIEWLINE("<TD><FONT SIZE=-1>")
       HTMLVIEWLINE("        <B>"+LOAN:ID+"</B>"+SP+SP+CAPITALIZE(LOAN:DESCRIPTION))
       IF LOAN:CLOSEDATE<>'--/--/--' THEN HTMLVIEWLINE("-CLOSED- "+SP+SP+SP+SP+SP+SP+FORMAT ("99/99/99",LOAN:CLOSEDATE))
       HTMLVIEWLINE("          </FONT>")
       IF LOAN:TYPE=40 OR LOAN:TYPE=41 THEN 
        DO
         LASTBAL=LOAN:CASHADVNEWBALANCE:1+LOAN:PURCHNEWBALANCE:1+LOAN:BALXFRNEWBALANCE:1 
         LASTBAL=LASTBAL+LOAN:CANEWINTUNPAID+LOAN:PUNEWINTUNPAID+LOAN:BTNEWINTUNPAID+LOAN:FEENEWBALANCE
         LASTBAL=LASTBAL+LOAN:CASHADVOLDBALANCE:2+LOAN:PURCHNEWBALANCE:2+LOAN:BALXFRNEWBALANCE:2
         LASTBAL=LASTBAL+LOAN:CASHADVOLDBALANCE:3+LOAN:PURCHNEWBALANCE:3+LOAN:BALXFRNEWBALANCE:3
         LASTBAL=LASTBAL+LOAN:CASHADVOLDBALANCE:4+LOAN:PURCHNEWBALANCE:4+LOAN:BALXFRNEWBALANCE:4
         LASTBAL=LASTBAL+LOAN:CASHADVOLDBALANCE:5+LOAN:PURCHNEWBALANCE:5+LOAN:BALXFRNEWBALANCE:5
         LASTBAL=LASTBAL+LOAN:CASHADVOLDBALANCE:6+LOAN:PURCHNEWBALANCE:6+LOAN:BALXFRNEWBALANCE:6
         LASTBAL=LASTBAL+LOAN:CASHADVOLDBALANCE:7+LOAN:PURCHNEWBALANCE:7+LOAN:BALXFRNEWBALANCE:7
         LASTBAL=LASTBAL+LOAN:CASHADVOLDBALANCE:8+LOAN:PURCHNEWBALANCE:8+LOAN:BALXFRNEWBALANCE:8
         LASTBAL=LASTBAL+LOAN:CASHADVOLDBALANCE:9+LOAN:PURCHNEWBALANCE:9+LOAN:BALXFRNEWBALANCE:9
         HTMLVIEWLINE("<BR><FONT SIZE=-1><I>"+SP+SP+SP+SP+SP+SP+"Last statement balance: "+FORMAT(MFORMAT,LASTBAL)+"</I></FONT>")      
        END
       HTMLVIEWLINE("     </TD>")

       IF LOAN:CHARGEOFFDATE<>'--/--/--' OR ACCOUNT:CLOSEDATE<>'--/--/--' THEN HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=CENTER><FONT COLOR=RED SIZE=-1>")
       ELSE HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=CENTER><FONT SIZE=-1>"+FORMAT(DFORMAT,LOAN:OPENDATE)+"</FONT></TD>")

       IF LOAN:CHARGEOFFDATE<>'--/--/--' OR ACCOUNT:CLOSEDATE<>'--/--/--' THEN HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=CENTER><FONT COLOR=RED SIZE=-1>")
       ELSE HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=CENTER><FONT SIZE=-1>")
       IF LOAN:DUEDATE<>'--/--/--' THEN HTMLVIEWLINE(" "+FORMAT (DFORMAT,LOAN:DUEDATE)+"</FONT></TD>")
       ELSE HTMLVIEWLINE("    "+"--/--/--"+"</FONT></TD>")

       IF LOAN:CHARGEOFFDATE<>'--/--/--' OR ACCOUNT:CLOSEDATE<>'--/--/--' THEN HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=RIGHT><FONT COLOR=RED SIZE=-1>")
       ELSE HTMLVIEWLINE("  <TD VALIGN=TOP ALIGN=RIGHT><FONT SIZE=-1>")
       HTMLVIEWLINE("         "+FORMAT(RFORMAT,LOAN:INTERESTRATE)+"</FONT></TD>")

       IF LOAN:PASTDUEAMOUNT=$0.00 THEN HTMLVIEWLINE("    <TD>"+SP+"</TD>") 
       ELSE 
        DO
         HTMLVIEWLINE ("<TD VALIGN=TOP ALIGN=RIGHT><FONT COLOR=RED SIZE=-1>")
         HTMLVIEWLINE("         "+FORMAT(MFORMAT,LOAN:PASTDUEAMOUNT)+"</FONT></TD>")
         TOTLNDELS=TOTLNDELS+LOAN:PASTDUEAMOUNT
        END

       IF LOAN:CHARGEOFFDATE<>'--/--/--' OR ACCOUNT:CLOSEDATE<>'--/--/--' THEN HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=RIGHT><FONT COLOR=RED SIZE=-1>")
       ELSE HTMLVIEWLINE("  <TD VALIGN=TOP ALIGN=RIGHT><FONT SIZE=-1>")
       IF LOAN:PMTBUCKETDUEDATE:2>SYSTEMDATE AND LOAN:PMTBUCKETAMOUNT:2>$0.00 THEN 
        DO
         HTMLVIEWLINE("          "+FORMAT(MFORMAT,LOAN:PMTBUCKETAMOUNT:2)+"</FONT></TD>")
         TOTLNPMTS=TOTLNPMTS+LOAN:PMTBUCKETAMOUNT:2
        END
       ELSE IF LOAN:PAYMENTDUE>LOAN:PAYMENT THEN 
        DO
         HTMLVIEWLINE("         "+FORMAT(MFORMAT, (LOAN:PAYMENTDUE-LOAN:PASTDUEAMOUNT))+"</FONT></TD>")
         TOTLNPMTS=TOTLNPMTS+LOAN:PAYMENTDUE-LOAN:PASTDUEAMOUNT
        END
       ELSE 
        DO
         HTMLVIEWLINE("         "+FORMAT(MFORMAT,LOAN:PAYMENT)+"</FONT></TD>")
         TOTLNPMTS=TOTLNPMTS+LOAN:PAYMENT
        END
       IF LOAN:PASTDUEAMOUNT=$0.00 AND (LOAN:LOANCODE>1 OR (LOAN:LOANCODE=1 AND  LOAN:CREDITLIMIT>$0.00)) THEN 
        DO
         IF LOAN:CHARGEOFFDATE<>'--/--/--' OR ACCOUNT:CLOSEDATE<>'--/--/--' THEN HTMLVIEWLINE ("<TD VALIGN=TOP ALIGN=RIGHT><FONT COLOR=RED SIZE=-1>")
         ELSE HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=RIGHT><FONT SIZE=-1>")
         HTMLVIEWLINE("         "+FORMAT(MFORMAT,LOAN:AVAILABLECREDIT)+"</FONT></TD>")
        END
       ELSE HTMLVIEWLINE("  <TD>"+SP+"</TD>")

       IF LOAN:CHARGEOFFDATE<>'--/--/--' OR ACCOUNT:CLOSEDATE<>'--/--/--' THEN HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=RIGHT><FONT COLOR=RED SIZE=-1>")
       ELSE HTMLVIEWLINE("  <TD VALIGN=TOP ALIGN=RIGHT><FONT SIZE=-1>")
       TOTLNBALS=TOTLNBALS+LOAN:BALANCE
       IF (LOAN:TYPE>=40 AND LOAN:TYPE<=49) THEN 
        DO
         HTMLVIEWLINE("         "+FORMAT (MFORMAT,LOAN:BALANCE+LOAN:INTERESTDUE)+"</FONT></TD>")
         TOTLNBALS=TOTLNBALS+LOAN:INTERESTDUE
        END
       ELSE HTMLVIEWLINE("         "+FORMAT(MFORMAT,LOAN:BALANCE)+"</FONT></TD>")

       HTMLVIEWLINE("</TR>")
       TOTHOLD=$0.00
       FOR LPC=1 TO LP
        DO
         LOANPLEDGES(LP)=""
        END
       LP=0
       FOR EACH LOAN PLEDGE WITH (LOAN PLEDGE:EXPIRATIONDATE='--/--/--' OR LOAN  PLEDGE:EXPIRATIONDATE>SYSTEMDATE)
        DO
         LNID=LOAN:ID
         CALL GETPLEDGEAMT
        END
       IF TOTHOLD>$0.00 THEN
        DO
         FOR LPC=1 TO LP
          DO
           HTMLVIEWLINE("<TR>")
           IF LPC=1 THEN HTMLVIEWLINE("   <TD colspan=8><FONT COLOR=RED SIZE=-1><B><I>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pledged funds:")
           ELSE 
             DO
              HTMLVIEWLINE("<TD colspan=5><FONT COLOR=RED SIZE=- 1><B><I>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;")
              HTMLVIEWLINE("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp ;&nbsp;&nbsp;&nbsp;")
             END
           HTMLVIEWLINE("      "+LOANPLEDGES(LPC)+"</B></I></TD>")
           HTMLVIEWLINE("</TR>")
          END
        END
       IF ANYWARNING(LOAN,4) THEN
        DO
         HTMLVIEWLINE(" <TR>")
         HTMLVIEWLINE("    <TD COLSPAN=8><FONT COLOR=RED SIZE=+1><B>Loan is in collections.  You  must call 7105 before making a payment.</B></FONT></TD>")
         HTMLVIEWLINE(" </TR>")
        END
      END
     HTMLVIEWLINE(" <TR>")
     HTMLVIEWLINE("     <TD COLSPAN=8><HR SIZE=1></TD>")
     HTMLVIEWLINE("<TR>")

     HTMLVIEWLINE(" <TR>")
     HTMLVIEWLINE("     <TD>"+SP+"</TD>")
     HTMLVIEWLINE("     <TD>"+SP+"</TD>")
     HTMLVIEWLINE("     <TD>"+SP+"</TD>")
     HTMLVIEWLINE("     <TD VALIGN=TOP ALIGN=RIGHT><FONT SIZE=2><B>TOTALS:</B></FONT></TD>")
     IF TOTLNDELS=$0.00 THEN HTMLVIEWLINE("    <TD>"+SP+"</TD>") 
     ELSE HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=RIGHT><FONT SIZE=2 COLOR=RED><B>"+FORMAT(MFORMAT,TOTLNDELS)+"</B></FONT></TD>")
     HTMLVIEWLINE("     <TD VALIGN=TOP ALIGN=RIGHT><FONT SIZE=2><B>"+FORMAT(MFORMAT,TOTLNPMTS)+"</B></FONT></TD>")
     HTMLVIEWLINE("     <TD>"+SP+"</TD>")
     HTMLVIEWLINE("     <TD VALIGN=TOP ALIGN=RIGHT><FONT SIZE=2><B>"+FORMAT(MFORMAT,TOTLNBALS)+"</B></FONT></TD>")
     HTMLVIEWLINE(" </TR>")
     HTMLVIEWLINE("</TABLE>")
    END
   [*Share listing including average deposits, average balance, and NSF/Courtesy pay history.]
   HTMLVIEWLINE("<br>")
   HTMLVIEWLINE("<font face=arial>")
   HTMLVIEWLINE("<TABLE BORDER=0 CELLPADDING=2 CELLSPACING=0 WIDTH=100%>")
   HTMLVIEWLINE("<TR BGCOLOR="+BEACONCOLOR+">")
   HTMLVIEWLINE("    <TH ALIGN=LEFT VALIGN=BOTTOM><FONT SIZE=-1>Share Description</FONT></TH>")
   HTMLVIEWLINE("    <TH ALIGN=CENTER VALIGN=BOTTOM><FONT SIZE=-1>NSF's<BR>Mo/Yr/LstYr</FONT></TH>")
   HTMLVIEWLINE("    <TH ALIGN=CENTER VALIGN=BOTTOM><FONT SIZE=-1>Reg D</FONT></TH>")
   HTMLVIEWLINE("    <TH ALIGN=CENTER VALIGN=BOTTOM><FONT SIZE=-1>Open<BR>Date</FONT></TH>")
   ACSPAN=10
   IF ADDCOLUMNS="Y" THEN
    DO
     ACSPAN=8
     HTMLVIEWLINE("    <TH ALIGN=CENTER VALIGN=BOTTOM><FONT SIZE=-1>Maturity<BR>Date</FONT></TH>")
     HTMLVIEWLINE("    <TH ALIGN=RIGHT VALIGN=BOTTOM><FONT SIZE=-1>Rate</FONT></TH>")
    END
   HTMLVIEWLINE("    <TH ALIGN=RIGHT VALIGN=BOTTOM><FONT SIZE=-1>12mo<BR>Avg Dep</FONT></TH>")
   HTMLVIEWLINE("    <TH ALIGN=RIGHT VALIGN=BOTTOM><FONT SIZE=-1>365<BR>Avg Bal</FONT></TH>")
   HTMLVIEWLINE("    <TH ALIGN=RIGHT VALIGN=BOTTOM><FONT SIZE=-1>Available</FONT></TH>")
   HTMLVIEWLINE("    <TH ALIGN=RIGHT VALIGN=BOTTOM><FONT SIZE=-1>Balance</FONT></TH>")
   HTMLVIEWLINE("</TR>")
   MAX=0
   TOTBALANCE=$0.00
   TOTAVGDEPS=$0.00
   TOTSHAREAVGBAL=$0.00
   TOTAVAILBALANCE=$0.00
   FOR EACH SHARE WITH (SHARE:CLOSEDATE='--/--/--' OR ANYWARNING(ACCOUNT,56) OR 
                        ACCOUNT:TYPE=98 OR ACCOUNT:CLOSEDATE<>'--/--/--') OR
                       (SHARE:TYPE>=80 AND SHARE:TYPE<=89)                        [08/03/09  Include all open or closed chacking accounts]

    DO
     CALL CALCAVERAGES
     IF SHARE:CLOSEDATE='--/--/--' THEN
      DO
       TOTBALANCE=TOTBALANCE+SHARE:BALANCE
       TOTAVAILBALANCE=TOTAVAILBALANCE+SHARE:AVAILABLEBALANCE
      END
     HTMLVIEWLINE("   <TR>")
     IF SHARE:SHARECODE=2 AND (SHARE:MATURITYDATE=SYSTEMDATE OR  (SHARE:OPENDATE<>SHARE:ORIGINALDEPOSITDATE AND
                               SYSTEMDATE>=SHARE:OPENDATE AND SYSTEMDATE<=SHARE:OPENDATE+15))  THEN GRACEPERIOD="Y"
     ELSE GRACEPERIOD="N"
     IF SHARE:CLOSEDATE<>'--/--/--' OR SHARE:CHARGEOFFDATE<>'--/--/--' THEN HTMLVIEWLINE ("<TD VALIGN=TOP><FONT COLOR=RED SIZE=-1>")
     ELSE IF GRACEPERIOD="Y" THEN HTMLVIEWLINE("<TD VALIGN=TOP><FONT COLOR=MAROON SIZE=-1>")
     ELSE HTMLVIEWLINE("   <TD VALIGN=TOP><FONT SIZE=-1>")
     HTMLVIEWLINE("           <B>"+SHARE:ID+"</B>"+SP+SP+CAPITALIZE(SHARE:DESCRIPTION))
     IF SHARE:TYPE>=80 AND SHARE:TYPE<=89 AND SHARE:CLOSEDATE='--/--/--' THEN
      DO
       OPTINSTATUS=""
       IF SHARE:AUTHFEEOPTION:1=7 THEN OPTINSTATUS="<font color=RED><i>Currently Opted  Out<i></font>"
       ELSE OPTINSTATUS="<font color=GREEN><i>Currently Opted In<i></font>"
       
       FOR EACH SHARE TRACKING WITH SHARE TRACKING:TYPE=80
        DO
         OPTINSTATUS=OPTINSTATUS+" - By member request"
        END
       IF CHARACTERSEARCH(OPTINSTATUS,"By member request")=0 THEN OPTINSTATUS=OPTINSTATUS+" -  Changed due to regulation"
       ELSE IF SHARE:TYPE>=80 AND SHARE:TYPE<=89 AND SHARE:CLOSEDATE='--/--/--' THEN
        DO
         [IF (ACCOUNT:TYPE<10 OR ACCOUNT:TYPE=21 OR ACCOUNT:TYPE=22) THEN
          DO]
           IF FOUNDCARD<>"Y" THEN OPTINSTATUS="<font color=NAVY><i>No ATM/Debit - not eligible for Opt- In</i></font>"
         [ END
         ELSE OPTINSTATUS="<font color=#CC5500><i>Account not eligible to Opt-Out</i></font>"]
        END    
       HTMLVIEWLINE("<BR>"+SP+SP+SP+SP+SP+OPTINSTATUS) 
      END
     IF SHARE:CHARGEOFFDATE<>'--/--/--' THEN HTMLVIEWLINE("-CHGOFF-"+FORMAT ("##/##/##",SHARE:CLOSEDATE))
     ELSE IF SHARE:CLOSEDATE<>'--/--/--' THEN HTMLVIEWLINE("-CLOSED-"+FORMAT ("##/##/##",SHARE:CLOSEDATE))
     IF SHARE:TYPE=80 THEN
      DO
       IF SHARE:CLOSEDATE<>'--/--/--' THEN 
        HTMLVIEWLINE("     <BR><I>"+SP+SP+SP+SP+SP+"OLD OD Privilege "+FORMAT (MFORMAT,SHARE:OVERDRAFTTOLERANCE)+"</I>")
       ELSE HTMLVIEWLINE(" <BR><I>"+SP+SP+SP+SP+SP+"OD Privilege "+FORMAT (MFORMAT,SHARE:OVERDRAFTTOLERANCE)+"</I>")
      END
     HTMLVIEWLINE("        </FONT></TD>")
     IF SHARE:NSFMONTHTODATE+SHARE:NSFYTD+SHARE:NSFLASTYEAR>0 OR SHARE:SHARECODE=1 OR  SHARE:OVERDRAFTTOLERANCE<>$0.00 OR
        SHARE:COURTESYPAYMONTHTODATE+SHARE:COURTESYPAYYTD+SHARE:COURTESYPAYLASTYEAR>0 THEN
      DO
       IF SHARE:CLOSEDATE<>'--/--/--' OR SHARE:CHARGEOFFDATE<>'--/--/--' THEN HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=CENTER><FONT COLOR=RED SIZE=-1>")
       ELSE IF GRACEPERIOD="Y" THEN HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=CENTER><FONT COLOR=MAROON SIZE=-1>")
       ELSE HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=CENTER><FONT SIZE=-1>")
       HTMLVIEWLINE("NSFs: "+FORMAT("###9",SHARE:NSFMONTHTODATE)+SP+"/"+FORMAT ("###9",SHARE:NSFYTD)+SP+"/")
       HTMLVIEWLINE(FORMAT("###9",SHARE:NSFLASTYEAR))
       IF SHARE:OVERDRAFTTOLERANCE<>$0.00 OR 
        SHARE:COURTESYPAYMONTHTODATE+SHARE:COURTESYPAYYTD+SHARE:COURTESYPAYLASTYEAR>0 THEN
        DO
         HTMLVIEWLINE("<BR>ODPs: "+FORMAT("###9",SHARE:COURTESYPAYMONTHTODATE)+SP+"/")
         HTMLVIEWLINE(FORMAT("###9",SHARE:COURTESYPAYYTD)+SP+"/"+FORMAT ("###9",SHARE:COURTESYPAYLASTYEAR))
        END
       HTMLVIEWLINE("         </FONT></TD>")
      END
     ELSE HTMLVIEWLINE("  <TD>"+SP+"</TD>")
     HTMLVIEWLINE(" <TD VALIGN=TOP><CENTER><FONT SIZE=-1>"+FORMAT("#",SHARE:REGDTRANSFERCOUNT+SHARE:REGDCHECKCOUNT)+"</FONT></CENTER></TD>")
     IF SHARE:CLOSEDATE<>'--/--/--' OR SHARE:CHARGEOFFDATE<>'--/--/--' THEN HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=CENTER><FONT COLOR=RED SIZE=-1>")
     ELSE IF GRACEPERIOD="Y" THEN HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=CENTER><FONT COLOR=MAROON SIZE=-1>")
     ELSE HTMLVIEWLINE("  <TD VALIGN=TOP ALIGN=CENTER><FONT SIZE=-1>")
     HTMLVIEWLINE(FORMAT(DFORMAT,SHARE:OPENDATE)+"</FONT></TD>")

     IF ADDCOLUMNS="Y" THEN
      DO
       IF SHARE:CLOSEDATE<>'--/--/--' OR SHARE:CHARGEOFFDATE<>'--/--/--' THEN HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=CENTER><FONT COLOR=RED SIZE=-1>")
       ELSE IF GRACEPERIOD="Y" THEN HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=CENTER><FONT COLOR=MAROON SIZE=-1>")
       ELSE HTMLVIEWLINE("  <TD VALIGN=TOP ALIGN=CENTER><FONT SIZE=-1>")
       IF SHARE:MATURITYDATE<>'--/--/--' THEN HTMLVIEWLINE(FORMAT(DFORMAT,SHARE:MATURITYDATE))
       ELSE HTMLVIEWLINE("&nbsp")
       HTMLVIEWLINE("</FONT></TD>")

       IF SHARE:CLOSEDATE<>'--/--/--' OR SHARE:CHARGEOFFDATE<>'--/--/--' THEN HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=RIGHT><FONT COLOR=RED SIZE=-1>")
       ELSE IF GRACEPERIOD="Y" THEN HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=RIGHT><FONT COLOR=MAROON SIZE=-1>")
       ELSE HTMLVIEWLINE("  <TD VALIGN=TOP ALIGN=RIGHT><FONT SIZE=-1>")
       IF SHARE:DIVRATE>000.000% THEN HTMLVIEWLINE(FORMAT(RFORMAT,SHARE:DIVRATE))
       ELSE HTMLVIEWLINE("&nbsp")
       HTMLVIEWLINE("</FONT></TD>")
      END

     IF SHARE:CLOSEDATE<>'--/--/--' OR SHARE:CHARGEOFFDATE<>'--/--/--' THEN HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=RIGHT><FONT COLOR=RED SIZE=-1>")
     ELSE IF GRACEPERIOD="Y" THEN HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=RIGHT><FONT COLOR=MAROON SIZE=-1>")
     ELSE HTMLVIEWLINE("  <TD VALIGN=TOP ALIGN=RIGHT><FONT SIZE=-1>")
     HTMLVIEWLINE(FORMAT(MFORMAT,AVGDEPS)+"</FONT></TD>")

     IF SHARE:CLOSEDATE<>'--/--/--' OR SHARE:CHARGEOFFDATE<>'--/--/--' THEN HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=RIGHT><FONT COLOR=RED SIZE=-1>")
     ELSE IF GRACEPERIOD="Y" THEN HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=RIGHT><FONT COLOR=MAROON SIZE=-1>")
     ELSE HTMLVIEWLINE("  <TD VALIGN=TOP ALIGN=RIGHT><FONT SIZE=-1>")
     IF SHAREAVGDAILYBAL>=$0.00 THEN HTMLVIEWLINE(FORMAT (MFORMAT,SHAREAVGDAILYBAL))
     ELSE HTMLVIEWLINE(CNEG+FORMAT(MFORMAT,SHAREAVGDAILYBAL)+ECNEG)
     HTMLVIEWLINE("</FONT></TD>")

     IF SHARE:CLOSEDATE<>'--/--/--' OR SHARE:CHARGEOFFDATE<>'--/--/--' THEN HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=RIGHT><FONT COLOR=RED SIZE=-1>")
     ELSE IF GRACEPERIOD="Y" THEN HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=RIGHT><FONT COLOR=MAROON SIZE=-1>")
     ELSE HTMLVIEWLINE("  <TD VALIGN=TOP ALIGN=RIGHT><FONT SIZE=-1>")
     IF SHARE:AVAILABLEBALANCE>=$0.00 THEN HTMLVIEWLINE(FORMAT (MFORMAT,SHARE:AVAILABLEBALANCE))
     ELSE HTMLVIEWLINE(CNEG+FORMAT(MFORMAT,SHARE:AVAILABLEBALANCE)+ECNEG)
     HTMLVIEWLINE("</FONT></TD>")

     IF SHARE:CLOSEDATE<>'--/--/--' OR SHARE:CHARGEOFFDATE<>'--/--/--' THEN HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=RIGHT><FONT COLOR=RED SIZE=-1>")
     ELSE IF GRACEPERIOD="Y" THEN HTMLVIEWLINE("<TD VALIGN=TOP ALIGN=RIGHT><FONT COLOR=MAROON SIZE=-1>")
     ELSE HTMLVIEWLINE("  <TD VALIGN=TOP ALIGN=RIGHT><FONT SIZE=-1>")
     IF SHARE:BALANCE>$0.00 THEN HTMLVIEWLINE(FORMAT(MFORMAT,SHARE:BALANCE)+"</FONT></TD>")
     ELSE IF SHARE:BALANCE=$0.00 THEN 
      DO
       IF SHARE:CHARGEOFFAMOUNT<>$0.00 THEN HTMLVIEWLINE(FORMAT(MFORMAT,SHARE:CHARGEOFFAMOUNT*- 1)+"</FONT></TD>")
       ELSE HTMLVIEWLINE(     FORMAT(MFORMAT,SHARE:BALANCE)+"</FONT></TD>")
      END
     ELSE HTMLVIEWLINE(       CNEG+FORMAT(MFORMAT,SHARE:BALANCE)+ECNEG+"</FONT></TD>")

     HTMLVIEWLINE("</TR>")
     FOR EACH SHARE HOLD WITH SHARE HOLD:TYPE=5 AND (SHARE HOLD:EXPIRATIONDATE='--/--/--' OR
              SHARE HOLD:EXPIRATIONDATE>SYSTEMDATE OR (SHARE HOLD:EXPIRATIONDATE=SYSACTUALDATE  AND
              SHARE HOLD:EXPIRATIONTIME>SYSACTUALTIME)) AND SHARE HOLD:AMOUNT<>$0.00
      DO
       HTMLVIEWLINE("<TR>")
       HTMLVIEWLINE("   <TD colspan=8><FONT COLOR=RED SIZE=-1><B><I>"+SP+SP+SP+SP+SP+" $"+FORMAT("###,##9.99",SHARE HOLD:AMOUNT))
       HTMLVIEWLINE(        "&nbsp;&nbsp;funds pledged for &nbsp;Loan "+SHARE  HOLD:REFERENCE2+"&nbsp;&nbsp;on Account:&nbsp;&nbsp;"+SHARE HOLD:REFERENCE1+"</B></I></TD>")
       HTMLVIEWLINE("</TR>")
      END
    END
   HTMLVIEWLINE(" <TR>")
   HTMLVIEWLINE("     <TD COLSPAN=10><HR SIZE=1></TD>")
   HTMLVIEWLINE("</TR>")
   HTMLVIEWLINE(" <TR>")
   HTMLVIEWLINE("     <TD>"+SP+"</TD>")
   HTMLVIEWLINE("     <TD>"+SP+"</TD>")
   HTMLVIEWLINE("     <TD>"+SP+"</TD>")
   IF ADDCOLUMNS="Y" THEN
    DO
     HTMLVIEWLINE("     <TD>"+SP+"</TD>")
     HTMLVIEWLINE("     <TD>"+SP+"</TD>")
    END
   HTMLVIEWLINE("     <TD><FONT SIZE=2><B>TOTALS:</B></FONT></TD>")
   HTMLVIEWLINE("     <TH ALIGN=RIGHT><FONT SIZE=-1>"+FORMAT(MFORMAT,TOTAVGDEPS)+"</FONT></TH>")
   IF TOTSHAREAVGBAL>=$0.00 THEN 
    HTMLVIEWLINE("    <TH ALIGN=RIGHT><FONT SIZE=-1>"+FORMAT (MFORMAT,TOTSHAREAVGBAL)+"</FONT></TH>")
   ELSE HTMLVIEWLINE("<TH ALIGN=RIGHT><FONT SIZE=-1>"+CNEG+FORMAT(MFORMAT,TOTSHAREAVGBAL)+ECNEG +"</FONT></TH>")
   IF TOTAVAILBALANCE>=$0.00 THEN 
    HTMLVIEWLINE("    <TH ALIGN=RIGHT><FONT SIZE=-1>"+FORMAT (MFORMAT,TOTAVAILBALANCE)+"</FONT></TH>")
   ELSE HTMLVIEWLINE("<TH ALIGN=RIGHT><FONT SIZE=-1>"+CNEG+FORMAT(MFORMAT,TOTAVAILBALANCE)+ECNEG +"</FONT></TH>")
   IF TOTBALANCE>=$0.00 THEN 
    HTMLVIEWLINE("    <TH ALIGN=RIGHT><FONT SIZE=-1>"+FORMAT(MFORMAT,TOTBALANCE)+"</FONT></TH>")
   ELSE HTMLVIEWLINE("<TH ALIGN=RIGHT><FONT SIZE=-1>"+CNEG+FORMAT(MFORMAT,TOTBALANCE)+ECNEG +"</FONT></TH>")
    HTMLVIEWLINE("</TR>")
   HTMLVIEWLINE("  <TR>")
   HTMLVIEWLINE("     <TD COLSPAN=7>"+SP+"</TD>")
   HTMLVIEWLINE(" </TR>")
   HTMLVIEWLINE("</TABLE>")
   [Deposit History]
   IF MAX>0 THEN
    DO
     HTMLVIEWLINE("<font face=arial>")
     HTMLVIEWLINE("<TABLE BORDER=0 CELLPADDING=2 CELLSPACING=0 WIDTH=100%>")
     HTMLVIEWLINE(" <TR BGCOLOR="+BEACONCOLOR+">")
     HTMLVIEWLINE("     <TH><FONT SIZE=-1>Date</FONT></TH>")
     HTMLVIEWLINE("     <TH ALIGN=LEFT><FONT SIZE=-1>Deposit Description"+"</FONT></TH>")
     HTMLVIEWLINE("     <TH ALIGN=RIGHT><FONT SIZE=-1>Amount</FONT></TH>")
     HTMLVIEWLINE("     <TH><FONT SIZE=-1>Date</FONT></TH>")
     HTMLVIEWLINE("     <TH ALIGN=LEFT><FONT SIZE=-1>Deposit Description</FONT></TH>")
     HTMLVIEWLINE("     <TH ALIGN=RIGHT><FONT SIZE=-1>Amount</FONT></TH>")
     HTMLVIEWLINE("</TR>")
     HALFDEP=NUMBER(MAX * 50.000%)
     IF (HALFDEP * 2)<MAX THEN HALFDEP=HALFDEP+1
     IF HALFDEP>25 THEN HALFDEP=25
     FOR I=1 TO HALFDEP
      DO
       CAPDESC=UPPERCASE(DEPDESC(I))
       IF CHARACTERSEARCH(CAPDESC,"CK RET")>0 OR CHARACTERSEARCH(CAPDESC,"CHECK RET")>0 OR
          CHARACTERSEARCH(CAPDESC,"CKRET")>0 OR CHARACTERSEARCH(CAPDESC,"CHECKRET")>0 OR
          CHARACTERSEARCH(CAPDESC,"RET CK")>0 OR CHARACTERSEARCH(CAPDESC,"RET CHECK")>0 OR
          CHARACTERSEARCH(CAPDESC,"RETCK")>0 OR CHARACTERSEARCH(CAPDESC,"RETCHECK")>0 OR
          CHARACTERSEARCH(CAPDESC,"RETURN CK")>0 OR CHARACTERSEARCH(CAPDESC,"RETURN CHECK")>0 OR
          CHARACTERSEARCH(CAPDESC,"RETURNCK")>0 OR CHARACTERSEARCH(CAPDESC,"RETURNCHECK")>0 OR
          CHARACTERSEARCH(CAPDESC,"RETURNED CK")>0 OR CHARACTERSEARCH(CAPDESC,"RETURNED CHECK")>0  OR
          CHARACTERSEARCH(CAPDESC,"RETURNEDCK")>0 OR CHARACTERSEARCH(CAPDESC,"RETURNEDCHECK")>0  OR
          CHARACTERSEARCH(CAPDESC,"RT CK")>0 OR CHARACTERSEARCH(CAPDESC,"RTCK")>0 THEN RCLR="RED"
        ELSE RCLR="BLACK"
       HTMLVIEWLINE(" <TR>")
       HTMLVIEWLINE("     <TD ALIGN=CENTER><FONT SIZE=-1 COLOR="+RCLR+">"+FORMAT(DFORMAT,DEPDATE (I))+"</FONT></TD>")
       IF DEPFLAG(I)=0 THEN 
        DO
         HTMLVIEWLINE("   <TD><FONT SIZE=-1 COLOR="+RCLR+">"+DEPDESC(I)+"</FONT></TD>")
         HTMLVIEWLINE("   <TD ALIGN=RIGHT><FONT SIZE=-1 COLOR="+RCLR+">"+FORMAT(MFORMAT,DEPAMT (I))+"</FONT></TD>")
        END
       ELSE 
        DO
         HTMLVIEWLINE("   <TD><FONT SIZE=-1 COLOR="+RCLR+"><B>"+DEPDESC(I)+"</B></FONT></TD>")
         HTMLVIEWLINE("   <TD ALIGN=RIGHT><FONT SIZE=-1 COLOR="+RCLR+"><B>"+FORMAT (MFORMAT,DEPAMT(I))+"</B>"+"</FONT></TD>")
        END
       CAPDESC=UPPERCASE(DEPDESC(I+HALFDEP))
       IF CHARACTERSEARCH(CAPDESC,"CK RET")>0 OR CHARACTERSEARCH(CAPDESC,"CHECK RET")>0 OR
          CHARACTERSEARCH(CAPDESC,"RET CK")>0 OR CHARACTERSEARCH(CAPDESC,"RET CHECK")>0 OR
          CHARACTERSEARCH(CAPDESC,"RETURN CK")>0 OR CHARACTERSEARCH(CAPDESC,"RETURN CHECK")>0 OR
          CHARACTERSEARCH(CAPDESC,"RETURNED CK")>0 OR CHARACTERSEARCH(CAPDESC,"RETURNED CHECK")>0  THEN RCLR="RED"
        ELSE RCLR="BLACK"
       IF DEPDATE(I+HALFDEP)<>'--/--/--' THEN
        DO
         HTMLVIEWLINE("   <TD ALIGN=CENTER><FONT SIZE=-1 COLOR="+RCLR+">"+FORMAT(DFORMAT,DEPDATE (I+HALFDEP))+"</FONT></TD>")
         IF DEPFLAG(I+HALFDEP)=0 THEN 
          DO
           HTMLVIEWLINE(" <TD><FONT SIZE=-1 COLOR="+RCLR+">"+DEPDESC(I+HALFDEP)+"</FONT></TD>")
          HTMLVIEWLINE("  <TD ALIGN=RIGHT><FONT SIZE=-1 COLOR="+RCLR+">"+FORMAT(MFORMAT,DEPAMT(I +HALFDEP))+"</FONT></TD>")
          END
         ELSE 
           DO
           HTMLVIEWLINE(" <TD><FONT SIZE=-1><FONT SIZE=-1 COLOR="+RCLR+"><B>"+DEPDESC(I +HALFDEP)+"</B></FONT></TD>")
           HTMLVIEWLINE(" <TD ALIGN=RIGHT><FONT SIZE=-1 COLOR="+RCLR+"><B>"+FORMAT (MFORMAT,DEPAMT(I+HALFDEP))+"</B></FONT></TD>")
          END
        END
       HTMLVIEWLINE("</TR>")
      END

    END
  END [Not Restricted]
 HTMLVIEWLINE(" </form>")
 HTMLVIEWLINE("</body>")
 HTMLVIEWLINE("</html>")
 HTMLVIEWDISPLAY
 DEBUGTEST="N"
 ILINE=FORMAT("99/99/99",SYSTEMDATE)+"~"+FORMAT("99:99",SYSACTUALTIME)+"~"+ACCOUNT:NUMBER+"~"+FORMAT("9999",SYSUSERNUMBER)+"~7~H1 END~MAIN SCREEN "
 IF DEBUGTEST="Y" THEN
  DO
   FILEOPEN("LETTER","FINDBUG","APPEND",INUMBER,IERROR)       
    FILEWRITELINE(INUMBER,ILINE,IERROR)
    IF IERROR<>"" THEN FILEWRITELINE(INUMBER,"~7~H1 END Error:~"+IERROR,IERROR2)
   FILECLOSE(INUMBER,IERROR)
  END
 CALL LOADRESULTS
 CALL SETVARIABLES
END

PROCEDURE LOADRESULTS
 INPUTCOUNT=0
 WHILE (INPUTFORM(INPUTCOUNT)<>"EOD")
  DO
   INPUTCOUNT=INPUTCOUNT+1
   INPUTFORM(INPUTCOUNT)=ENTERLINE(0)
  END
END

PROCEDURE SETVARIABLES
 FOR I=1 TO INPUTCOUNT
  DO
   TMPCHR=INPUTFORM(I)
   IF SEGMENT(TMPCHR,1,6)="CLOSE=" THEN ENDLESSLOOP="N"
  END
END

PROCEDURE CHECKRESTRICTED
 FOR I=1 TO 20
  DO                                                      [Get accounts listed for user.]
   USERACCT(I)=GETDATACHAR(105,SYSUSERNUMBER,I)
  END
 IF GETDATANUMBER(102,SYSUSERNUMBER,451)=TRUE THEN ACCTRESTINQ=TRUE 
 ELSE ACCTRESTINQ=FALSE                                              [Allows inq to RESTRICTED:1]
 IF GETDATANUMBER(102,SYSUSERNUMBER,454)=TRUE THEN ACCTSENSINQ=TRUE 
 ELSE ACCTSENSINQ=FALSE                                              [Allows inq to RESTRICTED:2]
 IF GETDATANUMBER(102,SYSUSERNUMBER,457)=TRUE THEN EMPACCTREST=TRUE 
 ELSE EMPACCTREST=FALSE                                              [Allows inq to accts in user  list.]
 IF GETDATANUMBER(102,SYSUSERNUMBER,460)=TRUE THEN EMPACCTOTHR=TRUE 
 ELSE EMPACCTOTHR=FALSE                                              [Allows inq to RESTRICTED:3]
 IF GETDATANUMBER(102,SYSUSERNUMBER,463)=TRUE THEN EMPACCTSENS=TRUE 
 ELSE EMPACCTSENS=FALSE                                              [Allows inq to RESTRICTED:5]
 IF GETDATANUMBER(102,SYSUSERNUMBER,489)=TRUE THEN EMPACCTFAM=TRUE 
 ELSE EMPACCTFAM=FALSE                                               [Allows inq to RESTRICTED:4]
 IF GETDATANUMBER(102,SYSUSERNUMBER,492)=TRUE THEN EMPACCTFAMSENS=TRUE 
 ELSE EMPACCTFAMSENS=FALSE                                           [Allows inq to RESTRICTED:6]

 IF ACCOUNT:RESTRICT=1 AND ACCTRESTINQ=FALSE THEN RESTRICTED=TRUE
 IF ACCOUNT:RESTRICT=2 AND ACCTSENSINQ=FALSE THEN RESTRICTED=TRUE
 IF ACCOUNT:RESTRICT=3 AND EMPACCTOTHR=FALSE THEN RESTRICTED=TRUE
 IF ACCOUNT:RESTRICT=4 AND EMPACCTFAM=FALSE THEN RESTRICTED=TRUE
 IF ACCOUNT:RESTRICT=5 AND EMPACCTSENS=FALSE THEN RESTRICTED=TRUE
 IF ACCOUNT:RESTRICT=6 AND EMPACCTFAMSENS=FALSE THEN RESTRICTED=TRUE

 J=0  [This is probably unnecessary.  ]
 FOR I=1 TO 20
  DO
   IF ACCOUNT:NUMBER=USERACCT(I) THEN J=1
  END
 IF J>0 AND EMPACCTREST=TRUE AND RESTRICTED=TRUE THEN RESTRICTED=FALSE

[ IF ACCOUNT:RESTRICT=3 AND J>0 AND EMPACCTREST=FALSE THEN RESTRICTED=TRUE
 IF ACCOUNT:RESTRICT=3 AND J=0 AND EMPACCTOTHR=FALSE THEN RESTRICTED=TRUE
 IF ACCOUNT:RESTRICT=5 AND J>0 AND EMPACCTREST=FALSE THEN RESTRICTED=TRUE
 IF ACCOUNT:RESTRICT=5 AND J=0 AND EMPACCTSENS=FALSE THEN RESTRICTED=TRUE]

END

PROCEDURE GETBEACON
 CALL GETTRACKING31INFO
 FOR I=1 TO 5
  DO
   IF PSSN=BSSN(I) THEN 
    DO            
     J=I
     PMSCORE=BSCORE(I)
     PMDATE=BDATE(I)
     
     BSSNMATCH=BSSNMATCH+1
     PMSCOREARRAY(BSSNMATCH)=BSCORE(I)
     PMDATEARRAY(BSSNMATCH)=BDATE(I)               
    END
  END
 IF BSSNMATCH>0 THEN
  DO
   FOR I=1 TO BSSNMATCH 
    DO 
     FOR J=I+1 TO BSSNMATCH 
      DO 
       IF PMDATEARRAY(J)>PMDATEARRAY(I) THEN 
        DO 
         temp=FORMAT("99/99/9999",PMDATEARRAY(I))
         PMDATEARRAY(I)=PMDATEARRAY(J)
         MO=VALUE(SEGMENT(temp,1,2))
         DA=VALUE(SEGMENT(temp,4,5))
         YR=VALUE(SEGMENT(temp,7,10))
         PMDATEARRAY(J)=DATE(MO,DA,YR)           
             
         temp=FORMAT("999",PMSCOREARRAY(I))
         PMSCOREARRAY(I)=PMSCOREARRAY(J) 
         PMSCOREARRAY(J)=VALUE(temp)    
        END 
      END 
    END  
   PMSCORE=PMSCOREARRAY(1)
   PMDATE=PMDATEARRAY(1)     
  END 

 FOR EACH TRACKING WITH TRACKING:TYPE=55 AND TRACKING:USERDATE1>PMDATE
  DO
   PMSCORE=TRACKING:USERNUMBER1
   PMDATE=TRACKING:USERDATE1
  END

 IF PMSCORE>=9000 THEN BEACONCOLOR="TEAL"
 ELSE IF PMSCORE<999 AND PMSCORE>=680 THEN BEACONCOLOR="GREEN"
 ELSE IF PMSCORE<680 AND PMSCORE>=600 THEN BEACONCOLOR="#FFFF00"         [Yellow]
 ELSE IF PMSCORE<600 AND PMSCORE>0 AND PMSCORE<>333 THEN BEACONCOLOR="RED"
 ELSE BEACONCOLOR="BLUE" [No score]

 IF ACCOUNT:TYPE=1 THEN BEACONCOLOR="GRAY"                                [Old Business Type]
 ELSE IF ACCOUNT:TYPE=10 THEN BEACONCOLOR="ORANGE"                        [Sole Prop]
 ELSE IF ACCOUNT:TYPE>=11 AND ACCOUNT:TYPE<=19 THEN BEACONCOLOR="#CC5500" [Business Accounts - Orange]
 ELSE IF ACCOUNT:TYPE>=20 AND ACCOUNT:TYPE<=23 THEN BEACONCOLOR="PURPLE"  [Estate, Trust and Rep Payee ]
 ELSE IF ACCOUNT:TYPE=97 THEN BEACONCOLOR="MAROON"                        [ATFCU]
 ELSE IF ACCOUNT:TYPE=98 THEN BEACONCOLOR="RED"                           [Charge Off]
 ELSE IF ISMINOR="Y" AND BEACONCOLOR<>"TEAL" THEN BEACONCOLOR="PINK"      [Minor]
 FNDCOLOROVERRIDE="N"
[ if sysusernumber<>484 then do]
 FOR EACH NOTE WITH (NOTE:EXPIRATIONDATE='--/--/--' OR  NOTE:EXPIRATIONDATE>SYSTEMDATE) AND
     UPPERCASE(SEGMENT(NOTE:TEXT:1,1,14))="COLOROVERRIDE="
  DO
   IF FNDCOLOROVERRIDE="N" THEN BEACONCOLOR=UPPERCASE(SEGMENT(NOTE:TEXT:1,15,LENGTH(NOTE:TEXT:1)))
   FNDCOLOROVERRIDE="Y"
  END
[end]
 IF RESTRICTED=TRUE THEN STOPLIGHT="Anim_horiz_all.gif"
 ELSE IF BEACONCOLOR="RED" THEN STOPLIGHT="Anim_horiz_red.gif"
 ELSE IF BEACONCOLOR="#FFFF00" OR BEACONCOLOR="YELLOW" THEN STOPLIGHT="Anim_horiz_yellow.gif"
 ELSE IF BEACONCOLOR="GREEN" THEN STOPLIGHT="Anim_horiz_green.gif"
 ELSE STOPLIGHT="Anim_horiz_all.gif"
END

PROCEDURE DISPLAYACCTNAMES
 NSSN=""
 IF VALUE(NAME:SSN)>0 THEN
  DO
   OS=VALUE(SEGMENT(NAME:SSN,6,9))
   OSSN(OS,1)=SEGMENT(NAME:SSN,6,9)
   OSSN(OS,2)=NAME:SSN
   NSSN=SEGMENT(NAME:SSN,6,9)
  END
 NI=NI+1
 HTMLVIEWLINE(" <TR>")
 HTMLVIEWLINE("     <TD><FONT SIZE=-1>"+NAME:LONGNAME)
 IF NAME:DEATHDATE<>'--/--/--' THEN  
 HTMLVIEWLINE("<FONT COLOR=RED><B> (Deceased: "+FORMAT("99/99/99",NAME:DEATHDATE)+") </B></FONT>")
 HTMLVIEWLINE("       </FONT></TD>")
 HTMLVIEWLINE("     <TD ALIGN=CENTER><FONT SIZE=-1>"+NDESC(NAME:TYPE)+"</FONT></TD>")
 NAMEINFO(NI,1)=CAPITALIZE(SEGMENT(NAME:LONGNAME,1,20))
 NAMEINFO(NI,2)=SEGMENT(NDESC(NAME:TYPE),1,7)
 CALL DISPNMID
 HTMLVIEWLINE("     <TD ALIGN=CENTER><FONT SIZE=-1>")
 IF MONTH(NAME:BIRTHDATE)=MONTH(SYSTEMDATE) AND 
    DAY(NAME:BIRTHDATE)=DAY(SYSTEMDATE)THEN HTMLVIEWLINE("<FONT COLOR=RED><B>*")
 HTMLVIEWLINE(FORMAT("99/99/9999",NAME:BIRTHDATE))
 IF MONTH(NAME:BIRTHDATE)=MONTH(SYSTEMDATE) AND 
    DAY(NAME:BIRTHDATE)=DAY(SYSTEMDATE)THEN HTMLVIEWLINE("*</B></FONT>")
 HTMLVIEWLINE("</FONT></TD>")
 
 HTMLVIEWLINE("     <TD ALIGN=CENTER><FONT SIZE=-1>")
 IF NAME:BIRTHDATE<>'--/--/--' THEN
  DO
   MEMBERAGE = YEAR(SYSTEMDATE) - YEAR(NAME:BIRTHDATE)
   IF DATE(MONTH(NAME:BIRTHDATE),DAY(NAME:BIRTHDATE),YEAR(SYSTEMDATE))>SYSTEMDATE THEN
    MEMBERAGE=MEMBERAGE -1
   HTMLVIEWLINE(FORMAT("##9",MEMBERAGE))
  END
 ELSE
  DO
   HTMLVIEWLINE("N/A")
  END
 HTMLVIEWLINE("</FONT></TD>")

 HTMLVIEWLINE("     <TD ALIGN=CENTER>")
 IF NSSN<>"" THEN
  DO
   FNDINPSSN="N"
   FOR III=1 TO FI
    DO
     IF INPSSNS(III)=NSSN THEN FNDINPSSN="Y"
    END
   FI=FI+1
   INPSSNS(FI)=NSSN
   HTMLVIEWLINE("<FONT SIZE=-1>XXXXX"+OSSN(OS,1)+"</FONT></TD>")
  END
 ELSE HTMLVIEWLINE("&nbsp;")
 HTMLVIEWLINE("     </TD>")
 NAMEINFO(NI,4)=FORMAT("99/99/9999",NAME:BIRTHDATE)
 NAMEINFO(NI,5)=NSSN
 J=0
 
 FOR I=1 TO 5
  DO
   IF PSSN=BSSN(I) AND BDATE(I)<=PMDATE THEN 
    DO
     J=I
     DSCORE=PMSCORE
     DDATE=PMDATE
    END
   ELSE IF NAME:SSN=BSSN(I) AND BSSN(I)<>"" THEN 
    DO
     J=I
     DSCORE=BSCORE(I)
     DDATE=BDATE(I)
    END
  END
 IF J>0 THEN 
  DO
   HTMLVIEWLINE("     <TD ALIGN=CENTER><FONT SIZE=-1>"+FORMAT("9999",DSCORE)+" - "+FORMAT (DFORMAT,DDATE)+"</FONT></TD>") 
   NAMEINFO(NI,6)=FORMAT("9999",DSCORE)+" - "+FORMAT(DFORMAT,DDATE)
  END
 ELSE HTMLVIEWLINE("<TD>"+SP+"</TD>")
 HTMLVIEWLINE("     <TD><FONT SIZE=-1>"+NAME:EMPLOYERNAME+"</FONT></TD>")
 HTMLVIEWLINE("</TR>")
 NAMEINFO(NI,7)=CAPITALIZE(NAME:EMPLOYERNAME)
END

PROCEDURE GETADDRESSINFO
 IF NAME:TYPE<>0 THEN 
  DO
   MAILADD=TRUE
   FOR I=0 TO 15
    DO
     ADDLINE(I)=""
    END
  END
 IF ACCOUNT:STATEMENTMAILCODE=3 OR ANYWARNING(ACCOUNT,20) THEN ALCOUNT=4 ELSE ALCOUNT=1
 IF NAME:EXTRAADDRESS<>"" THEN
  DO
   ADDLINE(ALCOUNT)=NAME:EXTRAADDRESS
   ALCOUNT=ALCOUNT+1
  END
 IF NAME:STREET<>"" THEN
  DO
   ADDLINE(ALCOUNT)=NAME:STREET
   ALCOUNT=ALCOUNT+1
  END
 IF NAME:ADDRESSTYPE=0 OR NAME:ADDRESSTYPE=2 THEN
  DO
   ADDLINE(ALCOUNT)=NAME:CITY
   IF NAME:STATE<>"" THEN ADDLINE(ALCOUNT)=ADDLINE(ALCOUNT)+", "+NAME:STATE
   IF ADDLINE(ALCOUNT)<>"" THEN ADDLINE(ALCOUNT)=ADDLINE(ALCOUNT)+"  "+NAME:ZIPCODE
   ALCOUNT=ALCOUNT+1
   IF NAME:ADDRESSTYPE=2 AND NAME:COUNTRY<>"" THEN
    DO
     ADDLINE(ALCOUNT)=NAME:COUNTRY
     ALCOUNT=ALCOUNT+1
    END
  END
 ELSE
  DO
   ADDLINE(ALCOUNT)=NAME:ZIPCODE
   IF ADDLINE(ALCOUNT)<>"" THEN ADDLINE(ALCOUNT)=ADDLINE(ALCOUNT)+"  "
   IF NAME:CITY<>"" THEN ADDLINE(ALCOUNT)=ADDLINE(ALCOUNT)+NAME:CITY
   IF NAME:STATE<>"" THEN ADDLINE(ALCOUNT)=ADDLINE(ALCOUNT)+", "+NAME:STATE
   ALCOUNT=ALCOUNT+1
   IF NAME:COUNTRY<>"" THEN
    DO
     ADDLINE(ALCOUNT)=NAME:COUNTRY
     ALCOUNT=ALCOUNT+1
    END
  END
 IF NAME:TYPE=0 THEN                [STORE PHONE INFORMATION FROM MAIN NAME RECORD]
  DO
   HP="Home: "+NAME:HOMEPHONE 
   WP="Work: "+NAME:WORKPHONE
   IF NAME:WORKPHONEEXTENSION<>"" THEN WP=WP+" Ext. "+NAME:WORKPHONEEXTENSION
   CELL="Cell: "+NAME:MOBILEPHONE
   EM="eMail: "+NAME:EMAIL
  END
 ADDLINE(ALCOUNT)=HP
 ALCOUNT=ALCOUNT+1
 ADDLINE(ALCOUNT)=WP
 ALCOUNT=ALCOUNT+1
 ADDLINE(ALCOUNT)=CELL
 ALCOUNT=ALCOUNT+1
 ADDLINE(ALCOUNT)=EM
 ALCOUNT=ALCOUNT+1
 IF MAILADD=TRUE THEN 
  DO
   FOR I=1 TO ALCOUNT
    DO
     ADDLINE(I)="<FONT COLOR=BLUE FONT SIZE=-1>"+ADDLINE(I)+"</FONT>"
    END
  END
END

PROCEDURE DISPLAYSHARENAMES
 FOR EACH SHARE NAME WITH (SHARE NAME:EFFECTIVEDATE<=SYSTEMDATE AND
  (SHARE NAME:EXPIRATIONDATE='--/--/--' OR SHARE NAME:EXPIRATIONDATE>SYSTEMDATE))
  DO
   NSSN=""
   OS=VALUE(SEGMENT(SHARE NAME:SSN,6,9))
   OSSN(OS,1)=SEGMENT(SHARE NAME:SSN,6,9)
   OSSN(OS,2)=SHARE NAME:SSN
   NI=NI+1
   IF (SHARE NAME:SSNTYPE=0 OR SHARE NAME:SSNTYPE=4) AND LENGTH(SHARE NAME:SSN)=9 
    THEN NSSN=SEGMENT(SHARE NAME:SSN,1,3)+"-"+SEGMENT(SHARE NAME:SSN,4,5)+"-"+SEGMENT(SHARE  NAME:SSN,6,9)
   IF SHARE NAME:SSNTYPE=1 AND LENGTH(SHARE NAME:SSN)=9 
    THEN NSSN=SEGMENT(SHARE NAME:SSN,1,2)+"-"+SEGMENT(SHARE NAME:SSN,3,9)
   IF SHARE NAME:TYPE<2 OR SHARE NAME:TYPE=5 OR SHARE NAME:TYPE=6 OR SHARE NAME:TYPE=7 OR
      SHARE NAME:TYPE=8 OR SHARE NAME:TYPE=9 OR SHARE NAME:TYPE=14 THEN
    DO
     HTMLVIEWLINE(" <TR>")
     HTMLVIEWLINE("     <TD><FONT SIZE=-1>"+CAPITALIZE(SHARE NAME:LONGNAME)+"</FONT>")
     IF SHARE NAME:DEATHDATE<>'--/--/--' THEN  
     HTMLVIEWLINE("<FONT COLOR=RED><B> (Deceased: "+FORMAT("99/99/99",SHARE NAME:DEATHDATE)+") </B></FONT>")
     HTMLVIEWLINE("  </TD>")
     HTMLVIEWLINE("     <TD ALIGN=CENTER><FONT SIZE=-1>"+NDESC(SHARE NAME:TYPE)+SP+"S-"+SHARE:ID +"</FONT></TD>")
    END
   NAMEINFO(NI,1)=SEGMENT(CAPITALIZE(SHARE NAME:LONGNAME),1,20)
   NAMEINFO(NI,2)=NDESC(SHARE NAME:TYPE)
   NAMEINFO(NI,3)="S-"+SHARE:ID
   CALL DISPSHID
   IF SHARE NAME:TYPE<2 OR SHARE NAME:TYPE=5 OR SHARE NAME:TYPE=6 OR SHARE NAME:TYPE=7 OR
      SHARE NAME:TYPE=8 OR SHARE NAME:TYPE=9 OR SHARE NAME:TYPE=14 THEN
    DO
     HTMLVIEWLINE("<TD ALIGN=CENTER><FONT SIZE=-1>")
     IF MONTH(SHARE NAME:BIRTHDATE)=MONTH(SYSTEMDATE) AND 
        DAY(SHARE NAME:BIRTHDATE)=DAY(SYSTEMDATE)THEN HTMLVIEWLINE("<FONT  COLOR=RED><B>*"+CTRLCHR(01))
     HTMLVIEWLINE(FORMAT("99/99/9999",SHARE NAME:BIRTHDATE))
     IF MONTH(SHARE NAME:BIRTHDATE)=MONTH(SYSTEMDATE) AND 
        DAY(SHARE NAME:BIRTHDATE)=DAY(SYSTEMDATE)THEN HTMLVIEWLINE("*</B></FONT>")
     HTMLVIEWLINE("</FONT></TD>")
     [HTMLVIEWLINE("     <TD ALIGN=CENTER><FONT SIZE=-1>"+FORMAT("99/99/9999",SHARE  NAME:BIRTHDATE)+"</FONT></TD>")]

     MEMBERAGE = YEAR(SYSTEMDATE) - YEAR(SHARE NAME:BIRTHDATE)
     IF DATE(MONTH(SHARE NAME:BIRTHDATE),DAY(SHARE NAME:BIRTHDATE),YEAR(SYSTEMDATE))>SYSTEMDATE THEN
      MEMBERAGE=MEMBERAGE -1
     IF SHARE NAME:BIRTHDATE<>'--/--/--' THEN
      HTMLVIEWLINE("<TD ALIGN=CENTER><FONT SIZE=-1>" + FORMAT("##9",MEMBERAGE) + "</FONT></TD>")
     ELSE
      HTMLVIEWLINE("<TD>&nbsp;</TD>")
     HTMLVIEWLINE("     <TD ALIGN=CENTER>")
     IF NSSN<>"" THEN
      DO
       FNDINPSSN="N"
       FOR III=1 TO FI
        DO
         IF INPSSNS(III)=NSSN THEN FNDINPSSN="Y"
        END
       FI=FI+1
       INPSSNS(FI)=NSSN
       HTMLVIEWLINE("<FONT SIZE=-1>XXXXX"+OSSN(OS,1)+"</FONT></TD>")
      END
     ELSE HTMLVIEWLINE("&nbsp;")
     HTMLVIEWLINE("</TD>")
     NAMEINFO(NI,4)=FORMAT("99/99/9999",SHARE NAME:BIRTHDATE)
    END
   NAMEINFO(NI,5)=NSSN
   J=0
   FOR I=1 TO 5
    DO
     IF SHARE NAME:SSN=BSSN(I) AND BSSN(I)<>"" THEN J=I
    END
   IF SHARE NAME:TYPE<2 OR SHARE NAME:TYPE=5 OR SHARE NAME:TYPE=6 OR SHARE NAME:TYPE=7 OR
      SHARE NAME:TYPE=8 OR SHARE NAME:TYPE=9 OR SHARE NAME:TYPE=14 THEN
    DO
     IF J>0 THEN 
      DO
       HTMLVIEWLINE("   <TD ALIGN=CENTER><FONT SIZE=-1>"+FORMAT("9999",BSCORE(J))+" - "+FORMAT (DFORMAT,BDATE(J))+"</FONT></TD>") 
       NAMEINFO(NI,6)=FORMAT("9999",BSCORE(J))+" - "+FORMAT(DFORMAT,BDATE(J))
      END
     ELSE 
      HTMLVIEWLINE("    <TD>"+SP+"</TD>")
     IF SHARE NAME:EMPLOYERNAME<>"" THEN 
      DO
       HTMLVIEWLINE("   <TD><FONT SIZE=-1>"+SHARE NAME:EMPLOYERNAME+"</FONT></TD>")
       NAMEINFO(NI,7)=CAPITALIZE(SHARE NAME:EMPLOYERNAME)
      END
     ELSE 
      HTMLVIEWLINE("    <TD>"+SP+"</TD>")
    HTMLVIEWLINE(" </TR>")
    END
  END
END

PROCEDURE DISPLAYLOANNAMES
 FOR EACH LOAN NAME WITH (LOAN NAME:EFFECTIVEDATE<=SYSTEMDATE AND LOAN NAME:TYPE<>29 AND 
  (LOAN NAME:EXPIRATIONDATE='--/--/--' OR LOAN NAME:EXPIRATIONDATE>SYSTEMDATE))
  DO
   NI=NI+1
   NSSN=""
   OS=VALUE(SEGMENT(LOAN NAME:SSN,6,9))
   OSSN(OS,1)=SEGMENT(LOAN NAME:SSN,6,9)
   OSSN(OS,2)=LOAN NAME:SSN
   IF LOAN NAME:SSNTYPE=0 AND LENGTH(LOAN NAME:SSN)=9 
    THEN NSSN=SEGMENT(LOAN NAME:SSN,1,3)+"-"+SEGMENT(LOAN NAME:SSN,4,5)+"-"+SEGMENT(LOAN  NAME:SSN,6,9)
   IF LOAN NAME:SSNTYPE=1 AND LENGTH(LOAN NAME:SSN)=9 
    THEN NSSN=SEGMENT(LOAN NAME:SSN,1,2)+"-"+SEGMENT(LOAN NAME:SSN,3,9)
   HTMLVIEWLINE("  <TR>")
   HTMLVIEWLINE("      <TD><FONT SIZE=-1>"+CAPITALIZE(LOAN NAME:LONGNAME)+"</FONT>")
   IF LOAN NAME:DEATHDATE<>'--/--/--' THEN  
   HTMLVIEWLINE("<FONT COLOR=RED><B> (Deceased: "+FORMAT("99/99/99",LOAN NAME:DEATHDATE)+") </B></FONT>")
   HTMLVIEWLINE("  </TD>")
   HTMLVIEWLINE("      <TD ALIGN=CENTER><FONT SIZE=-1>"+NDESC(LOAN NAME:TYPE)+SP+"L-"+LOAN:ID +"</FONT></TD>")
   NAMEINFO(NI,1)=SEGMENT(CAPITALIZE(LOAN NAME:LONGNAME),1,20)
   NAMEINFO(NI,2)=NDESC(LOAN NAME:TYPE)
   NAMEINFO(NI,3)="L-"+LOAN :ID
   CALL DISPLNID
   HTMLVIEWLINE("      <TD ALIGN=CENTER><FONT SIZE=-1>"+FORMAT("99/99/9999",LOAN  NAME:BIRTHDATE)+"</FONT></TD>")
     MEMBERAGE = YEAR(SYSTEMDATE) - YEAR(LOAN NAME:BIRTHDATE)
     IF DATE(MONTH(LOAN NAME:BIRTHDATE),DAY(LOAN NAME:BIRTHDATE),YEAR(SYSTEMDATE))>SYSTEMDATE THEN
      MEMBERAGE=MEMBERAGE -1
     IF LOAN NAME:BIRTHDATE<>'--/--/--' THEN
      HTMLVIEWLINE("<TD ALIGN=CENTER><FONT SIZE=-1>" + FORMAT("##9",MEMBERAGE) + "</FONT></TD>")
     ELSE
      HTMLVIEWLINE("<TD>&nbsp;</TD>")

     HTMLVIEWLINE("    <TD ALIGN=CENTER>")
     IF NSSN<>"" THEN
      DO
       FNDINPSSN="N"
       FOR III=1 TO FI
        DO
         IF INPSSNS(III)=NSSN THEN FNDINPSSN="Y"
        END
       FI=FI+1
       INPSSNS(FI)=NSSN
       HTMLVIEWLINE("<FONT SIZE=-1>XXXXX"+OSSN(OS,1)+"</FONT></TD>")
      END
     ELSE HTMLVIEWLINE("&nbsp;")
     HTMLVIEWLINE("</TD>")
   NAMEINFO(NI,4)=FORMAT("99/99/9999",LOAN NAME:BIRTHDATE)
   NAMEINFO(NI,5)=NSSN
   J=0
   FOR I=1 TO 5
    DO
     IF LOAN NAME:SSN=BSSN(I) AND BSSN(I)<>""THEN J=I
    END
   IF J>0 THEN 
    DO
     HTMLVIEWLINE("    <TD ALIGN=CENTER><FONT SIZE=-1>"+FORMAT("9999",BSCORE(J))+" - "+FORMAT (DFORMAT,BDATE(J))+"</FONT></TD>") 
     NAMEINFO(NI,6)=FORMAT("9999",BSCORE(J))+" - "+FORMAT(DFORMAT,BDATE(J))
    END
   ELSE HTMLVIEWLINE(" <TD>"+SP+"</TD>")
   IF LOAN NAME:EMPLOYERNAME<>"" THEN 
    DO
     HTMLVIEWLINE("    <TD><FONT SIZE=-1>"+LOAN NAME:EMPLOYERNAME+"</FONT></TD>")
     NAMEINFO(NI,7)=CAPITALIZE(NAME:EMPLOYERNAME)
    END
   ELSE HTMLVIEWLINE(" <TD>"+SP+"</TD>")
   HTMLVIEWLINE(" </TR>")
  END
END

PROCEDURE GETSHAREHOLDS
 FOR EACH SHARE HOLD WITH (SHARE HOLD:MATCHDATE='--/--/--' AND (SHARE HOLD:TYPE=0 OR SHARE  HOLD:TYPE=1 OR (SHARE HOLD:TYPE=4 AND
  SHARE HOLD:REFERENCE2<>"MATCHED") [OR SHARE HOLD:TYPE=5]) AND(SHARE  HOLD:EXPIRATIONDATE='--/--/--' OR
  SHARE HOLD:EXPIRATIONDATE>SYSTEMDATE OR (SHARE HOLD:EXPIRATIONDATE=SYSACTUALDATE AND
  SHARE HOLD:EXPIRATIONTIME>SYSACTUALTIME)))
  DO
   IF HCOUNT<16 THEN
    DO
     HDESC(HCOUNT)="S-"+SHARE:ID+"  "
     IF SHARE HOLD:TYPE=0 THEN HDESC(HCOUNT)=HDESC(HCOUNT)+"General"
     IF SHARE HOLD:TYPE=1 THEN HDESC(HCOUNT)=HDESC(HCOUNT)+"Check"
     IF SHARE HOLD:TYPE=4 AND SHARE HOLD:PAYEENAME<>"" THEN HDESC(HCOUNT)=HDESC(HCOUNT)+SHARE  HOLD:PAYEENAME
     IF SHARE HOLD:TYPE=4 AND SHARE HOLD:PAYEENAME="" THEN HDESC(HCOUNT)=HDESC(HCOUNT)+"Card  Authoriztion"
     [IF SHARE HOLD:TYPE=5 THEN HDESC(HCOUNT)=HDESC(HCOUNT)+"Pledged for "+SHARE  HOLD:REFERENCE1+"-"+SHARE HOLD:REFERENCE2]
     HAMT(HCOUNT)="$ -"+FORMAT(NFORMAT, SHARE HOLD:AMOUNT)
     HEXP(HCOUNT)=FORMAT(DFORMAT, SHARE HOLD:EXPIRATIONDATE)
     IF SHARE HOLD:EXPIRATIONTIME<>0000 THEN HEXP(HCOUNT)=FORMAT("##:##",SHARE  HOLD:EXPIRATIONTIME)+" - "+HEXP(HCOUNT)
     HCOUNT=HCOUNT+1
    END
   ELSE HDESC(0)="Too many holds to list all here."
  END
END

PROCEDURE GETLOANHOLDS
 FOR EACH LOAN HOLD WITH  LOAN HOLD:MATCHDATE='--/--/--' AND
    (LOAN HOLD:TYPE=4 AND LOAN HOLD:REFERENCE2<>"MATCHED" AND (LOAN  HOLD:EXPIRATIONDATE='--/--/--' OR
     LOAN HOLD:EXPIRATIONDATE>SYSTEMDATE OR (LOAN HOLD:EXPIRATIONDATE=SYSACTUALDATE AND LOAN  HOLD:EXPIRATIONTIME>SYSACTUALTIME)))
  DO
   IF HCOUNT<16 THEN
    DO
     HDESC(HCOUNT)="L-"+LOAN:ID+"  "
     IF LOAN HOLD:PAYEENAME<>"" THEN HDESC(HCOUNT)=HDESC(HCOUNT)+LOAN HOLD:PAYEENAME
      ELSE HDESC(HCOUNT)=HDESC(HCOUNT)+"Card Authoriztion"
     HAMT(HCOUNT)=FORMAT(MFORMAT, LOAN HOLD:AMOUNT)
     HEXP(HCOUNT)=FORMAT(DFORMAT, LOAN HOLD:EXPIRATIONDATE)
     IF LOAN HOLD:EXPIRATIONTIME<>0000 THEN HEXP(HCOUNT)=HEXP(HCOUNT)+" - "+FORMAT("##:##",LOAN  HOLD:EXPIRATIONTIME)
     HCOUNT=HCOUNT+1
    END
   ELSE HDESC(0)="Too many holds to list all here."
  END
END

PROCEDURE CALCAVERAGES
 AVGDEPS=$0.00
 BALANCE=SHARE:BALANCE
 SLOT=0
 WHILE SLOT<=400
  DO
   DAILYBALANCE(SLOT)=$0.00
   SLOT=SLOT+1
  END
 FOR EACH SHARE TRANSACTION WITH (SHARE TRANSACTION:VOIDCODE=0 AND SHARE  TRANSACTION:EFFECTIVEDATE>=SYSTEMDATE-364)
  DO
   CALL BUILDDEPHISTORY
   IF SHARE TRANSACTION:COMMENTCODE=0 THEN
    DO
     TRANSCOMMENTS=""                           [  CLEAR COMMENT VALUES]
     TRANSTIME=0
     TRANSSEQ=0
     TRANSDATE='--/--/--'
     TRANSUSER=0
     TRANSID=""
     TRANSHOLD=""
     IF SHARE TRANSACTION:REGECODE=1 THEN TRANSCONT=""
     SLOT=SHARE TRANSACTION:EFFECTIVEDATE-(SYSTEMDATE-364)
     BALANCE=BALANCE-SHARE TRANSACTION:BALANCECHANGE
     DAILYBALANCE(SLOT)=
     DAILYBALANCE(SLOT)+SHARE TRANSACTION:BALANCECHANGE
     IF (SHARE TRANSACTION:ACTIONCODE="D" AND SHARE TRANSACTION:TRANSFERCODE<>1 AND SHARE  TRANSACTION:SOURCECODE<>"V") THEN 
      DO
       FOUNDLCDEP="N"
       LI=0
       WHILE LI<LC AND FOUNDLCDEP="N"
        DO
         LI=LI+1
         IF LCDATE(LI)=SHARE TRANSACTION:EFFECTIVEDATE AND SHARE TRANSACTION:SOURCECODE=" " AND 
            SHARE TRANSACTION:BALANCECHANGE>$0.00 THEN
          DO
           IF SHARE TRANSACTION:BALANCECHANGE=LCDEPS(LI) OR
             (LCDEPS(LI)-$1,300.00>$0.00 AND
              SHARE TRANSACTION:BALANCECHANGE>=LCDEPS(LI)-$1,300.00 AND 
              SHARE TRANSACTION:BALANCECHANGE<LCDEPS(LI)) THEN 
            DO
             FOUNDLCDEP="Y"
            END
          END
        END
       IF FOUNDLCDEP="N" THEN AVGDEPS=AVGDEPS+SHARE TRANSACTION:BALANCECHANGE
      END
    END
   ELSE
    DO
     IF CHARACTERSEARCH(SHARE TRANSACTION:COMMENT,"%% Check hold")>0 THEN TRANSHOLD="Y"  [STORE  COMMENT VALUES]
     IF CHARACTERSEARCH(SHARE TRANSACTION:COMMENT,"%%")=0 THEN
      DO
       TRANSCOMMENTS=SHARE TRANSACTION:COMMENT
       TRANSTIME=SHARE TRANSACTION:POSTTIME
       TRANSSEQ=SHARE TRANSACTION:SEQUENCENUMBER
       TRANSDATE=SHARE TRANSACTION:POSTDATE
       TRANSUSER=SHARE TRANSACTION:USERNUMBER
       TRANSID=SHARE TRANSACTION:ID
       IF SHARE TRANSACTION:REGECODE=1 THEN TRANSCONT="Y"
      END
    END
  END
 UNTIL SHARE TRANSACTION:POSTDATE<SYSTEMDATE-364
 TOTDAILYBAL=$0.00
 SLOT=0
 WHILE SLOT<=364
  DO
   BALANCE=BALANCE+DAILYBALANCE(SLOT)
   TOTDAILYBAL=TOTDAILYBAL+BALANCE
   SLOT=SLOT+1
  END
 SHAREAVGDAILYBAL=TOTDAILYBAL/365
 IF SHARE:CLOSEDATE='--/--/--' THEN TOTSHAREAVGBAL=TOTSHAREAVGBAL+SHAREAVGDAILYBAL
 AVGDEPS=AVGDEPS/12
 IF SHARE:CLOSEDATE='--/--/--' THEN TOTAVGDEPS=TOTAVGDEPS+AVGDEPS
END

PROCEDURE BUILDDEPHISTORY
 IF SHARE TRANSACTION:ACTIONCODE="D" AND SHARE TRANSACTION:SOURCECODE<>"V" AND 
  SHARE TRANSACTION:TRANSFERCODE<>1 AND MAX<499 THEN
  DO
   DEPDATE(0)=SHARE TRANSACTION:EFFECTIVEDATE
   IF SHARE TRANSACTION:SOURCECODE="M" THEN DEPDESC(0)=SHARE:ID+" INCOMING WIRE - "+SHARE TRANSACTION:DESCRIPTION
   ELSE DEPDESC(0)=SHARE:ID+" "+SHARE TRANSACTION:DESCRIPTION
   IF TRANSHOLD="Y" THEN DEPFLAG(0)=1
   IF TRANSCOMMENTS<>"" AND TRANSDATE=SHARE TRANSACTION:POSTDATE AND    [DOES LAST COMMENT GO  WITH TRANSACTION]
      NOT(CHARACTERSEARCH(UPPERCASE(TRANSCOMMENTS),"ATFCU")>0 AND CHARACTERSEARCH(UPPERCASE(TRANSCOMMENTS),"AUSTIN TELCO FCU")>0 
      AND (SHARE TRANSACTION:USERNUMBER=23 OR SHARE TRANSACTION:USERNUMBER=25)) AND [added for  Raye Anne]
      TRANSUSER=SHARE TRANSACTION:USERNUMBER AND (TRANSID=SHARE TRANSACTION:ID OR 
      (TRANSID<>SHARE TRANSACTION:ID)) AND SEGMENT(TRANSCOMMENTS,1,2)<>"%%" AND 
      ((TRANSTIME>=(SHARE TRANSACTION:POSTTIME-5) AND TRANSTIME<=(SHARE TRANSACTION:POSTTIME+5))  OR
       ABS(TRANSSEQ-SHARE TRANSACTION:SEQUENCENUMBER)<=25) THEN DEPDESC(0)=DEPDESC(0)+"   "+TRANSCOMMENTS
   DEPAMT(0)=SHARE TRANSACTION:BALANCECHANGE
   IF LENGTH(DEPDESC(0))<5 THEN              [NO DESCRIPTION OR COMMENT FOUND]
    DO
     IF SHARE TRANSACTION:ADJUSTMENTCODE=1 THEN DEPDESC(0)=SHARE:ID+" Adjustment"
     ELSE IF SHARE TRANSACTION:SOURCECODE="" AND DEPDESC(0)=SHARE:ID+" " THEN DEPDESC(0)=DEPDESC (0)+"Journal Entry"
     ELSE IF SHARE TRANSACTION:SOURCECODE="E" AND DEPDESC(0)=SHARE:ID+" " THEN DEPDESC(0) =DEPDESC(0)+"ACH"
     ELSE IF SHARE TRANSACTION:SOURCECODE="P" AND DEPDESC(0)=SHARE:ID+" " THEN DEPDESC(0) =DEPDESC(0)+"Payroll"
     ELSE IF SHARE TRANSACTION:SOURCECODE="C" AND DEPDESC(0)=SHARE:ID+" " THEN DEPDESC(0) =DEPDESC(0)+"Cash"
     ELSE IF SHARE TRANSACTION:SOURCECODE="K" AND DEPDESC(0)=SHARE:ID+" " THEN DEPDESC(0) =DEPDESC(0)+"Check"
     ELSE DEPDESC(0)=DEPDESC(0)+"Other"
    END
   IF ACCOUNT:TYPE=2  THEN
    DO
     IF SHARE TRANSACTION:USERNUMBER=900 OR
        CHARACTERSEARCH(UPPERCASE(SHARE TRANSACTION:DESCRIPTION),"IRS")>0 OR
        CHARACTERSEARCH(UPPERCASE(SHARE TRANSACTION:DESCRIPTION),"XXSOC")>0 OR
        (CHARACTERSEARCH(UPPERCASE(SHARE TRANSACTION:DESCRIPTION),"EMPLOYEE")>0 AND
         CHARACTERSEARCH(UPPERCASE(SHARE TRANSACTION:DESCRIPTION),"RET")>0) THEN DEPAMT(0)=$0.00
    END
   IF CHARACTERSEARCH(UPPERCASE(SHARE TRANSACTION:DESCRIPTION),"ATFCU PAYROLL")>0 OR 
      CHARACTERSEARCH(UPPERCASE(SHARE TRANSACTION:DESCRIPTION),"AUSTIN TELCO FCU")>0 THEN DEPAMT(0)=$0.00
   FOR I=MAX TO 0 BY -1                                   [PUT TRANSACTIONS IN ORDER FROM NEWEST  TO OLDEST]
    DO
     IF DEPDATE(0)>DEPDATE(I) THEN
      DO
       DEPDATE(I+1)=DEPDATE(I)
       DEPDESC(I+1)=DEPDESC(I)
       DEPAMT(I+1)=DEPAMT(I)
       DEPFLAG(I+1)=DEPFLAG(I)
      END
     ELSE
      DO
       DEPDATE(I+1)=DEPDATE(0)
       DEPDESC(I+1)=DEPDESC(0)
       DEPAMT(I+1)=DEPAMT(0)
       DEPFLAG(I+1)=DEPFLAG(0)
       I=-1
      END
    END [FOR]
   MAX=MAX+1
   DEPDATE(0)='--/--/--'
   DEPDESC(0)=""
   DEPAMT(0)=$0.00
   DEPFLAG(0)=0
  END [IF "D"]
 [ELSE IF SHARE TRANSACTION:COMMENTCODE=1 THEN
  DO
   IF SEGMENT(SHARE TRANSACTION:COMMENT,1,13)="%% Check hold" THEN DEPFLAG(0)=1
   ELSE DEPDESC(0)=SEGMENT(SHARE TRANSACTION:COMMENT,1,LENGTH(SHARE TRANSACTION:COMMENT))
  END
 ELSE DEPDESC(0)=""
 IF SHARE TRANSACTION:COMMENTCODE=1 AND SEGMENT(SHARE TRANSACTION:COMMENT,1,13)="%% Check hold"
  THEN DEPFLAG(0)=1
 IF SHARE TRANSACTION:COMMENTCODE=1 AND SEGMENT(SHARE TRANSACTION:COMMENT,1,2)<>"%%"
  THEN DEPDESC(0)=SEGMENT(SHARE TRANSACTION:COMMENT,1,LENGTH(SHARE TRANSACTION:COMMENT))
 IF SHARE TRANSACTION:ACTIONCODE<>"D" OR SHARE TRANSACTION:COMMENTCODE<>1 OR 
  (SHARE TRANSACTION:TRANSFERCODE=1 AND SHARE TRANSACTION:ACTIONCODE="D")
  THEN DEPDESC(0)=""]
END


PROCEDURE MISMATCHJOINT
 MO=0
 CNT=0
 MW=0
 ALLIDS=""
 SHIDS=""
 FOR EACH SHARE WITH SHARE:CLOSEDATE='--/--/--' AND SHARE:CHARGEOFFDATE='--/--/--' [AND
    (SHARE:TYPE=00 OR SHARE:TYPE=01 OR SHARE:TYPE=50 OR SHARE:TYPE=80 OR SHARE:TYPE=81 OR  SHARE:TYPE=82)]
  DO
   ALLIDS=ALLIDS+", "+SHARE:ID
   FOR EACH SHARE NAME WITH (SHARE NAME:TYPE<2 OR SHARE NAME:TYPE=5 OR SHARE NAME:TYPE=6 OR 
       SHARE NAME:TYPE=7 OR SHARE NAME:TYPE=8 OR SHARE NAME:TYPE=9 OR SHARE NAME:TYPE=14) AND
       (SHARE NAME:EXPIRATIONDATE='--/--/--' OR SHARE NAME:EXPIRATIONDATE>SYSTEMDATE)
    DO
     IF SHARE NAME:TYPE=6 AND (ACCOUNT:TYPE=21 OR ACCOUNT:TYPE=22) THEN
      DO
       FOUNDPOA="N"
       FOR PA=1 TO PO
        DO
         IF POANAMES(PA,1)=SHARE NAME:SSN OR POANAMES(PA,2)=SHARE NAME:LONGNAME THEN FOUNDPOA="Y"
        END
       IF FOUNDPOA="N" THEN 
        DO
         PO=PO+1
         POANAMES(PO,1)=SHARE NAME:SSN
         POANAMES(PO,2)=SHARE NAME:LONGNAME
         POANAMES(PO,3)="T"
        END
      END
     CNT=CNT+1
     SNAMES(CNT,1)=SHARE:ID
     SNAMES(CNT,2)=SHARE NAME:SSN
     SNAMES(CNT,3)=SHARE NAME:FIRST
     SNAMES(CNT,4)=SHARE NAME:LAST
     SNAMES(CNT,5)=SHARE NAME:LONGNAME
     SNAMES(CNT,6)=FORMAT("##",SHARE NAME:TYPE)
     FOUNDUNIQUE="Y"
     FOR U=1 TO UN
      DO
       IF UNIQUENAMES(U,2)=SHARE NAME:SSN OR 
          (UNIQUENAMES(U,3)=SHARE NAME:FIRST AND
           UNIQUENAMES(U,4)=SHARE NAME:LAST) OR 
          UNIQUENAMES(U,5)=SHARE NAME:LONGNAME THEN FOUNDUNIQUE="N"
      END
     IF FOUNDUNIQUE="Y" THEN
      DO
       UN=UN+1
       UNIQUENAMES(UN,2)=SHARE NAME:SSN
       UNIQUENAMES(UN,3)=SHARE NAME:FIRST
       UNIQUENAMES(UN,4)=SHARE NAME:LAST
       UNIQUENAMES(UN,5)=SHARE NAME:LONGNAME
      END
    END
  END
 FOR EACH LOAN WITH LOAN:TYPE<>49 AND LOAN:CLOSEDATE='--/--/--'                                [Added 3/11/10 to  check for loan names on shares]
  DO
   FOR EACH LOAN NAME WITH LOAN NAME:EXPIRATIONDATE='--/--/--' AND LOAN NAME:TYPE<>29 
    DO
     FOUNDUNIQUE="Y"
     FOR U=1 TO UN
      DO
       IF UNIQUENAMES(U,2)=LOAN NAME:SSN OR 
          (UNIQUENAMES(U,3)=LOAN NAME:FIRST AND
           UNIQUENAMES(U,4)=LOAN NAME:LAST) OR 
          UNIQUENAMES(U,5)=LOAN NAME:LONGNAME THEN FOUNDUNIQUE="N"
      END
     IF FOUNDUNIQUE="Y" THEN
      DO
       UN=UN+1
       UNIQUENAMES(UN,2)=LOAN NAME:SSN
       UNIQUENAMES(UN,3)=LOAN NAME:FIRST
       UNIQUENAMES(UN,4)=LOAN NAME:LAST
       UNIQUENAMES(UN,5)=LOAN NAME:LONGNAME
      END 
    END
  END
 FOR EACH SHARE WITH SHARE:CLOSEDATE='--/--/--'
  DO
   FOR EACH SHARE NAME WITH (SHARE NAME:TYPE<2 OR SHARE NAME:TYPE=5 OR SHARE NAME:TYPE=6 OR 
       SHARE NAME:TYPE=7 OR SHARE NAME:TYPE=8 OR SHARE NAME:TYPE=9 OR SHARE NAME:TYPE=14) AND
       (SHARE NAME:EXPIRATIONDATE='--/--/--' OR SHARE NAME:EXPIRATIONDATE>SYSTEMDATE)
    DO
     FOUNDSSN="N"
     FOR I=1 TO UN
      DO
       IF UNIQUENAMES(I,2)=SHARE NAME:SSN THEN UNIQUENAMES(I,6)="Y"
      END
     END
   END 

 FOR MI=1 TO UN
  DO
   ONIDS=""
   SHIDS=ALLIDS
   FOUNDNAME="N"
   MX=1
   FOR MJ=1 TO CNT
    DO
     IF [(VALUE(SNAMES(MJ,6))<2 OR VALUE(SNAMES(MJ,6))=9) AND]
       (UNIQUENAMES(MI,2)=SNAMES(MJ,2) OR (UNIQUENAMES(MI,3)=SNAMES(MJ,3) AND UNIQUENAMES(MI,4) =SNAMES(MJ,4))) THEN
      DO
       MSP=CHARACTERSEARCH(SHIDS,SNAMES(MJ,1))
       IF MSP>0 THEN 
        DO
         ONIDS=ONIDS+" "+SEGMENT(SHIDS,MSP,MSP+1)
         IF MSP>3 THEN 
          DO
           SHIDS=SEGMENT(SHIDS,1,MSP-2)+SEGMENT(SHIDS,MSP+2,LENGTH(SHIDS))
          END
         ELSE SHIDS=SEGMENT(SHIDS,MSP+3,LENGTH(SHIDS))
        END
      END
    END
   IF LENGTH(SHIDS)>0 AND UNIQUENAMES(MI,2)<>PSSN THEN
    DO
     FOUNDPOA="N"
     FOR PA=1 TO PO
      DO
       IF POANAMES(PA,1)=UNIQUENAMES(MI,2) OR POANAMES(PA,2)=UNIQUENAMES(MI,5) THEN FOUNDPOA="Y"
      END
     IF FOUNDPOA="N" THEN
      DO
       MO=MO+1
       ML=LENGTH(SHIDS)
       WHILE SEGMENT(SHIDS,ML,ML)="," OR SEGMENT(SHIDS,ML,ML)=" "
        DO
         SHIDS=SEGMENT(SHIDS,1,ML-1)
         ML=LENGTH(SHIDS)  
        END
       WHILE SEGMENT(SHIDS,1,1)="," OR  SEGMENT(SHIDS,1,1)=" "
        DO
         SHIDS=SEGMENT(SHIDS,2,ML)
         ML=LENGTH(SHIDS)
        END
       FOUNDDOUBLE=CHARACTERSEARCH(SHIDS,",,")
       WHILE FOUNDDOUBLE>0
        DO 
         SHIDS=SEGMENT(SHIDS,1,FOUNDDOUBLE)+SEGMENT(SHIDS,FOUNDDOUBLE+2,LENGTH(SHIDS))
         FOUNDDOUBLE=CHARACTERSEARCH(SHIDS,",,")
        END
       OUTMISLINE(MO,1)=CAPITALIZE(UNIQUENAMES(MI,5))
       OUTMISLINE(MO,2)="CANNOT DO TRANSACTIONS ON"
       IF UNIQUENAMES(MI,6)<>"Y" THEN OUTMISLINE(MO,3)="<font color=RED size=+2>! ! !  <u> ANY  SHARE</u>  ! ! !</font>"
       ELSE OUTMISLINE(MO,3)=SHIDS
      END
    END
  END
END

PROCEDURE GETOTHERHOLDS
 FOR EACH NAME WITH NAME:EXPIRATIONDATE='--/--/--'
  DO
   FOUNDSSN="N"
   FOR I=1 TO SCNT
    DO
     IF SSNARRAY(I,1)=NAME:SSN THEN FOUNDSSN="Y"
    END
   IF FOUNDSSN="N" AND LENGTH(NAME:SSN)>0 THEN
    DO
     SCNT=SCNT+1
     SSNARRAY(SCNT,1)=NAME:SSN
     SSNARRAY(SCNT,2)=SEGMENT(NAME:LONGNAME,1,20)
    END
  END
 FOR EACH SHARE WITH SHARE:CLOSEDATE='--/--/--'
  DO
   FOR EACH SHARE NAME WITH (SHARE NAME:TYPE<2 OR SHARE NAME:TYPE=5 OR SHARE NAME:TYPE=6 OR 
       SHARE NAME:TYPE=7 OR SHARE NAME:TYPE=8 OR SHARE NAME:TYPE=9 OR SHARE NAME:TYPE=14) AND 
           (SHARE NAME:EXPIRATIONDATE='--/--/--' OR SHARE NAME:EXPIRATIONDATE>SYSTEMDATE)
    DO
     FOUNDSSN="N"
     FOR I=1 TO SCNT
      DO
       IF SSNARRAY(I,1)=SHARE NAME:SSN THEN FOUNDSSN="Y"
      END
     IF FOUNDSSN="N" AND LENGTH(SHARE NAME:SSN)>0 THEN
      DO
       SCNT=SCNT+1
       SSNARRAY(SCNT,1)=SHARE NAME:SSN
       SSNARRAY(SCNT,2)=SEGMENT(SHARE NAME:LONGNAME,1,20)
      END
    END
  END
 FOR EACH LOAN WITH LOAN:TYPE<>49 AND LOAN:CLOSEDATE='--/--/--'
  DO
   FOR EACH LOAN NAME WITH LOAN NAME:TYPE<>29 AND (LOAN NAME:EXPIRATIONDATE='--/--/--' OR LOAN  NAME:EXPIRATIONDATE>SYSTEMDATE)
    DO
     FOUNDSSN="N"
     FOR I=1 TO SCNT
      DO
       IF SSNARRAY(I,1)=LOAN NAME:SSN THEN FOUNDSSN="Y"
      END
     IF FOUNDSSN="N" AND LENGTH(LOAN NAME:SSN)>0 THEN
      DO
       SCNT=SCNT+1
       SSNARRAY(SCNT,1)=LOAN NAME:SSN
       SSNARRAY(SCNT,2)=SEGMENT(LOAN NAME:LONGNAME,1,20)
      END
    END
  END
 WHILELIMIT=2147483647
 FOR I=1 TO SCNT
  DO
   IF VALUE(SSNARRAY(I,1))>0 THEN
    DO
     FOR ACCOUNT WITH SSN SSNARRAY(I,1)
      DO
       IF ACCOUNT:NUMBER<>FULLACCT AND 
          ACCOUNT:NUMBER<>"0000090000" AND ACCOUNT:NUMBER<>"0000090001" THEN
        DO
         FOUNDACCT="N"
         FOUNDVALIDSNAME="N"
         FOR EACH NAME WITH (NAME:EFFECTIVEDATE<=SYSTEMDATE AND NAME:SSN=SSNARRAY(I,1) AND
                 (NAME:EXPIRATIONDATE='--/--/--' OR NAME:EXPIRATIONDATE>SYSTEMDATE))
          DO
           FOUNDVALIDSNAME="Y"
          END
         FOR EACH SHARE WITH SHARE:CLOSEDATE='--/--/--'
          DO
           FOR EACH SHARE NAME WITH (SHARE NAME:EFFECTIVEDATE<=SYSTEMDATE AND SHARE  NAME:SSN=SSNARRAY(I,1) AND
              (SHARE NAME:EXPIRATIONDATE='--/--/--' OR SHARE NAME:EXPIRATIONDATE>SYSTEMDATE))
            DO
             FOUNDVALIDSNAME="Y"
            END
          END
         FOR J=1 TO ACNT
          DO
           IF ACCTINFO(J,1)=FORMAT("##########",VALUE(ACCOUNT:NUMBER)) AND ACCTINFO(J,3) =SSNARRAY(I,1) THEN FOUNDACCT="Y"
          END
         FOR J=1 TO CLACNT
          DO
           IF CLACCTINFO(J,1)=FORMAT("##########",VALUE(ACCOUNT:NUMBER)) AND CLACCTINFO(J,3)=SSNARRAY(I,1) THEN FOUNDACCT="Y"
          END
         IF FOUNDACCT="N" AND (ACCOUNT:CLOSEDATE<>'--/--/--' OR (ACCOUNT:CLOSEDATE='--/--/--' AND FOUNDVALIDSNAME="Y")) AND ACNT<50 THEN
          DO
           IF ACCOUNT:CLOSEDATE='--/--/--' THEN
            DO
             IF ACCOUNT:TYPE<97 THEN
              DO
               ACNT=ACNT+1
               ACCTINFO(ACNT,1)=FORMAT("##########",VALUE(ACCOUNT:NUMBER))
               IF ACCOUNT:TYPE=96 THEN ACCTINFO(ACNT,1)=ACCTINFO(ACNT,1)+"(NON-MBR App Only)"
               ACCTINFO(ACNT,2)=SSNARRAY(I,2)
               ACCTINFO(ACNT,3)=SSNARRAY(I,1)
               ACCTHOLD(ACNT)=ACCOUNT:KRHOLDBASEAMOUNT
              END
            END
           ELSE
            DO
             CLACNT=CLACNT+1
             CLACCTINFO(CLACNT,1)=FORMAT("##########",VALUE(ACCOUNT:NUMBER))
             CLACCTINFO(CLACNT,2)=SSNARRAY(I,2)
             CLACCTINFO(CLACNT,3)=SSNARRAY(I,1)
            END
          END
        END
      END
    END
  END
END

PROCEDURE DISPNMID
 DISPEXP="Y"
 FOR BDD=1 TO SD
  DO
   IF NAME:SSN=BDSSN(BDD) THEN DISPEXP="N"
  END
 IF DISPEXP="Y" THEN
  DO
   SD=SD+1
   BDSSN(SD)=NAME:SSN
  END
 NAMEINFO(NI,3)=""
 IF NAME:IDENTIDTYPE:1=2 OR NAME:IDENTIDTYPE:2=2 OR NAME:IDENTIDTYPE:3=2 THEN [DRIVERS LICENSE]
  DO
   IF NAME:IDENTIDTYPE:1=2 THEN IDN=1
   ELSE IF NAME:IDENTIDTYPE:2=2 THEN IDN=2
   ELSE IDN=3
   NAMEINFO(NI,3)="D "+NAME:IDENTIDNUMBER:(IDN)
   NAMEINFO(NI,8)=FORMAT("99/99/99",NAME:IDENTIDEXPIREDATE:(IDN))
  END
 ELSE IF NAME:IDENTIDTYPE:1=3 OR NAME:IDENTIDTYPE:2=3 OR NAME:IDENTIDTYPE:3=3 THEN [STATE ID CARD]
  DO
   IF NAME:IDENTIDTYPE:1=3 THEN NAMEINFO(NI,3)="S "+NAME:IDENTIDNUMBER:1
   ELSE IF NAME:IDENTIDTYPE:2=3 THEN NAMEINFO(NI,3)="S "+NAME:IDENTIDNUMBER:2
   ELSE NAMEINFO(NI,3)="S "+NAME:IDENTIDNUMBER:3
  END
 ELSE IF NAME:IDENTIDTYPE:1=4 OR NAME:IDENTIDTYPE:2=4 OR NAME:IDENTIDTYPE:3=4 THEN [PASSPORT]
  DO
   IF NAME:IDENTIDTYPE:1=4 THEN NAMEINFO(NI,3)="P "+NAME:IDENTIDNUMBER:1
   ELSE IF NAME:IDENTIDTYPE:2=4 THEN NAMEINFO(NI,3)="P "+NAME:IDENTIDNUMBER:2
   ELSE NAMEINFO(NI,3)="P "+NAME:IDENTIDNUMBER:3
  END
 ELSE IF NAME:IDENTIDTYPE:1=101 OR NAME:IDENTIDTYPE:2=101 OR NAME:IDENTIDTYPE:3=101 THEN [PASSPORT]
  DO
   IF NAME:IDENTIDTYPE:1=101 THEN NAMEINFO(NI,3)="B "+NAME:IDENTIDNUMBER:1
   ELSE IF NAME:IDENTIDTYPE:2=101 THEN NAMEINFO(NI,3)="B "+NAME:IDENTIDNUMBER:2
   ELSE NAMEINFO(NI,3)="B "+NAME:IDENTIDNUMBER:3
  END
 ELSE IF NAME:IDENTIDTYPE:1=103 OR NAME:IDENTIDTYPE:2=103 OR NAME:IDENTIDTYPE:3=103 THEN [PASSPORT]
  DO
   IF NAME:IDENTIDTYPE:1=103 THEN NAMEINFO(NI,3)="G "+NAME:IDENTIDNUMBER:1
   ELSE IF NAME:IDENTIDTYPE:2=103 THEN NAMEINFO(NI,3)="G "+NAME:IDENTIDNUMBER:2
   ELSE NAMEINFO(NI,3)="G "+NAME:IDENTIDNUMBER:3
  END

 NAMEINFO(NI,3)=SEGMENT(NAMEINFO(NI,3),1,LENGTH(NAMEINFO(NI,3)))
 IF LENGTH(NAMEINFO(NI,3))>0 THEN 
  DO
   HTMLVIEWLINE("<TD ALIGN=CENTER><FONT SIZE=-1>"+NAMEINFO(NI,3)+"</FONT>")
   IF DISPEXP="Y" THEN CALL DISPEXPDATE
   HTMLVIEWLINE("</TD>")
  END
 ELSE HTMLVIEWLINE("     <TD ALIGN=CENTER><FONT SIZE=-1>"+SP+"</FONT></TD>")
END

PROCEDURE DISPSHID
 DISPEXP="Y"
 FOR BDD=1 TO SD
  DO
   IF SHARE NAME:SSN=BDSSN(BDD) THEN DISPEXP="N"
  END
 IF DISPEXP="Y" THEN
  DO
   SD=SD+1
   BDSSN(SD)=SHARE NAME:SSN
  END
 IF SHARE NAME:IDENTIDTYPE:1=2 THEN
  DO
   NAMEINFO(NI,3)="D "+SHARE NAME:IDENTIDNUMBER:1
   NAMEINFO(NI,8)=FORMAT("99/99/99",SHARE NAME:IDENTIDEXPIREDATE:1)
  END
 ELSE IF SHARE NAME:IDENTIDTYPE:2=2 THEN
  DO
   NAMEINFO(NI,3)="D "+SHARE NAME:IDENTIDNUMBER:2
   NAMEINFO(NI,8)=FORMAT("99/99/99",SHARE NAME:IDENTIDEXPIREDATE:2)
  END
 ELSE IF SHARE NAME:IDENTIDTYPE:3=2 THEN
  DO
   NAMEINFO(NI,3)="D "+SHARE NAME:IDENTIDNUMBER:3
   NAMEINFO(NI,8)=FORMAT("99/99/99",SHARE NAME:IDENTIDEXPIREDATE:3)
  END
 IF SEGMENT(NAMEINFO(NI,3),1,1)="S" THEN
  DO
   IF SHARE NAME:IDENTIDTYPE:1 = 3 THEN NAMEINFO(NI,3)="S "+SHARE NAME:IDENTIDNUMBER:1
   ELSE IF SHARE NAME:IDENTIDTYPE:2 = 3 THEN NAMEINFO(NI,3)="S "+SHARE NAME:IDENTIDNUMBER:2
   ELSE IF SHARE NAME:IDENTIDTYPE:3 = 3 THEN NAMEINFO(NI,3)="S "+SHARE NAME:IDENTIDNUMBER:3
   ELSE IF SHARE NAME:IDENTIDTYPE:1 = 4 THEN NAMEINFO(NI,3)="P "+SHARE NAME:IDENTIDNUMBER:1
   ELSE IF SHARE NAME:IDENTIDTYPE:2 = 4 THEN NAMEINFO(NI,3)="P "+SHARE NAME:IDENTIDNUMBER:2
   ELSE IF SHARE NAME:IDENTIDTYPE:3 = 4 THEN NAMEINFO(NI,3)="P "+SHARE NAME:IDENTIDNUMBER:3
  END
 NAMEINFO(NI,3)=SEGMENT(NAMEINFO(NI,3),1,LENGTH(NAMEINFO(NI,3)))
 IF SHARE NAME:TYPE<2 OR SHARE NAME:TYPE=5 OR SHARE NAME:TYPE=6 OR SHARE NAME:TYPE=7 OR
    SHARE NAME:TYPE=8 OR SHARE NAME:TYPE=9 OR SHARE NAME:TYPE=14 THEN
  DO
   IF LENGTH(NAMEINFO(NI,3))>0 THEN 
    DO
     HTMLVIEWLINE("<TD ALIGN=CENTER><FONT SIZE=-1>"+NAMEINFO(NI,3)+"</FONT>")
     IF DISPEXP="Y" THEN CALL DISPEXPDATE
     HTMLVIEWLINE("</TD>")
    END
   ELSE HTMLVIEWLINE("   <TD ALIGN=CENTER><FONT SIZE=-1>"+SP+"</FONT></TD>")
  END
END

PROCEDURE DISPLNID
 DISPEXP="Y"
 FOR BDD=1 TO SD
  DO
   IF LOAN NAME:SSN=BDSSN(BDD) THEN DISPEXP="N"
  END
 IF DISPEXP="Y" THEN
  DO
   SD=SD+1
   BDSSN(SD)=LOAN NAME:SSN
  END
 IF LOAN NAME:IDENTIDTYPE:1=2 THEN
  DO
   NAMEINFO(NI,3)="D "+LOAN NAME:IDENTIDNUMBER:1
   NAMEINFO(NI,8)=FORMAT("99/99/99",LOAN NAME:IDENTIDEXPIREDATE:1)
  END
 ELSE IF LOAN NAME:IDENTIDTYPE:2=2 THEN
  DO
   NAMEINFO(NI,3)="D "+LOAN NAME:IDENTIDNUMBER:2
   NAMEINFO(NI,8)=FORMAT("99/99/99",LOAN NAME:IDENTIDEXPIREDATE:2)
  END
 ELSE IF LOAN NAME:IDENTIDTYPE:3=2 THEN
  DO
   NAMEINFO(NI,3)="D "+LOAN NAME:IDENTIDNUMBER:3
   NAMEINFO(NI,8)=FORMAT("99/99/99",LOAN NAME:IDENTIDEXPIREDATE:3)
  END
 IF SEGMENT(NAMEINFO(NI,3),1,1)="L" THEN
  DO
   IF LOAN NAME:IDENTIDTYPE:1 = 3 THEN NAMEINFO(NI,3)="S "+LOAN NAME:IDENTIDNUMBER:1
   ELSE IF LOAN NAME:IDENTIDTYPE:2 = 3 THEN NAMEINFO(NI,3)="S "+LOAN NAME:IDENTIDNUMBER:2
   ELSE IF LOAN NAME:IDENTIDTYPE:3 = 3 THEN NAMEINFO(NI,3)="S "+LOAN NAME:IDENTIDNUMBER:3
   ELSE IF LOAN NAME:IDENTIDTYPE:1 = 4 THEN NAMEINFO(NI,3)="P "+LOAN NAME:IDENTIDNUMBER:1
   ELSE IF LOAN NAME:IDENTIDTYPE:2 = 4 THEN NAMEINFO(NI,3)="P "+LOAN NAME:IDENTIDNUMBER:2
   ELSE IF LOAN NAME:IDENTIDTYPE:3 = 4 THEN NAMEINFO(NI,3)="P "+LOAN NAME:IDENTIDNUMBER:3
  END
 NAMEINFO(NI,3)=SEGMENT(NAMEINFO(NI,3),1,LENGTH(NAMEINFO(NI,3)))
 IF LENGTH(NAMEINFO(NI,3))>0 THEN 
  DO
   HTMLVIEWLINE("<TD ALIGN=CENTER><FONT SIZE=-1>"+NAMEINFO(NI,3)+"</FONT>")
   IF DISPEXP="Y" THEN CALL DISPEXPDATE
   HTMLVIEWLINE("</TD>")
  END
 ELSE HTMLVIEWLINE("     <TD ALIGN=CENTER><FONT SIZE=-1>"+SP+"</FONT></TD>")
END

PROCEDURE DISPEXPDATE
 IF ((SEGMENT(NAMEINFO(NI,3),1,1)="D" AND 
      (DATEVALUE(NAMEINFO(NI,8))='--/--/--' OR DATEVALUE(NAMEINFO(NI,8))<=SYSTEMDATE)) OR 
     (SEGMENT(NAMEINFO(NI,3),1,1)<>"D" AND 
      (NAMEINFO(NI,8)<>"" AND DATEVALUE(NAMEINFO(NI,8))<=SYSTEMDATE))) THEN
  DO
   HTMLVIEWLINE("<FONT SIZE=-1 COLOR=RED><B>")
   HTMLVIEWLINE("Exp: "+NAMEINFO(NI,8)+"</B></FONT>")
  END
END

PROCEDURE GETLOANDEPOSITS
 FOR EACH LOAN WITH LOAN:TYPE<>49
  DO 
   FOR EACH LOAN TRANSACTION WITH LOAN TRANSACTION:EFFECTIVEDATE>=SYSTEMDATE-364 AND 
            LOAN TRANSACTION:ACTIONCODE="N"
    DO
     LC=LC+1
     LCDATE(LC)=LOAN TRANSACTION:EFFECTIVEDATE
     LCDEPS(LC)=LOAN TRANSACTION:BALANCECHANGE
    END
    UNTIL LOAN TRANSACTION:EFFECTIVEDATE<SYSTEMDATE-364
  END
END

PROCEDURE GETPLEDGEAMT
 PERCENTPLEDGED=PERCENTPLEDGED+LOAN PLEDGE:PERCENT
 LPACCT=LOAN PLEDGE:ACCOUNTNUMBER
 LPID=LOAN PLEDGE:ID
 LNACCT=ACCOUNT:NUMBER
 FOR ACCOUNT LPACCT
  DO
   FOR EACH SHARE WITH (SHARE:ID=LPID)
    DO
     FOR EACH SHARE HOLD WITH (SHARE HOLD:EXPIRATIONDATE='--/--/--' OR SHARE  HOLD:EXPIRATIONDATE>SYSTEMDATE)
      DO
       IF SHARE HOLD:TYPE=5 THEN 
        DO
         IF SHARE HOLD:REFERENCE1=LNACCT AND VALUE(SHARE HOLD:REFERENCE2)=VALUE(LNID) THEN
          DO
           TOTHOLD=TOTHOLD+SHARE HOLD:AMOUNT
           LP=LP+1
           LOANPLEDGES(LP)="Acct: "+LPACCT+"&nbsp;&nbsp;ID&nbsp;&nbsp;"+LPID+" - $"+FORMAT ("###,##9.99",SHARE HOLD:AMOUNT)
          END
        END
      END
    END
  END
END

PROCEDURE FILLINNAMETYPE
 MORTGAGETYPES(1)="2NDGFB"
 MORTGAGETYPES(2)="2NDPORT"
 MORTGAGETYPES(3)="CU15FX"
 MORTGAGETYPES(4)="CU2ND"
 MORTGAGETYPES(5)="CU30FX"
 MORTGAGETYPES(6)="CU5BAL"
 MORTGAGETYPES(7)="CU7BAL"
 MORTGAGETYPES(8)="CUARM3" 
 MORTGAGETYPES(9)="CUARM5" 
 MORTGAGETYPES(10)="CUARM7" 
 MORTGAGETYPES(11)="CUFHA15" 
 MORTGAGETYPES(12)="CUFHA30" 
 MORTGAGETYPES(13)="CU-FN30TELCO"
 MORTGAGETYPES(14)="CUNC15FX"
 MORTGAGETYPES(15)="CUVA15"
 MORTGAGETYPES(16)="CUVA30"
 MORTGAGETYPES(17)="1827"
 MCOLOR(1)="<FONT SIZE=-1 COLOR=BLACK>"
 MCOLOR(2)="<FONT SIZE=-1 COLOR=PURPLE><B>"
 MCEND(1)="</FONT>"
 MCEND(2)="</B></FONT>"
END

PROCEDURE DISPLAYIMPORTANTNOTE
 IF SYSUSERNUMBER=484 THEN POPUPMESSAGE(0,"SNAPSHOT")
 FIRSTNOTE="Y"
 DEBUGTEST="n"
 FOR EACH NOTE WITH UPPERCASE(NOTE:TEXT:1)="IMPORTANT NOTE" AND 
  (NOTE:EXPIRATIONDATE='--/--/--' OR NOTE:EXPIRATIONDATE>SYSTEMDATE)
  DO
   IF FIRSTNOTE="Y" THEN
    DO
     ILINE=FORMAT("99/99/99",SYSTEMDATE)+"~"+FORMAT("99:99",SYSACTUALTIME)+"~"+ACCOUNT:NUMBER+"~"+FORMAT("9999",SYSUSERNUMBER)+"~7~H2 START~IMPORTANT NOTE "
     IF DEBUGTEST="Y" THEN
      DO
       FILEOPEN("LETTER","FINDBUG","APPEND",INUMBER,IERROR)       
        FILEWRITELINE(INUMBER,ILINE,IERROR)
        IF IERROR<>"" THEN FILEWRITELINE(INUMBER,"~7~H2 START Error:~"+IERROR,IERROR2)
       FILECLOSE(INUMBER,IERROR)
      END
     HTMLVIEWOPEN(0)
     HTMLVIEWLINE("<html>")
     HTMLVIEWLINE("<head>")
     HTMLVIEWLINE("<title>Important Notes</title>")
     HTMLVIEWLINE("<meta http-equiv=Content-Type content=text/html; charset=iso-8859-1>")
     HTMLVIEWLINE("</head>")
     HTMLVIEWLINE("<body bgcolor=#FFFFFF text=#000000>")
     HTMLVIEWLINE("<font face=arial>")
     FIRSTNOTE="N"
    END
   HTMLVIEWLINE(" <table border=0 align=center WIDTH=875>")
   HTMLVIEWLINE("<tr bgcolor=SILVER><td>")
   HTMLVIEWLINE("<FONT COLOR=RED SIZE=+4><B><CENTER>"+NOTE:TEXT:1+"</CENTER></B></FONT><br><BR>")
   FOR NOTEI=2 TO 20
    DO
     IF NOTE:TEXT:(NOTEI)<>"" THEN HTMLVIEWLINE("<FONT SIZE=+3>"+NOTE:TEXT:(NOTEI)+"<br>")
    END
   HTMLVIEWLINE("</FONT></td></tr>")
   HTMLVIEWLINE("<BR>")
  END
 IF FIRSTNOTE="N" THEN
  DO
   HTMLVIEWLINE("</TABLE>")
   HTMLVIEWLINE("<font face=arial>")
   HTMLVIEWLINE(" <P>")
   HTMLVIEWLINE("  <form NAME=REDFLAGSCREEN METHOD=POST ACTION=symitar://HTMLView~Action=Post>")
   HTMLVIEWLINE("  <div align=center>")
   HTMLVIEWLINE("   <INPUT TYPE=SUBMIT NAME=submitbutton VALUE='Continue'>")
   HTMLVIEWLINE("  </div>")
   HTMLVIEWLINE("  </form>")
   HTMLVIEWLINE(" </P>")
   HTMLVIEWLINE("</body>")
   HTMLVIEWLINE("</html>")
   HTMLVIEWDISPLAY
   ILINE=FORMAT("99/99/99",SYSTEMDATE)+"~"+FORMAT("99:99",SYSACTUALTIME)+"~"+ACCOUNT:NUMBER+"~"+FORMAT("9999",SYSUSERNUMBER)+"~7~H2 END~IMPORTANT NOTE "
   IF DEBUGTEST="Y" THEN
    DO
     FILEOPEN("LETTER","FINDBUG","APPEND",INUMBER,IERROR)       
      FILEWRITELINE(INUMBER,ILINE,IERROR)
      IF IERROR<>"" THEN FILEWRITELINE(INUMBER,"~7~H2 END Error:~"+IERROR,IERROR2)
     FILECLOSE(INUMBER,IERROR)
    END
  END
END

PROCEDURE BOARDMEMBER
 DEBUGTEST="N"
 ILINE=FORMAT("99/99/99",SYSTEMDATE)+"~"+FORMAT("99:99",SYSACTUALTIME)+"~"+ACCOUNT:NUMBER+"~"+FORMAT("9999",SYSUSERNUMBER)+"~7~H3 START~BOARD ACCT "
 IF DEBUGTEST="Y" THEN
  DO
   FILEOPEN("LETTER","FINDBUG","APPEND",INUMBER,IERROR)       
    FILEWRITELINE(INUMBER,ILINE,IERROR)
    IF IERROR<>"" THEN FILEWRITELINE(INUMBER,"~7~H3 START Error:~"+IERROR,IERROR2)
   FILECLOSE(INUMBER,IERROR)
  END
 HTMLVIEWOPEN(0)
 HTMLVIEWLINE("<html>")
 HTMLVIEWLINE("<head>")
 HTMLVIEWLINE("<title>Important Notes</title>")
 HTMLVIEWLINE("<meta http-equiv=Content-Type content=text/html; charset=iso-8859-1>")
 HTMLVIEWLINE("</head>")
 HTMLVIEWLINE("<body bgcolor=BLUE text=#000000>")
 HTMLVIEWLINE("<font face=arial>")
 HTMLVIEWLINE(" <table border=0 align=center WIDTH=875>")
 HTMLVIEWLINE("<tr bgcolor=SILVER><td><FONT COLOR=RED SIZE=+4><B><CENTER>TELCO ")
 IF ACCOUNT:TYPE=4 THEN HTMLVIEWLINE("Board Member's Account")
 ELSE IF ACCOUNT:TYPE=5 THEN HTMLVIEWLINE("Board Family Member's Account")
 ELSE IF ACCOUNT:TYPE=8 OR ANYWARNING(ACCOUNT,87) THEN HTMLVIEWLINE("Supervisory Committee Member's Account")
 HTMLVIEWLINE("  </CENTER</B></FONT><br></FONT></td></tr>")
 HTMLVIEWLINE("</TABLE>")
 HTMLVIEWLINE("<font face=arial>")
 HTMLVIEWLINE(" <P>")
 HTMLVIEWLINE("  <form NAME=REDFLAGSCREEN METHOD=POST ACTION=symitar://HTMLView~Action=Post>")
 HTMLVIEWLINE("   <div align=center>")
 HTMLVIEWLINE("    <INPUT TYPE=SUBMIT NAME=submitbutton VALUE='Continue'>")
 HTMLVIEWLINE("   </div>")
 HTMLVIEWLINE("  </form>")
 HTMLVIEWLINE(" </P>")
 HTMLVIEWLINE("</body>")
 HTMLVIEWLINE("</html>")
 HTMLVIEWDISPLAY
 ILINE=FORMAT("99/99/99",SYSTEMDATE)+"~"+FORMAT("99:99",SYSACTUALTIME)+"~"+ACCOUNT:NUMBER+"~"+FORMAT("9999",SYSUSERNUMBER)+"~7~H3 END~BOARD ACCT "
 IF DEBUGTEST="Y" THEN
  DO
   FILEOPEN("LETTER","FINDBUG","APPEND",INUMBER,IERROR)       
    FILEWRITELINE(INUMBER,ILINE,IERROR)
    IF IERROR<>"" THEN FILEWRITELINE(INUMBER,"~7~H3 END Error:~"+IERROR,IERROR2)
   FILECLOSE(INUMBER,IERROR)
  END
END

PROCEDURE GETTODAY
 FIRSTTRAN="Y"
 FOR EACH SHARE WITH SHARE:CLOSEDATE='--/--/--' AND SHARE:CHARGEOFFDATE='--/--/--'
  DO
   FOR EACH SHARE TRANSACTION WITH SHARE TRANSACTION:VOIDCODE=0 AND      
            SHARE TRANSACTION:POSTDATE=SYSTEMDATE AND
            SHARE TRANSACTION:COMMENTCODE=0 AND
            (SHARE TRANSACTION:USERNUMBER<800 OR 
            SHARE TRANSACTION:USERNUMBER>999) AND
            (SHARE TRANSACTION:ACTIONCODE ="D" OR
            SHARE TRANSACTION:ACTIONCODE ="A" OR
            SHARE TRANSACTION:ACTIONCODE ="P" OR
            SHARE TRANSACTION:ACTIONCODE ="W")
    DO
     IF FIRSTTRAN="Y" THEN
      DO
       FIRSTTRAN="N"
       HTMLVIEWLINE("<table border=0>")
       HTMLVIEWLINE("  <tr>")
       HTMLVIEWLINE("    <td colspan=7>&nbsp;</font></td>")
       HTMLVIEWLINE("  </tr>")
       HTMLVIEWLINE("  <tr>")
       HTMLVIEWLINE("    <td colspan=7><font size=+2 color=Red><b>WARNING: ")
       HTMLVIEWLINE("                  Other transactions done today:</b></font></td>")
       HTMLVIEWLINE("  </tr>")
      END

     [ Display Transactions ]
     IF SHARE TRANSACTION:SOURCECODE="A" OR
        SHARE TRANSACTION:SOURCECODE="C" OR
        SHARE TRANSACTION:SOURCECODE="D" OR
        SHARE TRANSACTION:SOURCECODE="E" OR
        SHARE TRANSACTION:SOURCECODE="F" OR
        SHARE TRANSACTION:SOURCECODE="G" OR
        SHARE TRANSACTION:SOURCECODE="K" OR
        SHARE TRANSACTION:SOURCECODE="M" OR
        SHARE TRANSACTION:SOURCECODE="N" OR
        SHARE TRANSACTION:SOURCECODE="" THEN    
      DO
       HTMLVIEWLINE("<tr><td align=left width=150>"+BRANCHNAME(SHARE TRANSACTION:BRANCH)+"</td>")
       HTMLVIEWLINE("<td align=right width=150>ID "+SHARE TRANSACTION:ID+"</td>")
       HTMLVIEWLINE("<td width=150 align=right>"+FORMAT("###,###,###.99",SHARE TRANSACTION:TRANAMOUNT)+"</td>")
       HTMLVIEWLINE("<td width=350> - "+ SHARE TRANSACTION:STMTDESC:1 +"</td></tr>")
      END
    END
  END
 IF FIRSTTRAN="N" THEN
  HTMLVIEWLINE("</table>")
END


PROCEDURE READGLENTRY
 FIRSTGLENTRY="Y"
 OTL=2
 FOR GLTRAN WITH SEQUENCENUMBER "+"
  DO
   IF GLTRAN:ACCOUNTNUMBER=FULLACCT THEN
    DO
     FOR EACH GLENTRY WITH (GLTRAN:USERNUMBER<800 OR GLTRAN:USERNUMBER>999)
      DO
       IF FIRSTGLENTRY="Y" THEN
        DO
         OTL=2
         HTMLVIEWLINE("<table border=0 width=500>")
         HTMLVIEWLINE("  <tr>")
         HTMLVIEWLINE("    <td colspan=7>&nbsp;</font></td>")
         HTMLVIEWLINE("  </tr>")
         HTMLVIEWLINE("  <tr>")
         HTMLVIEWLINE("    <td colspan=7><font size=+2 color=Red><b>WARNING: ")
         HTMLVIEWLINE("                  Other transactions done today:</b></font></td>")
         HTMLVIEWLINE("  </tr>")
         IF OT>0 THEN
          DO
           FOR OI=1 TO OT
            DO
             HTMLVIEWLINE("  <tr>")
             HTMLVIEWLINE("    <td WIDTH=150>"+OTCOMMENT(OI,1)+"</td>")
             HTMLVIEWLINE("    <td colspan=6>"+OTCOMMENT(OI,2)+"</td>")
             HTMLVIEWLINE("  </tr>")
            END
          END
         FIRSTGLENTRY="N"
        END
       OUTCODE=""
       IF GLENTRY:GLCODE=1       THEN OUTCODE="SD"  [Share Deposit]
       ELSE IF GLENTRY:GLCODE=2  THEN OUTCODE="SW"  [Share Withdrawl]
       ELSE IF GLENTRY:GLCODE=37 THEN OUTCODE="IWI" [Incoming Wire]
       ELSE IF GLENTRY:GLCODE=38 THEN OUTCODE="OWI" [Outgoing Wire]
       ELSE IF GLENTRY:GLCODE=39 THEN OUTCODE="ON"  [On Us Transaction]
       [ELSE IF GLENTRY:GLCODE=40 THEN OUTCODE="XFER"][Transfer]
       ELSE IF GLENTRY:GLCODE=50 THEN OUTCODE="ATM" [ATM Clearing]
       ELSE IF GLENTRY:GLCODE=51 THEN OUTCODE="ATM" [ATM Clearing]
       ELSE IF GLENTRY:GLCODE=52 THEN OUTCODE="ATM" [ATM Clearing]
       ELSE IF GLENTRY:GLCODE=53 THEN OUTCODE="ATM" [ATM Clearing]
       ELSE IF GLENTRY:GLCODE=54 THEN OUTCODE="ATM" [ATM Clearing]
       ELSE IF GLENTRY:GLCODE=55 THEN OUTCODE="ON"  [Bond Redemption]
       ELSE IF GLENTRY:GLCODE=57 THEN OUTCODE="IV"  [Inventory Transaction]
       ELSE IF GLENTRY:GLCODE=60 THEN OUTCODE="CR"  [Cash Received]
       ELSE IF GLENTRY:GLCODE=61 THEN OUTCODE="CD"  [Cash Disbursed]
       ELSE IF GLENTRY:GLCODE=62 THEN OUTCODE="KR"  [Check Received]
       ELSE IF GLENTRY:GLCODE=63 THEN OUTCODE="KD"  [Check Disbursed]
       ELSE IF GLENTRY:GLCODE=64 THEN OUTCODE="KO"  [Secondary Check Disbursed]
       ELSE IF GLENTRY:GLCODE=65 THEN OUTCODE="MO"  [Money Order]
       ELSE IF GLENTRY:GLCODE=67 THEN OUTCODE="TC"  [Travelers Check]
       ELSE IF GLENTRY:GLCODE=71 THEN OUTCODE="TC"  [Foreign Chash Received]
       ELSE IF GLENTRY:GLCODE=72 THEN OUTCODE="TC"  [Foreign Chash Disbursed]
       ELSE IF GLENTRY:GLCODE=86 THEN OUTCODE="BKR" [Bulk Check Received]
       ELSE IF GLENTRY:GLACCOUNTNUMBER="73200000000000" OR 
               CHARACTERSEARCH(GLENTRY:GLCOMMENT,"WIRE")>0 THEN OUTCODE="WI" [Wire]
       ELSE IF GLENTRY:GLACCOUNTNUMBER="74400000000000" THEN OUTCODE="WU"    [Western Union]
       ELSE IF CHARACTERSEARCH(GLENTRY:GLCOMMENT,"ATM")>0 THEN OUTCODE="ATM" [ATM]
       IF OUTCODE<>"" THEN
        DO
         IF PREVSEQ<>GLTRAN:SEQUENCENUMBER THEN
          DO
           HTMLVIEWLINE("<tr>")
           HTMLVIEWLINE("<td align=left width=150>"+BRANCHNAME(GLTRAN:BRANCH)+"</td>")  
           PREVSEQ=GLTRAN:SEQUENCENUMBER
           OTL=1
          END
         ELSE IF OTL>1 THEN 
          DO
           HTMLVIEWLINE("</tr>")
           HTMLVIEWLINE("<td align=left width=150>"+BRANCHNAME(GLTRAN:BRANCH)+"</td>")  [GLTRAN:BRANCH]
           OTL=1
          END
         ELSE OTL=OTL+1
         HTMLVIEWLINE("<td align=right width=45>ID "+GLTRAN:ID+"</td>")
         HTMLVIEWLINE("<td align=left width=35>"+OUTCODE+"</td>")
         HTMLVIEWLINE("<td width=100 align=right>"+FORMAT("###,###,###.99",GLENTRY:AMOUNT)+"</td>")
        END
      END
    END
  END
 IF FIRSTGLENTRY="N" THEN HTMLVIEWLINE("</table>")
END

PROCEDURE GETTRACKING31INFO
 [IF SYSUSERNUMBER=484 THEN POPUPMESSAGE(0,"GETTRACKING31INFO")]
 FOR I=1 TO 5
  DO
   BSCORE(I)=0
   BSSN(I)=""
   BDATE(I)='--/--/--'
   BREASONS(I)=""
   BMAX(I)=0
   BMIN(I)=0
  END

 FOR EACH TRACKING WITH TRACKING:TYPE=31
  DO
   FNDBEACON="Y"
   BSSN(1)=TRACKING:USERCHAR1
   BDATE(1)=TRACKING:USERDATE1
   BSCORE(1)=TRACKING:USERNUMBER1
   BMAX(1)=TRACKING:USERNUMBER11
   BMIN(1)=TRACKING:USERNUMBER16
   BREASONS(1)=TRACKING:USERCHAR16
   
   BSSN(2)=TRACKING:USERCHAR2
   BDATE(2)=TRACKING:USERDATE2
   BSCORE(2)=TRACKING:USERNUMBER2
   BMAX(2)=TRACKING:USERNUMBER12
   BMIN(2)=TRACKING:USERNUMBER17
   BREASONS(2)=TRACKING:USERCHAR17
   
   BSSN(3)=TRACKING:USERCHAR3
   BDATE(3)=TRACKING:USERDATE3
   BSCORE(3)=TRACKING:USERNUMBER3
   BMAX(3)=TRACKING:USERNUMBER13
   BMIN(3)=TRACKING:USERNUMBER18
   BREASONS(3)=TRACKING:USERCHAR18
   
   BSSN(4)=TRACKING:USERCHAR4
   BDATE(4)=TRACKING:USERDATE4
   BSCORE(4)=TRACKING:USERNUMBER4
   BMAX(4)=TRACKING:USERNUMBER14
   BMIN(4)=TRACKING:USERNUMBER19
   BREASONS(4)=TRACKING:USERCHAR19
   
   BSSN(5)=TRACKING:USERCHAR5
   BDATE(5)=TRACKING:USERDATE5
   BSCORE(5)=TRACKING:USERNUMBER5
   BMAX(5)=TRACKING:USERNUMBER15
   BMIN(5)=TRACKING:USERNUMBER20
   BREASONS(5)=TRACKING:USERCHAR20
   
   BLASTUPDATE=TRACKING:FMLASTDATE
  END
END

#INCLUDE "IS.PRO"



